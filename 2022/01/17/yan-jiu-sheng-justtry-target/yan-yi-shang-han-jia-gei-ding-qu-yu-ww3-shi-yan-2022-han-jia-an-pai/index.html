<!DOCTYPE HTML>
<!-- 01 语言选择 -->
<html lang="En">

<!-- 02 head是哪里？ok~~，首页，分类～～ -->
<!-- 下面的这个ejs语句，添加网站的head部分，即主页，分类等及其图标 -->


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="07-east-USA区域WW3试验（2022寒假安排）, Jincan">
    <meta name="description" content="~~">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>07-east-USA区域WW3试验（2022寒假安排） | Jincan</title>
    <link rel="icon" type="image/png" href="/favicon_hua.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    
    <!-- aliyun网站教程添加图标所需的导入css，放到 matery 中的 my.css中 -->
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    
    
    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

     
<meta name="generator" content="Hexo 5.4.1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<!-- 03 background是什么？网站背景图 -->



<body>
    <!--04 header是什么？logo，navigation，githublink -->
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo_hua.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Jincan</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo_hua.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Jincan</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118131148.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">07-east-USA区域WW3试验（2022寒假安排）</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: scroll;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">No tag</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%A0%94%E7%A9%B6%E7%94%9FJustTry/" class="post-category">
                                研究生JustTry
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2022-01-17
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2022-05-22
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    55.8k
                </div>
                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="07-给定区域WW3试验（2022寒假安排）"><a href="#07-给定区域WW3试验（2022寒假安排）" class="headerlink" title="07-给定区域WW3试验（2022寒假安排）"></a><center>07-给定区域WW3试验（2022寒假安排）</center></h1><h2 id="文档托管"><a href="#文档托管" class="headerlink" title="文档托管"></a>文档托管</h2><ul>
<li>git托管：【<a target="_blank" rel="noopener" href="https://github.com/Liu-Jincan/Data-Assimilation-for-Ocean-Current-Forecasts%E3%80%91">https://github.com/Liu-Jincan/Data-Assimilation-for-Ocean-Current-Forecasts】</a></li>
<li>百度网盘托管：【】</li>
</ul>
<h2 id="—————————————CCMP"><a href="#—————————————CCMP" class="headerlink" title="—————————————CCMP"></a>—————————————CCMP</h2><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>官网：<a target="_blank" rel="noopener" href="https://www.remss.com/measurements/ccmp/">https://www.remss.com/measurements/ccmp/</a></p>
<blockquote>
<p>2022-01-17 可以打开</p>
<p><code>CCMP Wind Vector Analysis Product</code></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://data.remss.com/ccmp/">https://data.remss.com/ccmp/</a></p>
<blockquote>
<p>2022-02-04 可以打开</p>
<p>来自于Wjc老师发的网站；</p>
<p><code>readme_ccmp.pdf</code> 来自于<code>CCMP Wind Vector Analysis Product</code>；</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204171753.png" style="zoom:67%;">
</blockquote>
<h2 id="CCMP-Wind-Vector-Analysis-Product-2022-01-17"><a href="#CCMP-Wind-Vector-Analysis-Product-2022-01-17" class="headerlink" title="CCMP Wind Vector Analysis Product (2022-01-17)"></a>CCMP Wind Vector Analysis Product (2022-01-17)</h2><h3 id="Version-2-CCMP-Wind-Product"><a href="#Version-2-CCMP-Wind-Product" class="headerlink" title="Version 2 CCMP Wind Product"></a>Version 2 CCMP Wind Product</h3><p>The Cross-Calibrated Multi-Platform (CCMP) gridded surface vector winds are produced using satellite, moored buoy, and model wind data, and as such, are considered to be a Level-3 ocean vector wind analysis product. We have updated the CCMP product, using improved and additional input data. </p>
<p><strong>This web site documents the new CCMP V2.0 data set now available from Remote Sensing Systems</strong> (RSS). </p>
<p><code>The V2 CCMP processing</code> now combines <code>Version-7 RSS radiometer wind speeds</code>,<code> QuikSCAT and ASCAT scatterometer wind vectors</code>, <code>moored buoy wind data</code>, and <code>ERA-Interim model wind fields</code> using a <code>Variational Analysis Method (VAM)</code> to produce four maps daily of <code>0.25 degree</code> gridded vector winds.  </p>
<blockquote>
<p>讲了此数据，用到了哪些数据，用什么方法。</p>
</blockquote>
<p><code>The original CCMP product (V1.1)</code> was originally produced by Bob Atlas and his team with funding from <code>the NASA REASoN and MEaSUREs programs</code>.  The <a target="_blank" rel="noopener" href="http://podaac.jpl.nasa.gov/dataset/CCMP_MEASURES_ATLAS_L4_OW_L3_0_WIND_VECTORS_FLK">original MEaSUREs product</a> is still available from the NASA Physical Oceanography DAAC (podaac.jpl.nasa.gov). </p>
<p>RSS has transitioned the <code> CCMP processing code</code> to run using our most up-to-date satellite data observations. All methodology remains the same as that used in the original CCMP product and most of the <code>CCMP processing code</code> is unchanged, with only minor alterations to compensate for the different operating systems and compilers. </p>
<blockquote>
<p>transition  转换                                </p>
<p>compensate  补偿</p>
</blockquote>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p><strong>Gap-free</strong> ocean surface wind data of high quality and high temporal and spatial resolution are useful for a variety of purposes and are necessary for studying large scale air-sea interactions affecting the atmosphere and the ocean. Ocean vector winds are dynamic, continually evolving over short time scales.  This characteristic makes the production of global, gridded, <strong>gap-free</strong> wind fields a challenge, especially at temporal scales of less than one day and spatial scales smaller than typical wind features. </p>
<p>Accurate research requires ocean vector wind data for a long enough time period to resolve <strong>wind-induced patterns</strong> such as the <code>El Niño-Southern Oscillation (ENSO)</code> and the <code>Madden-Julian Oscillation (MJO)</code>. Remote Sensing Systems has invested many years of research into validating and <strong>cross-calibrating</strong> <strong>passive and active</strong> microwave wind <strong>retrievals</strong> from satellites.</p>
<blockquote>
<p>介绍了数据应该需要反应相关现象；</p>
<p>passive 被动的</p>
<p>retrieval 挽回</p>
</blockquote>
<p>The Variational Analysis Method (VAM) of data assimilation was utilized by Atlas et al. [1996, 2011] to find the most dynamically suitable way to combine satellite observations and in situ wind measurements into gap-free wind fields.  The VAM generates a gridded surface wind analysis which minimizes an objective function measuring the misfit of the analysis to the background, the data and certain a priori constraints. </p>
<blockquote>
<p>介绍VAM方法及其作用；</p>
</blockquote>
<p>The CCMP wind analyses are at temporal and spatial resolutions suitable for scientific study. <strong>The CCMP Version 2.0 (V2) data product described here is a continuation of the highly-used original CCMP product</strong> (V1.1 available from NASA JPL PO.DAAC) and builds on the decades of careful VAM development. Two peer-reviewed publications (Atlas et al. 1996, Atlas et al., 2011) describe the original CCMP product and (Hoffman et al, 2003) describes the VAM.  This documentation describes the new CCMP V2.0 product available from Remote Sensing Systems.</p>
<p>The original V1.1 CCMP product was processed <strong>incrementally</strong>, over a number of years, in small batches using the satellite data available at the time of processing, and therefore, <font color="red">assimilated inconsistently processed satellite winds</font>.  That is, <code>earlier V4 through V6 RSS winds</code> were used for early production years with <code>V7 winds</code> for the later few years of production.  Funding for the original CCMP (V1.1) ended in 2012 with no CCMP winds produced since December 2011.  There has been considerable demand for the continuation of the CCMP product, so we have transitioned the code to RSS with the purpose of meeting several distinct goals: </p>
<ul>
<li>Extend the product to the present time and continue processing into the future.</li>
<li>Reprocess using a consistent version of satellite data.</li>
<li>Add newly available sensors.</li>
<li>Utilize a higher resolution and consistently produced background model wind field throughout the analysis product.</li>
</ul>
<blockquote>
<p>incrementally 递增的</p>
</blockquote>
<p>We provide the Level-3.0 (L3.0) and Level-3.5 (L3.5) CCMP V2.0 products in netCDF4 format.</p>
<ul>
<li>The L3.0 CCMP V2.0 product contains four daily maps (00, 06, 12, and 18Z) of U and V vector wind components on a 0.25 degree global grid. The U and V components are relative to true north. The L3.0 data also includes maps of the number of observations (both satellite and in situ) that were analyzed at each location.</li>
<li>The L3.5 CCMP V2.0 contains monthly winds averaged over the calendar month. Vector averages are computed for U and V. The average wind W is computed using a scalar average.</li>
<li>Updates to the CCMP V2.0 product will be made roughly twice a year, to complete processing through December and June.</li>
<li>The most recent update occurred in March 2018, and CCMP is now updated through December 30, 2017.</li>
</ul>
<h3 id="Product-Development"><a href="#Product-Development" class="headerlink" title="Product Development"></a>Product Development</h3><p>The CCMP data set combines cross-calibrated satellite microwave winds and instrument observations using a Variational Analysis Method (VAM) to produce high-resolution (0.25 degree) gridded analyses. </p>
<p>Satellite wind retrievals derived by <strong>Remote Sensing Systems</strong> from a number of satellite-borne passive and active microwave instruments are used. RSS intercalibrates radiometers at the brightness temperature level to within 0.2 degree Celsius, applying a refined sea-surface emissivity model and radiative transfer function to derive surface winds. The resulting wind retrievals are highly consistent between microwave radiometer instrument platforms, including <a target="_blank" rel="noopener" href="https://www.remss.com/missions/ssmi">SSM/I</a>, <a target="_blank" rel="noopener" href="https://www.remss.com/missions/ssmi">SSMIS</a>, <a target="_blank" rel="noopener" href="https://www.remss.com/missions/amsr">AMSR</a>, <a target="_blank" rel="noopener" href="https://www.remss.com/missions/tmi">TMI</a>, <a target="_blank" rel="noopener" href="https://www.remss.com/missions/windsat">WindSat</a>, and <a target="_blank" rel="noopener" href="https://www.remss.com/missions/gmi">GMI</a>. RSS has also developed a geophysical model function for deriving wind speeds and directions from microwave scatterometers, including <a target="_blank" rel="noopener" href="https://www.remss.com/missions/qscat">QuikSCAT</a> and <a target="_blank" rel="noopener" href="https://www.remss.com/missions/ascat">ASCAT</a>. </p>
<p>Both radiometer and scatterometer data are validated against ocean <strong>moored buoys</strong>, which confirm the measurements are in agreement (to within 0.8 m/s) despite the difference in wind measurement and retrieval methodologies. </p>
<p>The <strong>VAM</strong> combines RSS instrument data with moored buoy measurements and a starting estimate (first-guess) of the wind field. </p>
<p>The European Center for Medium-Range Weather Forecasts (<strong>ECMWF</strong>) <a target="_blank" rel="noopener" href="http://www.ecmwf.int/en/research/climate-reanalysis/era-interim">ERA-Interim Reanalysis</a> winds are used in the CCMP V2.0 processing as <strong>the first-guess wind field</strong>. This 0.25 deg model wind field is consistently processed, as opposed to that of the ECMWF operational model for which the model changes over time.  </p>
<p>All wind observations (satellite and buoy) and model analysis fields are referenced to <strong>a height of 10 meters</strong>.</p>
<h4 id="CCMP-VERSION-2-UPDATES"><a href="#CCMP-VERSION-2-UPDATES" class="headerlink" title="CCMP VERSION-2 UPDATES"></a>CCMP VERSION-2 UPDATES</h4><p>RSS cooperated with Dr. Ross Hoffman and Mark Leidner to transition the maintenance, update, and continued processing of CCMP. Once the transition was confirmed to be accurately functioning, RSS conducted a full reprocessing of the CCMP data set bringing it out of first-look status and delivering a consistently-reprocessed V2.0 data product for public use in scientific research. The version changes associated with the RSS V2.0 CCMP release include:</p>
<ul>
<li>Use of uniform inputs and satellite retrievals, with all satellite winds produced using RSS Version-7 (or higher) Ocean Radiative Transfer Model (ORTM) and a consistent processing methodology.</li>
<li>Extension of the CCMP data set to July 2015 with plans to provide bi-annual extensions and updates to the dataset.</li>
<li>Addition of winds from new instruments: ASCAT Metop-A, AMSR2, and GMI.</li>
<li>Upgrade of the first-guess background wind field.  Now using the 0.25-deg, 6-hourly ERA-Interim Reanalysis winds.</li>
<li>Use of improved moored buoy data with better quality control, including winds from NDBC, TAO, TRITON, RAMA, PIRATA, and Canadian buoys.</li>
<li>Upgrade of the data file format to netCDF4 with CF-1.6 metadata.  Each daily file contains four 6-hourly wind analyses and self-describing metadata.</li>
</ul>
<p>A time series of all input data used in the VAM is shown below.  Passive radiometers are plotted in red and active scatterometers are plotted in green.  The version of data used for each instrument is provided. The moored buoy winds and ERA-Interim Reanalysis winds are available for the entire data range.  Quality controlled buoy data have been obtained from the Pacific Marine Environmental Lab (<a target="_blank" rel="noopener" href="http://www.pmel.noaa.gov/">PMEL</a>), from the National Data Buoy Center (<a target="_blank" rel="noopener" href="http://www.ndbc.noaa.gov/">NDBC</a>), and from the Fisheries and Ocean Canada Oceanography and Scientific Data branch (<a target="_blank" rel="noopener" href="http://www.meds-sdmm.dfo-mpo.gc.ca/isdm-gdsi/waves-vagues/index-eng.htm">OSD</a>).  </p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204175150.png"></p>
<p>Full reprocessing of the entire data set takes approximately 1-2 months. Twice per year, in January and July, we will update the data product to include the past 6 months.  For example, in January 2017, we will release June 2016 to December 2016. In transitioning the code to run at RSS, special care was taken to make no changes to the overall approach or the methodology of the original CCMP product.  The code was changed, only where necessary, to account for changes in system architecture and compilers. Source code that was needed for the addition of new satellite winds (AMSR2 or GMI) was adapted from already existing code. This type of careful transition ensures that the same high-quality CCMP product is still produced, but with updated satellite, buoy and model wind data as input.</p>
<h3 id="Data-Product-Format"><a href="#Data-Product-Format" class="headerlink" title="Data Product Format"></a>Data Product Format</h3><p>The CCMP V2.0 Level-3.0 (<strong>L3.0</strong>) winds are available as netCDF-4 data files. Each L3.0 daily data file contains <strong>3 arrays</strong> of size <strong>1440</strong> (longitude) by <strong>628</strong> (latitude for range -78.375 to 78.375) by <strong>4</strong> (time of 0Z, 06Z, 12Z, 18Z). Two of the arrays are the U and V wind components in <strong>meters/second (m/s)</strong>. Standard U and V coordinates apply, meaning the <strong>positive U is to the right</strong> and <strong>positive V is above the axis</strong>. U and V are relative to true north. CCMP winds are expressed using the oceanographic convention, meaning <strong>a wind blowing toward the Northeast</strong> has a positive U component and a positive V component. The third array in the file is the number of observations (nobs) used to derive the wind components. A nobs value of 0.0 means that the wind vector for that grid cell is very close to the wind vector from the background field because no satellite or moored buoy wind data were available to directly influence the analyzed vector wind.</p>
<p>The CCMP V2.0 Level-3.5 (<strong>L3.5</strong>) winds are available as netCDF-4 data files. Each L3.5 monthly data file contains 3 arrays of size 1440 (longitude) by 628 (latitude for range -78.375 to 78.375) by <strong>1</strong> (time centered on the middle of the calendar month). The first two arrays are the vector-averaged U and V wind components in meters/second (m/s). The third array contains the scalar-averaged wind speed W for each location. Note that in regions with wind directions that vary substantially over time, W can be much higher than the magnitude of the vector-average components U and V.</p>
<p>A fill value of <strong>-9999.0</strong> is used for any grid cell without any data. This should rarely happen. Longitude is given in degrees East from 0.125 to 359.875 and latitude is given in degrees North with negative values representing southern locations. While this is referred to as a global wind product, the extent of the data is  <strong>-79</strong> degrees to <strong>79</strong> degrees latitude.  The time in the file is given as hours since midnight on Jan 1, <strong>1987</strong>.</p>
<p>The netCDF file contains CF 1.6-compliant self-describing metadata.  The JPL metadata compliance checker was used to assess compliance. The RSS CCMP V2.0 data set is distributed as L3.0 daily and L3.5 monthly files. The V1.1 CCMP data set available from PO.DAAC also contained L2.5 (vectors on satellite data) and L3.5 pentad data products. However, RSS has chosen to not distribute the L2.5 or L3.5 pentad data products at this time.</p>
<h4 id="MISSING-DATA"><a href="#MISSING-DATA" class="headerlink" title="MISSING DATA"></a>MISSING DATA</h4><p>There are <strong>gaps</strong> within these data. There are <strong>11 days</strong> scattered between May and December of 1988 and <strong>14 days</strong> in January through July 1989 that do not appear on our FTP server</p>
<p>During this time period, F08 is the only operational satellite input into the dataset. Days that are missing are because there was either very little or no data collected by the satellite on that day.</p>
<p>In future reprocessing, we may include these files for completeness, but the CCMP wind field would essentially be just the <strong>ERA-Int</strong> background except for minor differences near buoys.</p>
<h3 id="Read-Routines-Data-Access"><a href="#Read-Routines-Data-Access" class="headerlink" title="Read Routines / Data Access"></a>Read Routines / Data Access</h3><p>The CCMP netCDF4 files can be <strong>explored</strong> using tools such as <a target="_blank" rel="noopener" href="http://www.giss.nasa.gov/tools/panoply/">Panoply</a> or <a target="_blank" rel="noopener" href="http://www.epic.noaa.gov/java/ncBrowse/">ncBrowse</a>.  Matlab, IDL, and Python have built-in routines for <strong>reading netCDF files</strong>.  We have provided a sample read routine in <strong>Python</strong>.  The routine will plot and display the data for an example file.  CCMP data files can be obtained from RSS by <a target="_blank" rel="noopener" href="http://ftp2.remss.com/ccmp">ftp</a> and <a target="_blank" rel="noopener" href="http://data.remss.com/ccmp">http</a>.  </p>
<blockquote>
<p>remss：remote sensing system</p>
</blockquote>
<p>File names have the structure <strong>CCMP_Wind_Analysis_YYYYMMDD_V02.0_L3.0_RSS.nc</strong> where YYYY is the 4-digit year, MM the month and DD the day-of-month. The files are stored in <strong>v02.0/Yyyyy/Mmm/</strong> directory structure.</p>
<h3 id="Browse-Images-Graphic-Maps"><a href="#Browse-Images-Graphic-Maps" class="headerlink" title="Browse Images / Graphic Maps"></a>Browse Images / Graphic Maps</h3><p>The following movies loop through the full 28 years of data.</p>
<p><a target="_blank" rel="noopener" href="http://images.remss.com/figures/measurements/ccmp/ccmp_v2.0_wind_speed.avi">CCMP Wind Speed Animation</a></p>
<blockquote>
<p>已上传至个人B站：</p>
<div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
    <iframe src="//player.bilibili.com/player.html?aid=851317250&amp;bvid=BV17L4y1s7JW&amp;cid=501309410&amp;page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe>   
</div>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://images.remss.com/figures/measurements/ccmp/ccmp_v2.0_wind_speed_anomaly.avi">CCMP Wind Speed Anomaly Animation</a></p>
<blockquote>
<p>已上传至个人B站：</p>
<div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
    <iframe src="//player.bilibili.com/player.html?aid=723865080&amp;bvid=BV1QS4y1k7ku&amp;cid=501318221&amp;page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe>   
</div>
</blockquote>
<h3 id="Product-Details"><a href="#Product-Details" class="headerlink" title="Product Details"></a>Product Details</h3><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204224229.png" alt=" " style="zoom:60%;">

<h3 id="Known-Issues-Data-Caveats"><a href="#Known-Issues-Data-Caveats" class="headerlink" title="Known Issues / Data Caveats"></a>Known Issues / Data Caveats</h3><p>The following information should be taken into consideration when using this data product:</p>
<ul>
<li><strong>Users should not consider these winds suitable for studying global trends</strong>.  While the winds are derived from consistently processed satellite data suitable for climate study, the act of assimilating the model data into an analysis product potentially introduces spurious trends that may exist in the background wind field. These CCMP V2.0 winds may, however, be suitable for studying regional trends and patterns.</li>
<li><strong>Caution should be used when studying high wind regions</strong>. We have noted differences between satellite data and the CCMP winds at high wind speeds (&gt;25 m/s), where the background model wind is known to underestimate wind events. Since the VAM method attempts to find a consistent wind field solution somewhere between the satellite-observed high wind events and the lower model winds for those same events, CCMP, as a wind analysis product, will inevitably be lower than the satellite data indicates. Note, wind events of this magnitude tend to be infrequent and geographically limited. </li>
<li><strong>The V2.0 winds are different from the V1.1 winds</strong>.  Users should not compare or mix the two products. Differences between the versions do exist and are related to the changes in the satellite data and background wind field.  For example, the new Ku-2011 GMF QuikSCAT winds are much improved at high wind speeds resulting in lower CCMP V2.0 winds at speeds greater than 25 m/s when compared to the CCMP V1.1 winds.</li>
</ul>
<h3 id="Related-Data"><a href="#Related-Data" class="headerlink" title="Related Data"></a>Related Data</h3><p>The <a target="_blank" rel="noopener" href="http://podaac.jpl.nasa.gov/dataset/CCMP_MEASURES_ATLAS_L4_OW_L3_0_WIND_VECTORS_FLK">original CCMP V1.1 FLK data</a> are available at the NASA Physical Oceanography DAAC (podaac.jpl.nasa.gov)</p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p>Atlas, R., R. N. Hoffman, J. Ardizzone, S. M. Leidner, J. C. Jusem, D. K. Smith, D. Gombos, 2011: A cross-calibrated, multiplatform ocean surface wind velocity product for meteorological and oceanographic applications. Bull. Amer. Meteor. Soc., 92, 157-174. doi: 10.1175/2010BAMS2946.1</p>
<p>Atlas, R., R.N. Hoffman, S.C. Bloom, J.C. Jusem, and J. Ardizzone, 1996: A multiyear global surface wind velocity dataset using SSM/I wind observations. Bull. Amer. Meteor. Soc., 77, 5, 869-882.</p>
<p>Hoffman, R. N., M. Leidner, J. M. Henderson, R. Atlas, J. V. Ardizzone, and S. C. Bloom, 2003: A two-dimensional variational analysis method for NSCAT ambiguity removal: methodology, sensitivity, and tuning. Journal of Atmospheric &amp; Oceanic Technology, 20, 585-605.</p>
<p>The original V1.1 <a href="ftp://podaac-ftp.jpl.nasa.gov/allData/ccmp/L2.5/docs/ccmp_users_guide.pdf">Cross-Calibrated Multi-Platform Ocean Surface Wind Vector Analyses User Guide</a> (.pdf) available from JPL PO.DAAC.</p>
<h3 id="How-to-Cite-These-Data"><a href="#How-to-Cite-These-Data" class="headerlink" title="How to Cite These Data"></a>How to Cite These Data</h3><p>Continued production of this data set requires support from NASA. We need you to be sure to cite these data when used in your publications so that we can demonstrate the value of this data set to the scientific community. Please include the following statement in the acknowledgement section of your paper:</p>
<p>“CCMP Version-2.0 vector wind analyses are produced by Remote Sensing Systems. Data are available at <a target="_blank" rel="noopener" href="http://www.remss.com/">www.remss.com</a>.”</p>
<h4 id="DATA-SET-CITATION"><a href="#DATA-SET-CITATION" class="headerlink" title="DATA SET CITATION"></a>DATA SET CITATION</h4><p>Wentz, F.J., J. Scott, R. Hoffman, M. Leidner, R. Atlas, J. Ardizzone, 2015:  Remote Sensing Systems Cross-Calibrated Multi-Platform (CCMP) 6-hourly ocean vector wind analysis product on 0.25 deg grid, Version 2.0, [indicate date subset, if used]. Remote Sensing Systems, Santa Rosa, CA. Available online at <a target="_blank" rel="noopener" href="http://www.remss.com/measurements/ccmp">www.remss.com/measurements/ccmp</a>. [Accessed dd mmm yyyy].  *Insert the appropriate information in the brackets.</p>
<h4 id="JOURNAL-REFERENCE"><a href="#JOURNAL-REFERENCE" class="headerlink" title="JOURNAL REFERENCE"></a>JOURNAL REFERENCE</h4><p>Atlas, R., R. N. Hoffman, J. Ardizzone, S. M. Leidner, J. C. Jusem, D. K. Smith, D. Gombos, 2011: A cross-calibrated, multiplatform ocean surface wind velocity product for meteorological and oceanographic applications. Bull. Amer. Meteor. Soc., 92, 157-174. doi: 10.1175/2010BAMS2946.1</p>
<p>Mears, C. A., Scott, J., Wentz, F. J., Ricciardulli, L., Leidner, S. M., Hoffman, R., &amp; Atlas, R. ( 2019). A Near Real Time Version of the Cross Calibrated Multiplatform (CCMP) Ocean Surface Wind Velocity Data Set. Journal of Geophysical Research: Oceans, 124, 6997– 7010. <a target="_blank" rel="noopener" href="https://doi.org/10.1029/2019JC015367">https://doi.org/10.1029/2019JC015367</a></p>
<h2 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h2><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220209143119.png" style="zoom:80%;">

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38882446/article/details/111371015">https://blog.csdn.net/qq_38882446/article/details/111371015</a></p>
<blockquote>
<p>matlab, web 函数</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_aed5bd1d0102wusz.html">http://blog.sina.com.cn/s/blog_aed5bd1d0102wusz.html</a></p>
<blockquote>
<p>matlab, urlwrite 函数</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.ilovematlab.cn/thread-253224-1-1.html?s_tid=RelatedContent">https://www.ilovematlab.cn/thread-253224-1-1.html?s_tid=RelatedContent</a></p>
<blockquote>
<p>matlab，判断选择的日期不存在</p>
</blockquote>
<h2 id="下载CCMP数据（matlab-urlwrite-函数）"><a href="#下载CCMP数据（matlab-urlwrite-函数）" class="headerlink" title="下载CCMP数据（matlab, urlwrite 函数）"></a>下载CCMP数据（matlab, urlwrite 函数）</h2><p>下载所需程序<code>download_ccmp.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%% 说明</span>
<span class="token comment">% ccmp v02.0 数据下载网址：https://data.remss.com/ccmp/v02.0/</span>


<span class="token comment">%% L3.0数据下载</span>
filepath<span class="token operator">=</span><span class="token string">'D:\ccmp\data_L3\'</span><span class="token punctuation">;</span> <span class="token function">mkdir</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%创建相应文件夹，下载的数据保存到此文件夹；(注意，路径的最后面必须为 \ )；</span>

<span class="token comment">% url特点：需要3个通配符</span>
<span class="token comment">% https://data.remss.com/ccmp/v02.0/Y1990/M02/CCMP_Wind_Analysis_19900201_V02.0_L3.0_RSS.nc</span>
<span class="token comment">%                                    1987:1:2019</span>
<span class="token comment">%                                          01:1:12</span>
<span class="token comment">%                                                                          01:1:31</span>

<span class="token comment">% 最全的通配符</span>
<span class="token comment">% year = num2str([1987:1:2019]');  year(2,:); size(year);%通配符 year；</span>
<span class="token comment">% month = num2str([1:1:12]','%02d'); month(2,:); %通配符 month；</span>
<span class="token comment">% day = num2str([1:1:31]','%02d'); day(2,:); %通配符 day；</span>

<span class="token comment">% 应用中的通配符</span>
year <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2011</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%通配符 year；</span>
month <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token string">','</span><span class="token comment">%02d'); %通配符 month；</span>
day <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token string">','</span><span class="token comment">%02d'); %通配符 day；</span>

<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>month<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>day<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token comment">% 判断日期存不存在</span>
            ts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">year</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token function">day</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span>
                tf <span class="token operator">=</span> <span class="token function">isdatetime</span><span class="token punctuation">(</span><span class="token function">datetime</span><span class="token punctuation">(</span>ts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%不用try，这一行会报错。</span>
            <span class="token keyword">catch</span>
                tf <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            
            <span class="token keyword">if</span><span class="token punctuation">(</span>tf<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">%日期存在</span>
                <span class="token comment">%https://data.remss.com/ccmp/v02.0/Y1990/M02/CCMP_Wind_Analysis_19900201_V02.0_L3.0_RSS.nc</span>
                fullURL<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'https://data.remss.com/ccmp/v02.0/Y'</span><span class="token punctuation">,</span><span class="token function">year</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
                    <span class="token string">'/M'</span><span class="token punctuation">,</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">...</span>
                    <span class="token string">'/CCMP_Wind_Analysis_'</span><span class="token punctuation">,</span><span class="token function">year</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">day</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'_V02.0_L3.0_RSS.nc'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%下载所需要的url</span>
                filename<span class="token operator">=</span><span class="token punctuation">[</span>filepath<span class="token punctuation">,</span><span class="token string">'CCMP_Wind_Analysis_'</span><span class="token punctuation">,</span><span class="token function">year</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">day</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'_V02.0_L3.0_RSS.nc'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%保存的文件名</span>
                
                tic <span class="token comment">% 记录下载的时间</span>
                <span class="token punctuation">[</span>f<span class="token punctuation">,</span>status<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">urlwrite</span><span class="token punctuation">(</span>fullURL<span class="token punctuation">,</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%下载命令</span>
                <span class="token keyword">if</span> status<span class="token operator">==</span><span class="token number">1</span> <span class="token comment">%下载成功</span>
                    t<span class="token operator">=</span>toc<span class="token punctuation">;</span>
                    lst<span class="token operator">=</span><span class="token function">dir</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%了解文件的大小</span>
                    xi<span class="token operator">=</span>lst<span class="token punctuation">.</span>bytes<span class="token punctuation">;</span>
                    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'CCMP_Wind_Analysis_'</span><span class="token punctuation">,</span><span class="token function">year</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">day</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'_V02.0_L3.0_RSS.nc'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
                        <span class="token string">'下载成功，'</span><span class="token punctuation">,</span><span class="token string">'文件大小为'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>xi<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'M，'</span><span class="token punctuation">,</span><span class="token string">' 花费'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>t<span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'分钟。'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span>
                    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'CCMP_Wind_Analysis_'</span><span class="token punctuation">,</span><span class="token function">year</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">day</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'_V02.0_L3.0_RSS.nc'</span><span class="token punctuation">,</span><span class="token string">'下载失败。'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
            <span class="token keyword">else</span>
                <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span>ts<span class="token punctuation">,</span><span class="token string">'日期不存在。'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">%% L3.5数据下载</span>
<span class="token comment">% ...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行程序后，会下载20110901-20110910的数据，可以根据自己需求改变时间段。</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220209165430.png"></p>
<h2 id="参考资料-2"><a href="#参考资料-2" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/schumacher2016/article/details/82852700">https://blog.csdn.net/schumacher2016/article/details/82852700</a></p>
<blockquote>
<p>多个netcdf文件的合并（matlab）</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/muse_squirrel/article/details/76014446">https://blog.csdn.net/muse_squirrel/article/details/76014446</a></p>
<blockquote>
<p>Matlab 查阅、读取nc数据</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/ref/netcdf.redef.html">https://ww2.mathworks.cn/help/matlab/ref/netcdf.redef.html</a></p>
<blockquote>
<p>netcdf.reDef</p>
</blockquote>
<h2 id="合并CCMP的nc数据（matlab）"><a href="#合并CCMP的nc数据（matlab）" class="headerlink" title="合并CCMP的nc数据（matlab）"></a>合并CCMP的nc数据（matlab）</h2><p>查阅某一个CCMP的nc文件，matlab输出如下：</p>
<pre class="line-numbers language-none"><code class="language-none">&gt;&gt; ncdisp(strcat(datadir,filelist(i).name),'/','full')
Source:
           D:\ccmp\data_L3\CCMP_Wind_Analysis_20110902_V02.0_L3.0_RSS.nc
Format:
           netcdf4_classic
Global Attributes:
           contact                   = 'Remote Sensing Systems, support@remss.com'
           Conventions               = 'CF-1.6'
           data_structure            = 'grid'
           title                     = 'RSS CCMP V2.0 derived surface winds (Level 3.0)'
           history                   = '20160212T164116ZZ - netCDF generated from original data using MATLAB 8.5.0 by RSS vam_v2.0.analysis.t20110902.z00.dat; vam_v2.0.analysis.t20110902.z06.dat; vam_v2.0.analysis.t20110902.z12.dat; vam_v2.0.analysis.t20110902.z18.dat'
           description               = 'RSS VAM 6-hour analyses starting from the ERA-Interim wind analyses'
           summary                   = 'CCMP V2.0 has been created using the same VAM as CCMP V1.1 only it is now running at Remote Sensing Systems. Input data have changed and now include all V7 radiometer data from RSS, V8.1 GMI data from RSS, scatterometer data from RSS (V4 QuikSCAT and V1.2 ASCAT), quality checked moored buoy data from NDBC, PMEL, and ISDM, and ERA-Interim data from ECMWF.'
           institute_id              = 'RSS'
           institution               = 'Remote Sensing Systems (RSS)'
           base_date                 = 'Y2011 M09 D02'
           comment                   = 'none'
           license                   = 'available for public use with proper citation'
           product_version           = 'v2.0'
           netcdf_version_id         = '4.2'
           date_created              = '20160212T164116Z'
           geospatial_lat_units      = 'degrees_north'
           geospatial_lat_resolution = '0.25 degrees'
           geospatial_lat_min        = '-78.375 degrees'
           geospatial_lat_max        = '78.375 degrees'
           geospatial_lon_units      = 'degrees_east'
           geospatial_lon_resolution = '0.25 degrees'
           geospatial_lon_min        = '0.125 degrees'
           geospatial_lon_max        = '359.875 degrees'
           creator_name              = 'Remote Sensing Systems'
           creator_email             = 'support@remss.com'
           creator_url               = 'http://www.remss.com/'
           project                   = 'RSS Cross-Calibrated Multi-Platform Ocean Surface Wind Project'
           publisher_name            = 'Remote Sensing Systems'
           publisher_email           = 'support@remss.com'
           publisher_url             = 'http://www.remss.com/'
           contributor_name          = 'Joel Scott, Frank Wentz, Ross Hoffman, Mark Leidner, Robert Atlas, Joe Ardizzone'
           contributor_role          = 'Software Engineer, Project Lead, Co-Investigator, Software Engineer, Principal Investigator, Software Engineer'
           processing_level          = 'L3.0'
           keywords                  = 'surface winds, ocean winds, wind speed/wind direction, MEaSUREs, 10km - &lt; 50km or approximately 0.09 degree - &lt; 0.5 degree'
           keywords_vocabulary       = 'GCMD Science Keywords'
           references                = 'Hoffman et al., Journal of Atmospheric and Oceanic Technology, 2013; Atlas et al., BAMS, 2011; Atlas et al., BAMS, 1996'
Dimensions:
           longitude = 1440
           latitude  = 628
           time      = 4
Variables:
    longitude
           Size:       1440x1
           Dimensions: longitude
           Datatype:   single
           Attributes:
                       standard_name       = 'longitude'
                       long_name           = 'Longitude in degrees east'
                       units               = 'degrees_east'
                       _Fillvalue          = -9999
                       axis                = 'X'
                       valid_min           = 0.125
                       valid_max           = 359.875
                       _CoordinateAxisType = 'Lon'
                       coordinate_defines  = 'center'
    latitude 
           Size:       628x1
           Dimensions: latitude
           Datatype:   single
           Attributes:
                       standard_name       = 'latitude'
                       long_name           = 'Latitude in degrees north'
                       units               = 'degrees_north'
                       _Fillvalue          = -9999
                       axis                = 'Y'
                       valid_min           = -78.375
                       valid_max           = 78.375
                       _CoordinateAxisType = 'Lat'
                       coordinate_defines  = 'center'
    time     
           Size:       4x1
           Dimensions: time
           Datatype:   double
           Attributes:
                       standard_name       = 'time'
                       long_name           = 'Time of analysis'
                       units               = 'hours since 1987-01-01 00:00:00'
                       delta_t             = '0000-00-00 06:00:00'
                       avg_period          = ''
                       _Fillvalue          = -9999
                       calendar            = 'standard'
                       axis                = 'T'
                       valid_min           = 216240
                       valid_max           = 216258
                       _CoordinateAxisType = 'Time'
    uwnd     
           Size:       1440x628x4
           Dimensions: longitude,latitude,time
           Datatype:   single
           Attributes:
                       standard_name = 'eastward_wind'
                       long_name     = 'u-wind vector component at 10 meters'
                       units         = 'm s-1'
                       height        = '10 meters above sea-level'
                       _Fillvalue    = -9999
                       valid_min     = -29.0874
                       valid_max     = 28.8251
                       coordinates   = 'time latitude longitude'
    vwnd     
           Size:       1440x628x4
           Dimensions: longitude,latitude,time
           Datatype:   single
           Attributes:
                       standard_name = 'northward_wind'
                       long_name     = 'v-wind vector component at 10 meters'
                       units         = 'm s-1'
                       height        = '10 meters above sea-level'
                       _Fillvalue    = -9999
                       valid_min     = -23.203
                       valid_max     = 32.6429
                       coordinates   = 'time latitude longitude'
    nobs     
           Size:       1440x628x4
           Dimensions: longitude,latitude,time
           Datatype:   single
           Attributes:
                       standard_name       = 'number_of_observations'
                       long_name           = 'number of observations used to derive wind vector components'
                       units               = 'count'
                       _Fillvalue          = -9999
                       ancillary_variables = 'uwnd vwnd'
                       valid_min           = 0
                       valid_max           = 10
                       coordinates         = 'time latitude longitude'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里给出将20110901-20110910的nc文件合并的程序<code>merge_ccmp.m</code>，可以根据自己需求改变相关参数：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%%</span>
<span class="token comment">% desciption: merge multiple netcdf files for sepcific domain</span>

<span class="token comment">% usage:</span>
<span class="token comment">%    1. filenumber is up to the number of your netcdf file to be processed.</span>
<span class="token comment">%    2. for different domain you want to process, you can change the number</span>
<span class="token comment">% in the latitude0, longitude0, uwind0, vwind0.</span>

<span class="token comment">% author:</span>
<span class="token comment">%    huang xue zhi, dalian university of technology</span>

<span class="token comment">% revison history</span>
<span class="token comment">%    2018-09-25 first verison.</span>

<span class="token comment">%%</span>
clear<span class="token punctuation">;</span>clc<span class="token punctuation">;</span>

<span class="token comment">% begin to merge multiple netcdf files,for example,ccmp wind field reanalysis.</span>



<span class="token comment">% define the data path and filelist</span>
datadir<span class="token operator">=</span><span class="token string">'D:\ccmp\data_L3\'</span><span class="token punctuation">;</span>
filelist<span class="token operator">=</span><span class="token function">dir</span><span class="token punctuation">(</span><span class="token punctuation">[</span>datadir<span class="token punctuation">,</span><span class="token string">'*.nc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">% define the total numbers of netcdf files to be processed.</span>
filenumber<span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>filelist<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%全部nc文件的数量</span>

<span class="token comment">%% batch reading from the netcdf file</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>filenumber
    <span class="token comment">% 查阅nc相关信息</span>
    <span class="token comment">%ncdisp(strcat(datadir,filelist(i).name),'/','min')</span>
    <span class="token comment">%ncdisp(strcat(datadir,filelist(i).name),'/','full')</span>
    
    <span class="token comment">% batch reading the variable to another arrays.</span>
    ncid<span class="token operator">=</span><span class="token punctuation">[</span>datadir<span class="token punctuation">,</span><span class="token function">filelist</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    latitude0<span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%0.25间隔</span>
    longitude0<span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%0.25间隔</span>
    <span class="token function">time</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">% 增加了数组维数，保留信息。</span>
    <span class="token function">uwind0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'uwnd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 增加了数组维数，保留信息。</span>
    <span class="token function">vwind0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'vwnd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 增加了数组维数，保留信息。</span>
    
    <span class="token comment">%区域纬度的选择</span>
    <span class="token comment">%latitude=latitude0(74:435);</span>
    <span class="token comment">%longitude=longitude0(80:481);</span>
    <span class="token comment">%uwind(:,:,:,i)=uwind0(80:481,74:435,:,i);</span>
    <span class="token comment">%vwind(:,:,:,i)=vwind0(80:481,74:435,:,i);</span>
    latitude<span class="token operator">=</span>latitude0<span class="token punctuation">;</span>
    longitude<span class="token operator">=</span>longitude0<span class="token punctuation">;</span>
    uwind<span class="token operator">=</span>uwind0<span class="token punctuation">;</span>
    vwind<span class="token operator">=</span>vwind0<span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">%% create the merged netcdf file to store the result.</span>
filename <span class="token operator">=</span> <span class="token string">'ccmp20110901to10.nc'</span><span class="token punctuation">;</span> <span class="token comment">%合成的nc文件名称</span>
cid<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'clobber'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% help netcdf.create</span>


<span class="token comment">%define global attributes</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'Conventions'</span><span class="token punctuation">,</span><span class="token string">'CF-1.6'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% help netcdf.putAtt</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lat_min'</span><span class="token punctuation">,</span><span class="token string">'-78.375 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lat_max'</span><span class="token punctuation">,</span><span class="token string">'78.375 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lon_min'</span><span class="token punctuation">,</span><span class="token string">'0.125 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lon_max'</span><span class="token punctuation">,</span><span class="token string">'359.875 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'institution'</span><span class="token punctuation">,</span><span class="token string">'RSS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% define the variable dimension</span>
dimlon<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defDim</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>longitude<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dimlat<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defDim</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>latitude<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dimtime<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defDim</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">,</span>filenumber<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%每天有4个时间结点</span>


<span class="token comment">% define the variable and their attributes</span>
varid1<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">,</span><span class="token string">'NC_DOUBLE'</span><span class="token punctuation">,</span>dimtime<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'Time of analysis'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'hours since 1987-01-01 00:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'delta_t'</span><span class="token punctuation">,</span><span class="token string">'0000-00-00 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

varid2<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'NC_FLOAT'</span><span class="token punctuation">,</span>dimlat<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'degrees_north'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'Latitude in degrees north'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'_Fillvalue'</span><span class="token punctuation">,</span><span class="token string">'-9999.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'axis'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


varid3<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'NC_FLOAT'</span><span class="token punctuation">,</span>dimlon<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'degrees_east'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'Longitude in degrees east'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'_Fillvalue'</span><span class="token punctuation">,</span><span class="token string">'-9999.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'axis'</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


varid4<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'u10'</span><span class="token punctuation">,</span><span class="token string">'NC_FLOAT'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>dimlon dimlat dimtime<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'eastward_wind'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'u-wind vector component at 10 meters'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'m s-1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'_Fillvalue'</span><span class="token punctuation">,</span><span class="token string">'-9999.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'coordinates'</span><span class="token punctuation">,</span><span class="token string">'time latitude longitude'</span><span class="token punctuation">)</span>


varid5<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'v10'</span><span class="token punctuation">,</span><span class="token string">'NC_FLOAT'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>dimlon dimlat dimtime<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'northward_wind'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'v-wind vector component at 10 meters'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'m s-1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'_Fillvalue'</span><span class="token punctuation">,</span><span class="token string">'-9999.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'coordinates'</span><span class="token punctuation">,</span><span class="token string">'time latitude longitude'</span><span class="token punctuation">)</span>

netcdf<span class="token punctuation">.</span><span class="token function">endDef</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% end define the varible and attributes</span>


<span class="token comment">%% write variables value to merged netcdf file</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span>uwind<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span>vwind<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% 添加存储空间属性</span>
netcdf<span class="token punctuation">.</span><span class="token function">reDef</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%data mode 不能进行使用 putAtt，故进入 def mode；</span>
lst<span class="token operator">=</span><span class="token function">dir</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span> xi<span class="token operator">=</span>lst<span class="token punctuation">.</span>bytes<span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'space size'</span><span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token function">num2str</span><span class="token punctuation">(</span>xi<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'Mb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%ncdisp(filename,'/','full');</span>

netcdf<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行后，将生成合并的nc文件<code>ccmp20110901to10.nc</code>，查阅：</p>
<pre class="line-numbers language-none"><code class="language-none">&gt;&gt; ncdisp(filename,'/','full')
Source:
           D:\ccmp\ccmp20110901to10.nc
Format:
           classic
Global Attributes:
           Conventions        = 'CF-1.6'
           geospatial_lat_min = '-78.375 degrees'
           geospatial_lat_max = '78.375 degrees'
           geospatial_lon_min = '0.125 degrees'
           geospatial_lon_max = '359.875 degrees'
           institution        = 'RSS'
           space size         = '275.9862Mb'
Dimensions:
           longitude = 1440
           latitude  = 628
           time      = 40
Variables:
    time     
           Size:       40x1
           Dimensions: time
           Datatype:   double
           Attributes:
                       standard_name = 'time'
                       long_name     = 'Time of analysis'
                       units         = 'hours since 1987-01-01 00:00:00'
                       delta_t       = '0000-00-00 06:00:00'
    latitude 
           Size:       628x1
           Dimensions: latitude
           Datatype:   single
           Attributes:
                       standard_name = 'time'
                       units         = 'degrees_north'
                       long_name     = 'Latitude in degrees north'
                       _Fillvalue    = '-9999.0'
                       axis          = 'Y'
    longitude
           Size:       1440x1
           Dimensions: longitude
           Datatype:   single
           Attributes:
                       standard_name = 'longitude'
                       units         = 'degrees_east'
                       long_name     = 'Longitude in degrees east'
                       _Fillvalue    = '-9999.0'
                       axis          = 'X'
    u10      
           Size:       1440x628x40
           Dimensions: longitude,latitude,time
           Datatype:   single
           Attributes:
                       standard_name = 'eastward_wind'
                       long_name     = 'u-wind vector component at 10 meters'
                       units         = 'm s-1'
                       _Fillvalue    = '-9999.0'
                       coordinates   = 'time latitude longitude'
    v10      
           Size:       1440x628x40
           Dimensions: longitude,latitude,time
           Datatype:   single
           Attributes:
                       standard_name = 'northward_wind'
                       long_name     = 'v-wind vector component at 10 meters'
                       units         = 'm s-1'
                       _Fillvalue    = '-9999.0'
                       coordinates   = 'time latitude longitude'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="合并CCMP的nc数据（matlab，专门用于ww3-prnc）"><a href="#合并CCMP的nc数据（matlab，专门用于ww3-prnc）" class="headerlink" title="合并CCMP的nc数据（matlab，专门用于ww3_prnc）"></a>合并CCMP的nc数据（matlab，专门用于ww3_prnc）</h2><p>用上面的代码，实现的合并的nc文件，在执行ww3_prnc时，会出现<code>Segmentation fault - invalid memory reference</code>错误信息，与内存相关，原因是ww3_prnc中<code>_Fillvalue</code>这一项应该是<code>_FillValue</code>，且数值应该是<code>-9999</code>，而不需要加上<code>''</code>。</p>
<blockquote>
<p>直接使用ccmp的nc文件也会出现上述错误信息。</p>
</blockquote>
<p>这里给出将20110901-20110910的nc文件，用于ww3_prnc，合并的程序<code>merge_ccmp_ww3.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%%</span>
<span class="token comment">% desciption: merge multiple netcdf files for sepcific domain</span>

<span class="token comment">% usage:</span>
<span class="token comment">%    1. filenumber is up to the number of your netcdf file to be processed.</span>
<span class="token comment">%    2. for different domain you want to process, you can change the number</span>
<span class="token comment">% in the latitude0, longitude0, uwind0, vwind0.</span>

<span class="token comment">% author:</span>
<span class="token comment">%    huang xue zhi, dalian university of technology</span>
<span class="token comment">%    liu jin can, UPC</span>

<span class="token comment">% revison history</span>
<span class="token comment">%    2018-09-25 first verison.</span>
<span class="token comment">%    2022-02-10 ww3.</span>

<span class="token comment">%%</span>
clear<span class="token punctuation">;</span>clc<span class="token punctuation">;</span>

<span class="token comment">% begin to merge multiple netcdf files,for example,ccmp wind field reanalysis.</span>



<span class="token comment">% define the data path and filelist</span>
datadir<span class="token operator">=</span><span class="token string">'D:\ccmp\data_L3\'</span><span class="token punctuation">;</span>
filelist<span class="token operator">=</span><span class="token function">dir</span><span class="token punctuation">(</span><span class="token punctuation">[</span>datadir<span class="token punctuation">,</span><span class="token string">'*.nc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">% define the total numbers of netcdf files to be processed.</span>
filenumber<span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>filelist<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%全部nc文件的数量</span>

<span class="token comment">%% batch reading from the netcdf file</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>filenumber
    <span class="token comment">% 查阅nc相关信息</span>
    <span class="token comment">%ncdisp(strcat(datadir,filelist(i).name),'/','min')</span>
    <span class="token comment">%ncdisp(strcat(datadir,filelist(i).name),'/','full')</span>
    
    <span class="token comment">% batch reading the variable to another arrays.</span>
    ncid<span class="token operator">=</span><span class="token punctuation">[</span>datadir<span class="token punctuation">,</span><span class="token function">filelist</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    latitude0<span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%0.25间隔</span>
    longitude0<span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%0.25间隔</span>
    <span class="token function">time</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">% 增加了数组维数，保留信息。</span>
    <span class="token function">uwind0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'uwnd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 增加了数组维数，保留信息。</span>
    <span class="token function">vwind0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'vwnd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 增加了数组维数，保留信息。</span>
    
    <span class="token comment">%区域纬度的选择</span>
    <span class="token comment">%latitude=latitude0(74:435);</span>
    <span class="token comment">%longitude=longitude0(80:481);</span>
    <span class="token comment">%uwind(:,:,:,i)=uwind0(80:481,74:435,:,i);</span>
    <span class="token comment">%vwind(:,:,:,i)=vwind0(80:481,74:435,:,i);</span>
    latitude<span class="token operator">=</span>latitude0<span class="token punctuation">;</span>
    longitude<span class="token operator">=</span>longitude0<span class="token punctuation">;</span>
    uwind<span class="token operator">=</span>uwind0<span class="token punctuation">;</span>
    vwind<span class="token operator">=</span>vwind0<span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">%% create the merged netcdf file to store the result.</span>
filename <span class="token operator">=</span> <span class="token string">'wind10.nc'</span><span class="token punctuation">;</span> <span class="token comment">%合成的nc文件名称</span>

<span class="token comment">% cmode 选择，help netcdf.create</span>
<span class="token comment">%cid=netcdf.create(filename,'clobber'); </span>
cid<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'64BIT_OFFSET'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 64BIT_OFFSET</span>


<span class="token comment">%define global attributes</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'Conventions'</span><span class="token punctuation">,</span><span class="token string">'CF-1.6'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% help netcdf.putAtt</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'data_structure'</span><span class="token punctuation">,</span><span class="token string">'grid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lat_min'</span><span class="token punctuation">,</span><span class="token string">'-78.375 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lat_max'</span><span class="token punctuation">,</span><span class="token string">'78.375 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lon_min'</span><span class="token punctuation">,</span><span class="token string">'0.125 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'geospatial_lon_max'</span><span class="token punctuation">,</span><span class="token string">'359.875 degrees'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'institution'</span><span class="token punctuation">,</span><span class="token string">'Remote Sensing Systems (RSS)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% define the variable dimension</span>
dimlon<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defDim</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>longitude<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dimlat<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defDim</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>latitude<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dimtime<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defDim</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">,</span>filenumber<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%每天有4个时间结点</span>


<span class="token comment">% define the variable and their attributes</span>
varid1<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">,</span><span class="token string">'NC_DOUBLE'</span><span class="token punctuation">,</span>dimtime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% help netcdf.defVar</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'Time of analysis'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'hours since 1987-01-01 00:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'delta_t'</span><span class="token punctuation">,</span><span class="token string">'0000-00-00 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'calendar'</span><span class="token punctuation">,</span><span class="token string">'standard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'valid_min'</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'valid_max'</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span><span class="token string">'axis'</span><span class="token punctuation">,</span><span class="token string">'T'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%varid2=netcdf.defVar(cid,'latitude','NC_FLOAT',dimlat);</span>
varid2<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'NC_DOUBLE'</span><span class="token punctuation">,</span>dimlat<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% NC_DOUBLE 要求的内存，基本是 NC_FLOAT 的2倍</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'degrees_north'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'Latitude in degrees north'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'valid_min'</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>latitude<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'valid_max'</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>latitude<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span><span class="token string">'axis'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">%varid3=netcdf.defVar(cid,'longitude','NC_FLOAT',dimlon);</span>
varid3<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'NC_DOUBLE'</span><span class="token punctuation">,</span>dimlon<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'degrees_east'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'Longitude in degrees east'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'valid_min'</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>longitude<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'valid_max'</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>longitude<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span><span class="token string">'axis'</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">%varid4=netcdf.defVar(cid,'u10m','NC_FLOAT',[dimlon dimlat dimtime]);</span>
varid4<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'u10m'</span><span class="token punctuation">,</span><span class="token string">'NC_DOUBLE'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>dimlon dimlat dimtime<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'eastward_wind'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'u-wind vector component at 10 meters'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'m s-1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'_FillValue'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'coordinates'</span><span class="token punctuation">,</span><span class="token string">'time latitude longitude'</span><span class="token punctuation">)</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'valid_min'</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">uwind</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span><span class="token string">'valid_max'</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">uwind</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


varid5<span class="token operator">=</span>netcdf<span class="token punctuation">.</span><span class="token function">defVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span><span class="token string">'v10m'</span><span class="token punctuation">,</span><span class="token string">'NC_FLOAT'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>dimlon dimlat dimtime<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%varid5=netcdf.defVar(cid,'v10m','NC_DOUBLE',[dimlon dimlat dimtime]);</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'standard_name'</span><span class="token punctuation">,</span><span class="token string">'northward_wind'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'long_name'</span><span class="token punctuation">,</span><span class="token string">'v-wind vector component at 10 meters'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'units'</span><span class="token punctuation">,</span><span class="token string">'m s-1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'_FillValue'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'coordinates'</span><span class="token punctuation">,</span><span class="token string">'time latitude longitude'</span><span class="token punctuation">)</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'valid_min'</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">vwind</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span><span class="token string">'valid_max'</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">vwind</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% nobs 变量未加进去;</span>

netcdf<span class="token punctuation">.</span><span class="token function">endDef</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% end define the varible and attributes</span>


<span class="token comment">%% write variables value to merged netcdf file</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid1<span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid2<span class="token punctuation">,</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid3<span class="token punctuation">,</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid4<span class="token punctuation">,</span>uwind<span class="token punctuation">)</span><span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putVar</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>varid5<span class="token punctuation">,</span>vwind<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% 添加存储空间属性</span>
netcdf<span class="token punctuation">.</span><span class="token function">reDef</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%data mode 不能进行使用 putAtt，故进入 def mode；</span>
lst<span class="token operator">=</span><span class="token function">dir</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span> xi<span class="token operator">=</span>lst<span class="token punctuation">.</span>bytes<span class="token punctuation">;</span>
netcdf<span class="token punctuation">.</span><span class="token function">putAtt</span><span class="token punctuation">(</span>cid<span class="token punctuation">,</span>netcdf<span class="token punctuation">.</span><span class="token function">getConstant</span><span class="token punctuation">(</span><span class="token string">'NC_GLOBAL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'space size'</span><span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token function">num2str</span><span class="token punctuation">(</span>xi<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'Mb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%ncdisp(filename,'/','full');</span>

netcdf<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>问题：内存占比太高！</strong></p>
<p>单独的10个文件，占用空间大约270Mb，而此程序生成的文件是550多Mb，多了接近一倍。</p>
<p>问题出在了 <code>double</code>类型（<code>NC_DOUBLE</code>）上，原文件是<code>single</code>（<code>NC_FLOAT</code>），而使用<code>single</code>，会在<code>netcdf.endDef(cid)</code>提示error：</p>
<pre class="line-numbers language-none"><code class="language-none">错误使用 netcdflib
NetCDF 库在执行 'endDef' 函数期间遇到错误 - 'Not a valid data type or _FillValue type mismatch (NC_EBADTYPE)'。

出错 netcdf.endDef (line 33)
     netcdflib('endDef', ncid);

出错 Copy_2_of_merge_ccmp (line 133)
netcdf.endDef(cid);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>怎么解决？</strong></p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210163936.png"></p>
<p>减轻内存负担的方法：选择区域存储信息~~</p>
<p><strong>待了解实现</strong>：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220215161332.png"></p>
</blockquote>
<h2 id="—————————————"><a href="#—————————————" class="headerlink" title="—————————————"></a>—————————————</h2><h2 id="参考资料-3"><a href="#参考资料-3" class="headerlink" title="参考资料"></a>参考资料</h2><p>官网：<a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/">https://www.ndbc.noaa.gov/</a></p>
<blockquote>
<p>NDBC，National Data Buoy Center，需要到火狐浏览器打开；</p>
</blockquote>
<p>官网历史数据下载：<a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/historical_data.shtml">https://www.ndbc.noaa.gov/historical_data.shtml</a></p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220211125419.png"></p>
<p>选择所需下载数据类型，打开浮标年份，下载当年的gzip文件即可；</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#cwind">https://www.ndbc.noaa.gov/measdes.shtml#cwind</a></p>
<blockquote>
<p>Measurement Descriptions and Units：包含实时和历史数据文件中各变量的描述</p>
</blockquote>
<h2 id="Measurement-Descriptions-and-Units（released-in-20220211）：包含实时和历史数据文件中各变量的描述"><a href="#Measurement-Descriptions-and-Units（released-in-20220211）：包含实时和历史数据文件中各变量的描述" class="headerlink" title="Measurement Descriptions and Units（released in 20220211）：包含实时和历史数据文件中各变量的描述"></a>Measurement Descriptions and Units（released in 20220211）：包含实时和历史数据文件中各变量的描述</h2><h3 id="Real-Time-files-amp-Historical-files"><a href="#Real-Time-files-amp-Historical-files" class="headerlink" title="Real Time files &amp; Historical files"></a>Real Time files &amp; Historical files</h3><p><strong>Real Time files</strong> generally contain the last 45 days of “Realtime” data - data that went through automated quality checks and were distributed  as soon as they were received.  <strong>Historical files</strong> have gone through  post-processing analysis and represent the data sent to the archive  centers.  </p>
<p>The formats for both are generally the same, with the major  difference being the treatment of <strong>missing data</strong>.  Missing data in the  Realtime files are denoted by “MM” while a variable number of 9’s are  used to denote missing data in the Historical files, depending on the  data type (for example: 999.0  99.0).</p>
<h3 id="General"><a href="#General" class="headerlink" title="General"></a>General</h3><p><strong>Units</strong>: Station pages display the current hour’s measurements in <strong>English units</strong> by default,  but can be changed by the viewer to metric units.  When accessing Real Time and Historical data  files, the <strong>measurements are generally in metric units</strong>, as described below, and cannot be changed.</p>
<blockquote>
<p>英制单位（English units）和米制单位（metric units）的不同参考连接：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/77853579">https://zhuanlan.zhihu.com/p/77853579</a></p>
</blockquote>
<p><strong>Time</strong>: Station pages show current observations in station <strong>local time</strong> by default, but can be changed by the viewer to UTC (formerly  GMT). <strong>Both Realtime and Historical files show times in UTC only</strong>. See the Acquisition Time <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/acq.shtml">help topic: Do NDBC’s meteorological and oceanographic sensors measure data for the entire hour?</a> for a more detailed description of observation times. For more information on the times in the files, see the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/mods.shtml">changes page: Important NDBC Web Site Changes</a>.</p>
<blockquote>
<p>UTC和GMT什么关系？：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/27052407#:~:text=UTC%EF%BC%88Coordinated%20Universal%20Time%E5%8D%8F%E8%B0%83,%E4%B8%A4%E4%B8%AA%E6%98%AF%E7%9B%B8%E7%AD%89%E7%9A%84%E3%80%82">https://www.zhihu.com/question/27052407#:~:text=UTC%EF%BC%88Coordinated%20Universal%20Time%E5%8D%8F%E8%B0%83,%E4%B8%A4%E4%B8%AA%E6%98%AF%E7%9B%B8%E7%AD%89%E7%9A%84%E3%80%82</a></p>
<ul>
<li>GMT = UTC+0</li>
<li>UTC+8 是北京时间；</li>
</ul>
</blockquote>
<p><strong>Station ID</strong>: Five-digit WMO <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/staid.shtml">Station Identifier: How are the station ID numbers created?</a>, used since 1976.  ID’s can be reassigned to future deployments within the same 1 degree square.</p>
<p><strong>Formats</strong>: Data are classified according to the following  groups.  The <strong>header</strong> lines are shown at the beginning of group.  Note  that in the Realtime files, non-data lines begin with “#”.  Such lines  should be treated as comment lines.</p>
<h4 id="help-topic-Do-NDBC’s-meteorological-and-oceanographic-sensors-measure-data-for-the-entire-hour"><a href="#help-topic-Do-NDBC’s-meteorological-and-oceanographic-sensors-measure-data-for-the-entire-hour" class="headerlink" title="help topic: Do NDBC’s meteorological and oceanographic sensors measure data for the entire hour?"></a>help topic: Do NDBC’s meteorological and oceanographic sensors measure data for the entire hour?</h4><blockquote>
<p> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/acq.shtml">help topic: Do NDBC’s meteorological and oceanographic sensors measure data for the entire hour?</a> </p>
</blockquote>
<p>Sensors that are installed on board moored buoys and at C-MAN sites generally do not measure and record data for the entire hour.  Continuously recording data drastically increases power consumption.  Therefore, for most NDBC-measured environmental data, with spectral <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wave.shtml">wave</a> measurements and <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/cwind.shtml">continuous winds</a> being exceptions, an eight-minute period is used for data collected by sensors on board moored buoys and a two-minute acquisition period is used for data collected by sensors at C-MAN sites.</p>
<p>Starting in July 2004, the end-of-acquisition time is reported as the official observation time, to the hour and minute resolution. Before  July 2004, the observation time is simply the rounded hour nearest to  the acquisition period, not displaying minutes.  July’s change makes the observation times more consistent with the data provided to the archive centers.  Starting in August 1993, the end-of-acquisition time is  reported as the official observation time for data provided to the  national archive centers. Before August 1993, the observation time is  the rounded hour nearest to the acquisition period.</p>
<p>Note:  Wave data normally have acquisition periods that do not  overlap meteorological data acquisition.  Currently, wave data times are rounded to the nearest hour for 40 minute acquisition systems or  nearest half hour for 20 minute acquisition systems.  Reporting the  actual end-of-acquisition time for wave data is under consideration.   However, on some pages, wave information is displayed on the same lines  as meteorological data, and will always appear to have the  meteorological data time for those displays.</p>
<p>For ocean current measurements, Acoustic Doppler Current Profiler  (ADCP) times are rounded to the nearest hour.  For oceanographic data  measurements, times are rounded to the nearest hour. Reporting the  actual end-of-acquisition times for these data will be taken under  consideration.</p>
<p>For <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/cwind.shtml">Continuous Wind</a> stations, the end-of-acquisition time is given in the record. For other stations, the actual acquisition period may be determined by knowing the station type and payload.  The end-of- acquisition minute is reported for DACT and VEEP payloads, and is minute 50 for those payloads installed on moored buoys.  This means that 1200 UTC data was recorded from 1142-1150 UTC.  The start of acquisition is reported for all GSBP payloads, and is minute 40 for GSBP’s installed on moored buoys.  This means that 1200 UTC data was recorded from 1140-1148 UTC.  The end-of- acquisition minute for C-MAN sites is the top of the hour.  Prior to January 1992, the end-of-acquisition time was minute 25 for Gulf of Mexico C-MAN stations. During the period from September 1993 to August 1994, the end-of-acquisition times on West Coast C-MAN sites were changed from minute 25 to the top of the hour.</p>
<p>However, some stations do not follow the above timing convention and have <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/nsacq.shtml">non-standard acquisition times</a>.</p>
<p><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/waves.shtml">Wave acquisition times</a> are also listed on this WWW server.</p>
<h4 id="changes-page-Important-NDBC-Web-Site-Changes"><a href="#changes-page-Important-NDBC-Web-Site-Changes" class="headerlink" title="changes page: Important NDBC Web Site Changes"></a>changes page: Important NDBC Web Site Changes</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/mods.shtml">changes page: Important NDBC Web Site Changes</a></p>
</blockquote>
<p>NDBC is making several format changes to the headers of its web data  files. Note! These changes apply to the data files, not the station  page’s current observations listing! Click the Customer Survey link at  the bottom of this page to give feedback on the changes.</p>
<p><strong>Description</strong></p>
<ol>
<li><strong>A “#” sign starts header or other metadata lines (April 10th, 2007).</strong></li>
</ol>
<p>This will facilitate having a second header line for units of  measurement (see below) and other lines interspersed in the data for  significant changes in metadata, such as a station position change.</p>
<ol start="2">
<li><strong>Column headings were standardized (April 10th, 2007).</strong></li>
</ol>
<p>Some columns for the same measurement had different headings,  depending on which data group they were in.  For example, the column  heading for air pressure was PRES in one list and BARO in another.  PRES will be the standard for air pressure, APD will be the standard for  Average Wave Period, WVHT will be the standard for Significant Wave  Height, GST will be the standard for wind Gust speed.</p>
<ol start="3">
<li><strong>A second header line was added to specify units of measurement (April 10th, 2007).</strong></li>
</ol>
<p>The 5-day and 45-day realtime data files will be modified to include a second header line that specifies the unit of measure for each column.  Generally, the units in the data files are different than the units on  the station pages, which has caused misinterpretation. <strong>Note! The units are not changing - we are just adding information about the units.</strong> Raw spectral wave data files will not have the second header, as these raw data are unitless. See <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml">Measurement Descriptions and Units</a> for more information on the units of measure used on the NDBC web site.</p>
<p>NOTE! This year’s monthly historical files will use the new format, beginning with the 2007 January files. <strong>Prior year historical files will remain in the old format!</strong></p>
<p>Example of standard met data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS PTDY  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi  hPa    ft
2007 04 15 13 50 120  4.0  6.0   0.4     3    MM  MM 1023.4  20.6  22.5  10.8   MM +1.7    MM
2007 04 15 12 50 140  4.0  5.0   0.4     4    MM  MM 1023.0  20.4  22.4  10.3   MM +1.7    MM
2007 04 15 11 50 120  5.0  6.0   0.4     3    MM  MM 1022.1  20.0  22.4  10.9   MM +0.6    MM<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of continuous wind data format file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WDIR WSPD GDR GST GTIME
#yr  mo dy hr mn degT m/s degT m/s hhmm
2007 03 05 06 20 314  8.0 320 10.0 0604
2007 03 05 06 10 315  7.8 999 99.0 9999
2007 03 05 06 00 314  7.8 999 99.0 9999<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of wave summary data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WVHT  SwH  SwP  WWH  WWP SwD WWD  STEEPNESS  APD MWD
#yr  mo dy hr mn    m    m  sec    m  sec  -  degT     -      sec degT
2007 03 05 05 32  1.5  0.5 11.0  1.5  9.0   W  MM    AVERAGE   MM -99
2007 03 05 05 02  1.5  1.0 11.0  1.5  9.0 WNW  MM    AVERAGE   MM -99<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of raw wave spectra data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm Sep_Freq  &lt; spec_1 (freq_1) spec_2 (freq_2) spec_3 (freq_3) ... &gt;
2007 03 05 06 30 0.143 0.000 (0.033) 0.000 (0.037) 0.000 (0.043) 0.000 (0.048) 0.000 (0.053) 0.000 (0.058) 0.000 (0.062) 0.000 (0.068) 0.000 (0.073) 0.000 (0.077) 0.000 (0.083) 0.000 (0.087) 0.000 (0.092) 0.000 (0.100) 0.000 (0.110) 0.199 (0.120) 0.176 (0.130) 0.796 (0.140) 0.550 (0.150) 0.374 (0.160) 0.702 (0.170) 0.842 (0.180) 0.527 (0.190) 0.562 (0.200) 0.725 (0.210) 0.702 (0.220) 0.761 (0.230) 0.667 (0.240) 1.170 (0.250) 0.538 (0.260) 0.679 (0.270) 0.351 (0.280) 0.421 (0.290) 0.339 (0.300) 0.304 (0.310) 0.117 (0.320) 0.152 (0.330) 0.140 (0.340) 0.105 (0.350) 0.070 (0.365) 0.105 (0.385) 0.035 (0.405) 0.047 (0.425) 0.012 (0.445) 0.012 (0.465) 0.000 (0.485) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Example of raw spectral wave (alpha1) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm alpha1_1 (freq_1) alpha1_2 (freq_2) alpha1_3 (freq_3) ... &gt;
2007 03 05 06 30 999.0 (0.033) 999.0 (0.037) 999.0 (0.043) 999.0 (0.048) 999.0 (0.053) 999.0 (0.058) 999.0 (0.062) 999.0 (0.068) 999.0 (0.073) 999.0 (0.077) 999.0 (0.083) 999.0 (0.087) 999.0 (0.092) 296.0 (0.100) 144.0 (0.110) 204.0 (0.120) 188.0 (0.130) 192.0 (0.140) 196.0 (0.150) 200.0 (0.160) 216.0 (0.170) 216.0 (0.180) 232.0 (0.190) 264.0 (0.200) 320.0 (0.210) 328.0 (0.220) 320.0 (0.230) 324.0 (0.240) 316.0 (0.250) 316.0 (0.260) 324.0 (0.270) 320.0 (0.280) 312.0 (0.290) 324.0 (0.300) 324.0 (0.310) 312.0 (0.320) 328.0 (0.330) 312.0 (0.340) 336.0 (0.350) 332.0 (0.365) 312.0 (0.385) 340.0 (0.405) 336.0 (0.425) 328.0 (0.445) 316.0 (0.465) 340.0 (0.485) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Example of raw spectral wave (alpha2) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm alpha2_1 (freq_1) alpha2_2 (freq_2) alpha2_3 (freq_3) ... &gt;
2007 03 05 06 30 999.0 (0.033) 999.0 (0.037) 999.0 (0.043) 999.0 (0.048) 999.0 (0.053) 999.0 (0.058) 999.0 (0.062) 999.0 (0.068) 999.0 (0.073) 999.0 (0.077) 999.0 (0.083) 999.0 (0.087) 999.0 (0.092) 208.0 (0.100) 144.0 (0.110) 180.0 (0.120) 184.0 (0.130) 176.0 (0.140) 196.0 (0.150) 200.0 (0.160) 216.0 (0.170) 212.0 (0.180) 196.0 (0.190) 276.0 (0.200) 328.0 (0.210) 336.0 (0.220) 328.0 (0.230) 328.0 (0.240) 312.0 (0.250) 320.0 (0.260) 324.0 (0.270) 316.0 (0.280) 320.0 (0.290) 324.0 (0.300) 320.0 (0.310) 312.0 (0.320) 328.0 (0.330) 308.0 (0.340) 340.0 (0.350) 336.0 (0.365) 304.0 (0.385) 4.0 (0.405) 8.0 (0.425) 316.0 (0.445) 300.0 (0.465) 348.0 (0.485) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Example of raw spectral wave (r1) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm r1_1 (freq_1) r1_2 (freq_2) r1_3 (freq_3) ... &gt;
2007 03 05 06 30 999.00 (0.033) 999.00 (0.037) 999.00 (0.043) 999.00 (0.048) 999.00 (0.053) 999.00 (0.058) 999.00 (0.062) 999.00 (0.068) 999.00 (0.073) 999.00 (0.077) 999.00 (0.083) 999.00 (0.087) 999.00 (0.092) 0.30 (0.100) 0.33 (0.110) 0.56 (0.120) 0.81 (0.130) 0.72 (0.140) 0.87 (0.150) 0.94 (0.160) 0.91 (0.170) 0.81 (0.180) 0.59 (0.190) 0.63 (0.200) 0.81 (0.210) 0.81 (0.220) 0.84 (0.230) 0.89 (0.240) 0.86 (0.250) 0.76 (0.260) 0.91 (0.270) 0.80 (0.280) 0.78 (0.290) 0.91 (0.300) 0.70 (0.310) 0.91 (0.320) 0.77 (0.330) 0.76 (0.340) 0.78 (0.350) 0.84 (0.365) 0.80 (0.385) 0.64 (0.405) 0.64 (0.425) 0.68 (0.445) 0.67 (0.465) 0.74 (0.485) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Example of raw spectral wave (r2) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm r2_1 (freq_1) r2_2 (freq_2) r2_3 (freq_3) ... &gt; 
2007 03 05 06 30 999.00 (0.033) 999.00 (0.037) 999.00 (0.043) 999.00 (0.048) 999.00 (0.053) 999.00 (0.058) 999.00 (0.062) 999.00 (0.068) 999.00 (0.073) 999.00 (0.077) 999.00 (0.083) 999.00 (0.087) 999.00 (0.092) 0.11 (0.100) 0.41 (0.110) 0.42 (0.120) 0.67 (0.130) 0.45 (0.140) 0.69 (0.150) 0.84 (0.160) 0.76 (0.170) 0.69 (0.180) 0.34 (0.190) 0.20 (0.200) 0.62 (0.210) 0.60 (0.220) 0.58 (0.230) 0.72 (0.240) 0.56 (0.250) 0.38 (0.260) 0.73 (0.270) 0.42 (0.280) 0.40 (0.290) 0.76 (0.300) 0.20 (0.310) 0.73 (0.320) 0.38 (0.330) 0.34 (0.340) 0.39 (0.350) 0.59 (0.365) 0.45 (0.385) 0.32 (0.405) 0.20 (0.425) 0.16 (0.445) 0.08 (0.465) 0.42 (0.485) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Example of oceanographic data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm DEPTH  OTMP   COND   SAL   O2% O2PPM  CLCON  TURB    PH    EH
#yr  mo dy hr mn     m  degC  mS/cm   psu     %   ppm   ug/l   FTU     -    mv
2007 04 27 11 00     2 25.13  55.18 36.45  33.1  2.21   0.06    MM  0.00 98.28
2007 04 27 10 00     2 25.15  55.27 36.45  33.3  2.22   0.06    MM  0.00 95.93
2007 04 27 09 00     2 25.15  55.37 36.45  33.3  2.21   0.06    MM  0.00 94.80<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of solar radiation data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm  SRAD1  SWRAD  LWRAD
#yr  mo dy hr mn   w/m2   w/m2   w/m2
2007 03 05 06 30    0.0     MM     MM
2007 03 05 06 00    0.0     MM     MM<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of DART data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm ss T   HEIGHT
#yr  mo dy hr mn  s -        m 
2007 03 05 06 00 00 1 5842.604
2007 03 05 05 45 00 1 5842.586
2007 03 05 05 30 00 1 5842.566<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of ocean current (adcp) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm DEP01 DIR01 SPD01 DEP02 DIR02 SPD02 DEP03 DIR03 SPD03 DEP04 DIR04 SPD04 DEP05 DIR05 SPD05 DEP06 DIR06 SPD06 DEP07 DIR07 SPD07 DEP08 DIR08 SPD08 DEP09 DIR09 SPD09 DEP10 DIR10 SPD10 DEP11 DIR11 SPD11 DEP12 DIR12 SPD12 DEP13 DIR13 SPD13 DEP14 DIR14 SPD14 DEP15 DIR15 SPD15 DEP16 DIR16 SPD16 DEP17 DIR17 SPD17 DEP18 DIR18 SPD18 DEP19 DIR19 SPD19 DEP20 DIR20 SPD20
#yr  mo dy hr mn     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s
2007 03 05 06 30     2   150     7     3   160     7     5   180     6     7   180     7     9   190     7    11   200     8    13   210     8    15   210     8    17   210     9    19   210     9    21   210     9    23   220     9    25   230     8    27   180     2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Example of expanded ocean current (adcp2) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm I Bin   Depth Dir Speed ErrVl VerVl %Good3 %Good4 %GoodE   EI1   EI2   EI3   EI4   CM1   CM2   CM3   CM4 Flags
#yr  mo dy hr mn -   -     m  degT  cm/s  cm/s  cm/s      %      %      %     -     -     -     -     -     -     -     - -
2007 03 05 06 20 0   1    51.0  97  12.6  -0.5  -3.5     99     99     99   224   220   216   227     0     0     0     0 133313330<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Example of hourly rain data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm  ACCUM
#yr  mo dy hr mn    mm
2007 03 05 04 30   0.0 
2007 03 05 03 30   0.0 
2007 03 05 02 30   0.0 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of 10 minute rain (rain10) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm   RATE
#yr  mo dy hr mn   mm/h
2007 03 05 05 30   0.0 
2007 03 05 05 20   0.0 
2007 03 05 05 10   0.0 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of 24 hour rain (rain24) data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm   RATE  PCT  SDEV
#yr  mo dy hr mn   mm/h   %     -
2007 03 04 12 00   0.0   0.0   0.0 
2007 03 03 12 00   0.0   0.0   0.0 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of derived meteorological data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm CHILL  HEAT   ICE WSPD10 WSPD20
#yr  mo dy hr mn  degC  degC in/hr    m/s    m/s
2007 03 05 20 50    MM    MM    MM      8      8
2007 03 05 19 50    MM    MM    MM      9      9
2007 03 05 18 50    MM    MM    MM      8      9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of PIRATA and drifter data files/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hhmm     LAT      LON WDIR WSPD GST   PRES PTDY ATMP WTMP
#yr  mo dy hrmn     deg      deg degT m/s  m/s    hPa  hPa degC degC
2007 03 06 1700   11.50   -38.01 040  9.3   MM     MM   MM 25.0 25.1
2007 03 06 1600   11.50   -38.02 040  9.3   MM     MM   MM 24.9 25.1
2007 03 06 1400   11.50   -38.03 050  8.8   MM     MM   MM 25.0 25.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of supplemental data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm   PRES PTIME  WSPD  WDIR WTIME
#yr  mo dy hr mn    hPa  hhmm   m/s  degT  hhmm
2007 03 06 12 00     MM    MM  10.0    44  1145
2007 03 06 11 00     MM    MM  10.0    33  1037
2007 03 06 10 00     MM    MM  10.5    40  0945<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Example of ship obs data file/list</p>
<pre class="line-numbers language-none"><code class="language-none">#SHIP_ID  YY  MM DD hh   LAT    LON WDIR WSPD GST  WVHT   DPD   APD MWD  PRES   ATMP  WTMP  DEWP  VIS  PTDY  TCC S1HT S1PD S1DIR S2HT S2PD S2DIR II IE IR IC IS Ib ID Iz
#station  yr  mo dy hr   deg    deg degT m/s  m/s     m   sec   sec degT  hPa   degC  degC  degC   mi   hPa  8th    m  sec  degT    m  sec  degT  -  -  -  -  -  -  -  -
SHIP     2007 03 05 21  71.6   22.5 190 15.0   MM   2.1     5    MM  MM 1017.9  -0.5    MM  -6.9   MM  -1.2   MM   MM   MM    MM   MM   MM    MM MM MM MM MM MM MM MM MM
46633    2007 03 05 21  44.3 -131.3  MM   MM   MM    MM    MM    MM  MM 1010.5    MM   9.8    MM   MM  -1.1   MM   MM   MM    MM   MM   MM    MM MM MM MM MM MM MM MM MM<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Feedback</strong> - Please take this <a target="_blank" rel="noopener" href="http://weather.gov/survey/nws-survey.php?code=ndbcdffc">Customer Survey</a> to let us know what you think of these changes.</p>
<h4 id="Station-Identifier-How-are-the-station-ID-numbers-created"><a href="#Station-Identifier-How-are-the-station-ID-numbers-created" class="headerlink" title="Station Identifier: How are the station ID numbers created?"></a>Station Identifier: How are the station ID numbers created?</h4><blockquote>
<p> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/staid.shtml">Station Identifier: How are the station ID numbers created?</a></p>
</blockquote>
<p>The World Meteorological Organization (WMO) assigns a 5-character alpha-numeric station  identifier to all weather observation stations, including moored buoys, drifting buoys, and C-Man. Generally, these IDs are location specific, except for drifting buoys which retain their identifier  assigned by deployment location.  Before 1977, however, the moored buoy IDs were of the following form: EB-## (e.g., EB-4, EB-12), which bore no relation to its location.  In the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php">data inventory summary: Data Availability Summary for NDBC Platforms</a>, EB IDs are listed under the appropriate station ID, if applicable.</p>
<p>The WMO station identification system is very simple.  Identifiers are in the form of “&amp;&amp;###” where “&amp;&amp;” represents a WMO oceanic or continental region and ### denotes a specific location (e.g., 46042, 41003).  With respect to regions, 32 denotes stations in the Pacific off the coast of South America, 41 – the Atlantic off of the southeast U.S. coast,  44 – the Atlantic Ocean north of North Carolina, 42 – the Gulf of Mexico, 45 – the Great Lakes, 46 – the U.S. coastal Pacific Ocean, 51 – the Hawaiian Islands, 52 – Guam.</p>
<p>Station identifiers for C-MAN sites in the U.S. are determined through a national system.  It is alphanumeric with the format: AAAS#.  “S#” is the first alphabetic letter for the state where the C-MAN site is located followed by the number of its location in alphabetized order of that state in ascending sequence (L1 – Louisiana, N6 – New York, N7 – North Carolina). “AAA” is composed of alphabetic letters and is an abbreviation of the location.  As an example, Grand Isle, LA is represented by GDIL1, Lake Worth, FL – LKWF1, and Tatoosh Island, WA – TTIW1.</p>
<p>C-MAN stations that are a part of the former WESTPAC-AMOS program are identified using the WMO system, since WESTPAC data were transmitted internationally. WESTPAC stations were identified by 91###, where ### is the number assigned to the specific location.</p>
<h4 id="data-inventory-summary-Data-Availability-Summary-for-NDBC-Platforms"><a href="#data-inventory-summary-Data-Availability-Summary-for-NDBC-Platforms" class="headerlink" title="data inventory summary: Data Availability Summary for NDBC Platforms"></a>data inventory summary: Data Availability Summary for NDBC Platforms</h4><blockquote>
<p> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php">data inventory summary: Data Availability Summary for NDBC Platforms</a></p>
</blockquote>
<p>Below is a list of NDBC buoy and C-MAN stations. Click on the link     for a station to see a summary of the types of data available for    that  station.</p>
<p><strong>ATLANTIC</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb01"> EB01  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb91"> EB91 (EB52)  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41001"> 41001 - EAST HATTERAS - 150 NM East of Cape Hatteras </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41002"> 41002 - SOUTH HATTERAS - 225 NM South of Cape Hatteras </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41003"> 41003  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41004"> 41004 - EDISTO - 41 NM Southeast of Charleston, SC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41005"> 41005  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41006"> 41006  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41007"> 41007  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41008"> 41008 - GRAYS REEF - 40 NM Southeast of Savannah, GA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41009"> 41009 - CANAVERAL 20 NM East of Cape Canaveral, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41010"> 41010 - CANAVERAL EAST - 120NM East of Cape Canaveral </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41011"> 41011  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41012"> 41012 - St. Augustine, FL 40NM ENE of St Augustine, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41015"> 41015  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41016"> 41016  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41017"> 41017  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41018"> 41018  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41021"> 41021 - Olympic Northeast </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41022"> 41022 - Olympic Southwest </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41023"> 41023 - Olympic Southwest </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=41025"> 41025 - Diamond Shoals, NC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44001"> 44001  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44003"> 44003  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44004"> 44004 - HOTEL 200NM East of Cape May,NJ </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44005"> 44005 - GULF OF MAINE - 78 NM East of Portsmouth, NH </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44006"> 44006  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44007"> 44007 - PORTLAND - 12 NM Southeast of Portland,ME </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44008"> 44008 - NANTUCKET 54 NM Southeast of Nantucket </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44009"> 44009 - DELAWARE BAY 26 NM Southeast of Cape May, NJ </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44010"> 44010  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44011"> 44011 - GEORGES BANK 170 NM East of Hyannis, MA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44012"> 44012  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44013"> 44013 - BOSTON 16 NM East of Boston, MA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44014"> 44014 - VIRGINIA BEACH 64 NM East of Virginia Beach, VA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44015"> 44015  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44017"> 44017 - MONTAUK POINT - 23 NM SSW of Montauk Point, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44018"> 44018 - CAPE COD - 9 NM North of Provincetown, MA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44019"> 44019  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44023"> 44023  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44025"> 44025 - LONG ISLAND - 30 NM South of Islip, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44026"> 44026  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=44028"> 44028 - Buzzard’s Bay </a></li>
</ul>
<p><strong>GREAT LAKES</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45001"> 45001 - MID SUPERIOR- 60 NM North Northeast Hancock, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45002"> 45002 - NORTH MICHIGAN- Halfway between North Manitou and Washington Islands. </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45003"> 45003 - NORTH HURON - 32NM Northeast of Alpena, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45004"> 45004 - EAST SUPERIOR -70 NM NE Marquette, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45005"> 45005 - WEST ERIE - 16 NM NW of Lorain, OH </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45006"> 45006 - WEST SUPERIOR - 30NM NE of Outer Island, WI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45007"> 45007 - SOUTH MICHIGAN - 43NM East Southeast of Milwaukee, WI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45008"> 45008 - SOUTH HURON - 43NM East of Oscoda, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45009"> 45009  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45010"> 45010  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=45012"> 45012 - EAST Lake Ontario  - 20NM North Northeast of Rochester, NY </a></li>
</ul>
<p><strong>GULF OF MEXICO</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb10"> EB10  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb31"> EB31  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb32"> EB32  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb36"> EB36  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb52"> EB52  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb53"> EB53  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb61"> EB61  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb62"> EB62  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb92"> EB92 (EB61)  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42001"> 42001 - MID GULF - 180 nm South of Southwest Pass, LA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42002"> 42002 - WEST GULF - 207 NM East of Brownsville, TX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42003"> 42003 - East GULF - 208 NM West of Naples, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42004"> 42004  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42005"> 42005  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42006"> 42006  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42007"> 42007 - BILOXI - 22 NM SSE of Biloxi, MS </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42008"> 42008  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42009"> 42009  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42010"> 42010  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42011"> 42011  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42012"> 42012 - ORANGE BEACH - 44 NM SE of Mobile, AL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42015"> 42015  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42016"> 42016  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42017"> 42017  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42018"> 42018  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42019"> 42019 - FREEPORT, TX - 60 NM South of Freeport, TX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42020"> 42020 - CORPUS CHRISTI, TX - 60NM SSE of Corpus Christi, TX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42025"> 42025  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42035"> 42035 - GALVESTON,TX -  22 NM East of Galveston, TX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42036"> 42036 - WEST TAMPA  - 112 NM WNW of Tampa, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42037"> 42037  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42039"> 42039 - PENSACOLA - 115NM SSE of Pensacola, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42040"> 42040 - LUKE OFFSHORE TEST PLATFORM - 63 NM South of Dauphin Island, AL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42041"> 42041 - North Mid Gulf 110NM South of Grand Isle, LA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42042"> 42042 - Pascagoula </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=42054"> 42054 - East Gulf </a></li>
</ul>
<p><strong>NORTH PACIFIC AND GULF OF ALASKA</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb33"> EB33  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb35"> EB35  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb43"> EB43  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb70"> EB70  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=eb90"> EB90 (EB02)  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46001"> 46001 - WESTERN GULF OF ALASKA  - 175NM SE of Kodiak, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46002"> 46002 - WEST OREGON - 275NM West of Coos Bay, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46003"> 46003 - S ALEUTIANS </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46004"> 46004 - Middle Nomad </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46005"> 46005 - WEST WASHINGTON - 300NM West of Aberdeen, WA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46006"> 46006 - SOUTHEAST PAPA - 600NM West of Eureka, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46007"> 46007  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46008"> 46008  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46009"> 46009  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46010"> 46010  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46011"> 46011 - SANTA MARIA - 21NM NW of Point Arguello, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46012"> 46012 - HALF MOON BAY - 24NM SSW of San Francisco, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46013"> 46013 - BODEGA BAY - 48NM NW of San Francisco, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46014"> 46014 - PT ARENA - 19NM North of Point Arena, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46015"> 46015 - PORT ORFORD - 15 NM West of Port Orford, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46016"> 46016  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46017"> 46017  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46018"> 46018  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46019"> 46019  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46020"> 46020  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46021"> 46021  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46022"> 46022 - EEL RIVER - 17NM WSW of Eureka, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46023"> 46023 - PT ARGUELLO - 17NM WNW of Point Arguello, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46024"> 46024  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46025"> 46025 - Santa Monica Basin - 33NM WSW of Santa Monica, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46026"> 46026 - SAN FRANCISCO - 18NM West of San Francisco, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46027"> 46027 - ST GEORGES - 8 NM NW of Crescent City, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46028"> 46028 - CAPE SAN MARTIN - 55NM West NW of Morro Bay, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46029"> 46029 - COLUMBIA RIVER BAR - 20NM West of Columbia River Mouth </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46030"> 46030 - BLUNTS REEF </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46031"> 46031  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46032"> 46032  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46033"> 46033  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46034"> 46034  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46035"> 46035 - CENTRAL BERING SEA - 310 NM North of Adak, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46036"> 46036 - South Nomad </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46037"> 46037  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46038"> 46038  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46039"> 46039  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46040"> 46040  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46041"> 46041 - CAPE ELIZABETH - 45NM NW of Aberdeen, WA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46042"> 46042 - MONTEREY - 27NM WNW of Monterey, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46043"> 46043  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46045"> 46045 - REDONDO BEACH </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46047"> 46047 - TANNER BANK - 121 NM West of San Diego, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46048"> 46048  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46050"> 46050 - STONEWALL BANK - 20NM West of Newport, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46051"> 46051 - Harvest Experiment Platform </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46053"> 46053 - EAST SANTA BARBARA  - 12NM Southwest of Santa Barbara, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46054"> 46054 - WEST SANTA BARBARA  38 NM West of Santa Barbara, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46059"> 46059 - WEST CALIFORNIA - 357NM West of San Francisco, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46060"> 46060 - WEST ORCA BAY - 8NM NW of Hinchinbrook Is., AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46061"> 46061 - Seal Rocks - Between Montague and Hinchinbrook Islands, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46062"> 46062 - Pt. San Luis, CA - 18 NM South Southwest of Morro Bay, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46063"> 46063 - Pt.Conception, CA - 50NM West of Santa Barbara, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46066"> 46066 - SOUTH KODIAK - 310NM SSW of Kodiak, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46072"> 46072 - CENTRAL ALEUTIANS 230 NM SW Dutch Harbor </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46079"> 46079 - Barren Island </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46080"> 46080 - PORTLOCK BANK- 76 NM ENE of Kodiak, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46082"> 46082 - Cape Suckling - 35 NM SE of Kayak Is, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46083"> 46083 - FAIRWEATHER GROUND - 105 NM West  of Juneau, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=46084"> 46084 - CAPE EDGECUMBE - 25NM SSW of Cape Edgecumbe, AK </a></li>
</ul>
<p><strong>HAWAIIAN ISLANDS</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51001"> 51001 - NORTHWESTERN HAWAII ONE - 188 NM NW of Kauai Island, HI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51002"> 51002 - SOUTHWEST HAWAII - 215NM SSW of Hilo, HI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51003"> 51003 - WESTERN  HAWAII - 205 NM SW of Honolulu, HI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51004"> 51004 - SOUTHEAST HAWAII - 205 NM Southeast of Hilo, HI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51005"> 51005  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51026"> 51026 - Northern Molokai </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51027"> 51027  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=51028"> 51028 - Christmas Island </a></li>
</ul>
<p><strong>WESTERN PACIFIC</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=52009"> 52009  </a></li>
</ul>
<p><strong>SOUTH PACIFIC</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=32301"> 32301  </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=32302"> 32302  </a></li>
</ul>
<p><strong>COASTAL-MARINE AUTOMATED NETWORK (C-MAN)  C-MAN FIXED STATIONS</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=aban6"> ABAN6 - Alexandria Bay, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=alrf1"> ALRF1 - Alligator Reef </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=alsn6"> ALSN6 - Ambrose Light, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=auga2"> AUGA2 - Augustine Island, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=blia2"> BLIA2 - Bligh Reef Light, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=burl1"> BURL1 - Southwest Pass, LA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=busl1"> BUSL1 - Bullwinkle Block 65 </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=buzm3"> BUZM3 - Buzzards Bay, MA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=caro3"> CARO3 - Cape Arago, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=cdrf1"> CDRF1 - Cedar Key, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=chlv2"> CHLV2 - Chesapeake Light, VA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=clkn7"> CLKN7 - Cape Lookout, NC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=csbf1"> CSBF1 - Cape San Blas, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=dbln6"> DBLN6 - Dunkirk, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=desw1"> DESW1 - Destruction Island, WA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=disw3"> DISW3 - Devils Island, WI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=dpia1"> DPIA1 - Dauphin Island, AL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=drfa2"> DRFA2 - Drift River Terminal, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=dryf1"> DRYF1 - Dry Tortugas, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=dsln7"> DSLN7 - Diamond Shls Lt., NC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=ducn7"> DUCN7 - Duck Pier, NC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=fbis1"> FBIS1 - Folly Island, SC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=ffia2"> FFIA2 - Five Fingers, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=fpsn7"> FPSN7 - Frying Pan Shoals, NC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=fwyf1"> FWYF1 - Fowey Rock, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=gbcl1"> GBCL1 - Garden Banks </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=gdil1"> GDIL1 - Grand Isle, LA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=glln6"> GLLN6 - Galloo Island, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=iosn3"> IOSN3 - Isle of Shoals, NH </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=ktnf1"> KTNF1 - Keaton Beach, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=lkwf1"> LKWF1 - 8722670 - Lake Worth Pier, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=lnel1"> LNEL1 - Lena </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=lonf1"> LONF1 - Long Key, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=lscm4"> LSCM4 - Lake St. Clair Light, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=mdrm1"> MDRM1 - Mt. Desert Rock, ME </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=mism1"> MISM1 - Matinicus Rock, ME </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=mlrf1"> MLRF1 - Molasses Reef, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=mpcl1"> MPCL1 - Main Pass </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=mrka2"> MRKA2 - Middle Rock Light, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=nwpo3"> NWPO3 - Newport, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=pila2"> PILA2 - Pilot Rock, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=pilm4"> PILM4 - Passage Island, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=pota2"> POTA2 - Potato Point, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=ptac1"> PTAC1 - Point Arena, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=ptat2"> PTAT2 - Port Aransas, TX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=ptgc1"> PTGC1 - Point Arguello, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=roam4"> ROAM4 - Rock of Ages, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=sanf1"> SANF1 - Sand Key, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=sauf1"> SAUF1 - St. Augustine, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=sbio1"> SBIO1 - South Bass Island, OH </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=sgnw3"> SGNW3 - Sheboygan, WI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=sisw1"> SISW1 - Smith Island, WA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=sjlf1"> SJLF1 - St. John’s Light </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=smkf1"> SMKF1 - Sombrero Key, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=spgf1"> SPGF1 - Settlement Point, GBI, Bahamas </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=srst2"> SRST2 - Sabine Pass, TX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=stdm4"> STDM4 - Stannard Rock, MI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=supn6"> SUPN6 - Superior Shoals, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=svls1"> SVLS1 - Savannah Light, GA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=thin6"> THIN6 - Thousand I. Brdg., NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=tplm2"> TPLM2 - Thomas Point, MD </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=ttiw1"> TTIW1 - Tatoosh Island, WA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=venf1"> VENF1 - Venice, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=wpow1"> WPOW1 - West Point, WA </a></li>
</ul>
<p><strong>C-MAN WESTPAC STATIONS</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91204"> 91204 - Ulithi Is., Caroline </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91222"> 91222 - Pagan Is.,Mariana </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91251"> 91251 - Enewetak, MarShall </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91328"> 91328 - Ulul Atoll, Caroline </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91338"> 91338 - Satawan Atoll, Caro. </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91343"> 91343 - Oroluk, Caroline </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91352"> 91352 - Pingelap, Caroline </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91356"> 91356 - Kosrae, Caroline </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91365"> 91365 - Ujae Atoll, Marshall </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91374"> 91374 - Maloelap, Marshall </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91377"> 91377 - Mili, Marshalls Is. </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91411"> 91411 - Ngulu Atoll, Caroline </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=91442"> 91442 - Ebon Atoll, Caroline </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/data_availability/data_avail.php?station=farp2"> FARP2 - Faraulep, Carolines Island </a></li>
</ul>
<p><strong>Tsunameters</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21413"> 21413 - SOUTHEAST TOKYO - 700NM ESE of Tokyo, JP </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21414"> 21414 - AMCHITKA - 170 NM South of Amchitka, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21415"> 21415 - ATTU - 175 NM South of Attu, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21416"> 21416 - KAMCHATKA PENINSULA - 240NM SE of Kamchatka Peninsula, RU </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21417"> 21417 - 290NM SE of the Kuril Islands </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21418"> 21418 - NORTHEAST TOKYO - 450 NM NE of Tokyo, JP </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21419"> 21419 - KURIL ISLANDS - 209NM SE of Kuril Is. </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=21420"> 21420 - SOUTHEAST MIYAZAKI - 260NM Southeast of Miyazaki </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=32411"> 32411 - WEST PANAMA - 710 NM WSW of Panama City, Panama </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=32412"> 32412 - SOUTHWEST LIMA - 645 NM SW of Lima, Peru </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=32413"> 32413 - NORTHWEST LIMA - 1000 NM WNW of Lima, Peru </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=32d12"> 32D12 - SOUTHWEST LIMA 645NM SW of Lima, Peru </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=32d13"> 32D13 - ADRIFT BUOY FROM 32413 </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=41420"> 41420 - NORTH SANTO DOMINGO - 328NM NNE of Santo Domingo, DO </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=41421"> 41421 - NORTH ST THOMAS - 300 NM North of St Thomas, Virgin Is </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=41424"> 41424 - EAST CHARLESTON - 370 NM East of Charleston, SC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=41425"> 41425 - SOUTHWEST BERMUDA - 200 NM SSW of Hamilton, Bermuda </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=41x24"> 41X24 - 370 NM East of Charleston, SC </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=42407"> 42407 - SOUTH PUERTO RICO - 230 NM Southwest of San Juan, PR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=42408"> 42408 - EAST GULF of MEXICO - 225NM WNW of Loggerhead Key, FL </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=42409"> 42409 - GULF OF MEXICO - 247 NM South of New Orleans, LA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=42429"> 42429 - DART WAVE GLIDER STATION </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=43412"> 43412 - SOUTHWEST MANZANILLO - 240 NM SW of Manzanillo, MX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=43413"> 43413 - SOUTH ACAPULCO - 360NM South of Acapulco, MX </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=44401"> 44401 - NORTHEAST CASTLE ROCK SEAMOUNT - 620NM South of St John’s Newfoundland, CN </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=44402"> 44402 - SOUTHEAST BLOCK CANYON - 130 NM SE of Fire Island, NY </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=44403"> 44403 - SABLE ISLAND BANK - 437 NM E of Boston, MA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=44d03"> 44D03 - Adrift buoy from 44403 </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46401"> 46401 - SOUTHEAST ADAK - 377NM SE of Adak, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46402"> 46402 - South Dutch Harbor - 220 NM SSE of Dutch Harbor, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46403"> 46403 - SOUTHEAST SHUMAGIN ISLAND - 186 NM SE of Shumagin Is, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46404"> 46404 - WEST ASTORIA - 230 NM West of Astoria, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46405"> 46405 - 325 NM West-Southwest of Newport, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46406"> 46406 - 2,900 NM Southeast of Hawaii </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46407"> 46407 - NEWPORT - 210NM West of Coos Bay, OR </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46408"> 46408 - NIKOLSKI - 212 NM South of Umnak Is, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46409"> 46409 - SOUTHEAST KODIAK - 210 NM SE of Kodiak, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46410"> 46410 - SOUTH CORDOVA 188NM SSE of Cordova, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46411"> 46411 - Mendocino - 150 NM West of  Mendocino Bay, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46412"> 46412 - San Diego - 175 NM West of San Diego, CA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46413"> 46413 - SOUTH-SOUTHEAST ADAK - 243 NM SSE of Adak Island, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46414"> 46414 - SOUTHEAST CHIRIKOF - 165 NM SE of Chirikof Island, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46415"> 46415 - SOUTHWEST JUNEAU - 370 NM SW of Juneau, AK </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46416"> 46416 - WEST VANCOUVER - 442NM West of Vancouver, BC, Canada </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=46419"> 46419 - NORTHWEST SEATTLE - 300 NM WNW of Seattle, WA </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=51406"> 51406 - CENTRAL SOUTH PACIFIC  - 1040NM NNE of Pitcarin Is </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=51407"> 51407 - HAWAII - 34NM West of Kailua-Kona, HI </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=51425"> 51425 - NORTHWEST APIA - 370 NM NW of Apia, Samoa </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=51426"> 51426 - SOUTHEAST TONGA - 400NM SE of Tonga </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=51d26"> 51D26 - SOUTHEAST TONGA - 400NM SE of Tonga </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=52401"> 52401 - NORTHEAST SAIPAN - 610 NM ENE of Saipan </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=52402"> 52402 - SOUTHEAST SAIPAN - 540NM ESE of Saipan </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=52403"> 52403 - NORTH MANUS - 345NM North of Manus Is , New Guinea </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=52404"> 52404 - NORTH PHILIPPINE SEA - 750 NM NE of Manila, Philippines </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=52405"> 52405 - SOUTH PHILIPPINE SEA -725 NM West of Agana, Guam </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=52406"> 52406 - NORTHEAST SOLOMON - 370NM NE of Guadalcanal </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=54401"> 54401 - NORTHEAST NEW ZEALAND - 640NM NE of Auckland, NZ </a></li>
<li><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/station_history.php?station=54d01"> 54D01 - NORTHEAST NEW ZEALAND - 640NM NE of Auckland, NZ </a></li>
</ul>
<h4 id="Important-Notice-to-Mariners-NATIONAL-WEATHER-SERVICE-SEEKS-COOPERATION-TO-SAFEGUARD-CRITICAL-DATA-BUOYS"><a href="#Important-Notice-to-Mariners-NATIONAL-WEATHER-SERVICE-SEEKS-COOPERATION-TO-SAFEGUARD-CRITICAL-DATA-BUOYS" class="headerlink" title="Important Notice to Mariners: NATIONAL WEATHER SERVICE SEEKS COOPERATION TO SAFEGUARD CRITICAL DATA BUOYS"></a>Important Notice to Mariners: NATIONAL WEATHER SERVICE SEEKS COOPERATION TO SAFEGUARD CRITICAL DATA BUOYS</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/marine_notice.shtml">https://www.ndbc.noaa.gov/marine_notice.shtml</a></p>
</blockquote>
<p>The National Weather Service is soliciting the cooperation of the marine community to safeguard offshore automated weather buoys that provide critical information, including wind speed and direction, wave height, pressure changes, and other key data about marine conditions and developing storms along the coast. The data buoys are an integral part of the comprehensive observation system that allows local forecast offices to issue weather warnings and forecasts for the protection of life and property.</p>
<p>Specific steps that mariners can take to safeguard the systems include:</p>
<ul>
<li>neither boarding nor tying-up to a data buoy;</li>
<li>giving the buoy a wide berth to avoid entangling the buoy’s mooring or other equipment suspended from the buoy — 500 yards for vessels which are trailing gear, and at least 20 yards for all others;</li>
<li>reporting to the U.S. Coast Guard any damage you observe to a data buoy;</li>
<li>reporting to the U.S. Coast Guard any observation of people on or vessels attached to a weather buoy.</li>
</ul>
<p>The NDBC operates a network of offshore automated weather buoys and Coastal-Marine Automated Network stations that  provide hourly reports of marine weather to NWS and other agencies. The buoys, off the U.S. coasts and the Great Lakes, may be nearby or several hundred miles at sea. These stations provide hourly data to NWS forecast offices that are  important to the preparation of forecasts and warnings. These data are also broadcast to the public over NOAA Weather Radio, and are posted on the Internet at the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/">NDBC Website</a>.</p>
<p>NDBC buoys have either circular or boat-shaped hulls ranging from three meters to 10 meters across, with  superstructures extending five meters to 10 meters above the water. All are painted bright colors and imprinted with “NOAA” and the station number, show a yellow, group-flashing-4 (20 seconds) light characteristic, and are identified on applicable navigation charts by the five-digit station number, or as “ODAS.”</p>
<h3 id="Standard-Meteorological-Data"><a href="#Standard-Meteorological-Data" class="headerlink" title="Standard Meteorological Data"></a>Standard Meteorological Data</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS PTDY  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC  nmi  hPa    ft
2014 09 11 16 50 120  5.0  6.0   0.6     6   4.2 134 1016.5  29.3  30.5  24.4   MM +0.3    MM<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>WDIR</th>
<th>Wind direction (the direction the wind is coming from in degrees     clockwise from true N) during the same period used for WSPD. See      <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wndav.shtml">Wind Averaging Methods</a></th>
</tr>
</thead>
<tbody><tr>
<td>WSPD</td>
<td>Wind speed (m/s) averaged over an eight-minute period for buoys and     a two-minute period for land stations.  Reported Hourly.  See      <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wndav.shtml">Wind Averaging Methods</a>.</td>
</tr>
<tr>
<td>GST</td>
<td>Peak 5 or 8 second gust speed (m/s) measured during the eight-minute     or two-minute period.  The 5 or 8 second period can be determined by      payload, See the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/rsa.shtml">Sensor Reporting, Sampling, and         Accuracy</a> section.</td>
</tr>
<tr>
<td>WVHT</td>
<td>Significant wave height (meters) is calculated as the average of the     highest one-third of all of the wave heights during the 20-minute     sampling period.  See the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wave.shtml">Wave Measurements</a>     section.</td>
</tr>
<tr>
<td>DPD</td>
<td>Dominant wave period (seconds) is the period with the maximum wave     energy. See the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wave.shtml">Wave Measurements</a> section.</td>
</tr>
<tr>
<td>APD</td>
<td>Average wave period (seconds) of all waves during the 20-minute     period. See the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wave.shtml">Wave Measurements</a> section.</td>
</tr>
<tr>
<td>MWD</td>
<td>The direction from which the waves at the dominant period (DPD) are  coming. The units are degrees from true North, increasing clockwise, with      North as 0 (zero) degrees and East as 90 degrees.       See the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wave.shtml">Wave Measurements</a> section.</td>
</tr>
<tr>
<td>PRES</td>
<td>Sea level pressure (hPa).  For C-MAN sites and Great Lakes buoys,     the recorded pressure is reduced to sea level using the method     described in <em>NWS Technical Procedures Bulletin 291</em> (11/14/80). (     labeled BAR in Historical files)</td>
</tr>
<tr>
<td>ATMP</td>
<td>Air temperature (Celsius).  For sensor heights on buoys, see     <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/hull.shtml">Hull Descriptions</a>.  For sensor heights at     C-MAN stations, see <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/cmanht.shtml">C-MAN Sensor Locations</a></td>
</tr>
<tr>
<td>WTMP</td>
<td>Sea surface temperature (Celsius). For buoys the depth is referenced     to the hull’s waterline. For fixed platforms it varies with tide, but is     referenced to, or near <a target="_blank" rel="noopener" href="https://tidesandcurrents.noaa.gov/datum_options.html#MLLW">Mean Lower Low Water (MLLW)</a>.</td>
</tr>
<tr>
<td>DEWP</td>
<td>Dewpoint temperature taken at the same height as the air     temperature measurement.</td>
</tr>
<tr>
<td>VIS</td>
<td>Station visibility (nautical miles). Note that buoy stations are limited to reports from 0 to 1.6 nmi.</td>
</tr>
<tr>
<td>PTDY</td>
<td>Pressure Tendency is the direction (plus or minus) and the amount of     pressure change (hPa)for a three hour period ending at the time of     observation. (not in Historical files)</td>
</tr>
<tr>
<td>TIDE</td>
<td>The water level in feet above or below <a target="_blank" rel="noopener" href="https://tidesandcurrents.noaa.gov/datum_options.html#MLLW">Mean Lower Low Water (MLLW)</a>.</td>
</tr>
</tbody></table>
<h3 id="Derived-Met-Values"><a href="#Derived-Met-Values" class="headerlink" title="Derived Met Values"></a>Derived Met Values</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm CHILL  HEAT   ICE WSPD10 WSPD20
#yr  mo dy hr mn  degC  degC cm/hr    m/s    m/s
2014 09 11 16 50    MM  34.4    MM      5      5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>HEAT</th>
<th>For more information on heat index, please see the     <a target="_blank" rel="noopener" href="http://www.nws.noaa.gov/os/heat/index.shtml">NWS Heat Wave</a> page.</th>
</tr>
</thead>
<tbody><tr>
<td>CHILL</td>
<td>Please note that NDBC uses unadjusted winds to calculate wind     chill.  The winds are calculated at anemometer height. For more     information on wind chill, please see the      <a target="_blank" rel="noopener" href="http://www.nws.noaa.gov/om/windchill/index.shtml">NWS Wind Chill Temperature Index</a>.</td>
</tr>
<tr>
<td>ICE</td>
<td>Estimated ice accretion in inches per hour based on an     algorithm developed by Overland and Pease at the Pacific Marine     Environmental Laboratory in the mid-1980s. The algorithm relates icing     to the presently observed wind speed, air temperature, and sea surface     temperature.  The method is designed for trawlers in the 20 to 75 meter      length range, underway at normal speeds in open seas and not heading      downwind. In general, NWS forecasters translate ice accretion rates to the      following categories:     light: 0.0 to 0.24 inches of ice accretion/hour;     moderate: 0.25 to 0.8 inches/hour; and     heavy: greater than 0.8 inches/hour.</td>
</tr>
<tr>
<td>WSPD10</td>
<td>The estimation of Wind Speed (WSPD) measurement raised or lowered to a height    of 10 meters. NDBC uses the method of Liu et al., 1979: Bulk parameterization    of air-sea exchanges in heat and water vapor including molecular constraints at    the interface, <em>Journal of Atmospheric Science</em>, 36, pp. 1722-1735.</td>
</tr>
<tr>
<td>WSPD20</td>
<td>The estimation of Wind Speed (WSPD) measurement raised or lowered to a height    of 20 meters. NDBC uses the method of Liu et al., 1979: Bulk parameterization    of air-sea exchanges in heat and water vapor including molecular constraints at    the interface, <em>Journal of Atmospheric Science</em>, 36, pp. 1722-1735.</td>
</tr>
</tbody></table>
<h3 id="Supplemental-Measurements-Data"><a href="#Supplemental-Measurements-Data" class="headerlink" title="Supplemental Measurements Data"></a>Supplemental Measurements Data</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm   PRES PTIME  WSPD  WDIR WTIME
#yr  mo dy hr mn    hPa  hhmm   m/s  degT  hhmm
2014 09 11 16 50     MM    MM     6   110  1603<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>Lowest 1 minute pressure</th>
<th>Lowest recorded atmospheric pressure for the hour to the nearest 0.1 hPa and the time at which it occurred (hour and minute).</th>
</tr>
</thead>
<tbody><tr>
<td>Highest 1 minute wind speed</td>
<td>Highest recorded wind speed for the hour to the nearest 0.1 m/s,  its corresponding direction to the nearest degree, and the time at which it occurred (hour and minute).</td>
</tr>
</tbody></table>
<h3 id="Continuous-Winds"><a href="#Continuous-Winds" class="headerlink" title="Continuous Winds"></a>Continuous Winds</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WDIR WSPD GDR GST GTIME
#yr  mo dy hr mn degT m/s degT m/s hhmm
2014 09 11 16 50 117  5.2 120  6.0 1644<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>WDIR</th>
<th>Ten-minute average wind direction measurements in degrees clockwise     from true North. (DIR in Historical files)</th>
</tr>
</thead>
<tbody><tr>
<td>WSPD</td>
<td>Ten-minute average wind speed values in m/s. (SPD in Historical files)</td>
</tr>
<tr>
<td>GDR</td>
<td>Direction, in degrees clockwise from true North, of the GST,     reported at the last hourly 10-minute segment.</td>
</tr>
<tr>
<td>GST</td>
<td>Maximum 5-second peak gust during the measurement hour, reported at     the last hourly 10-minute segment.</td>
</tr>
<tr>
<td>GTIME</td>
<td>The minute of the hour that the GSP occurred, reported at the last     hourly 10-minute segment.</td>
</tr>
</tbody></table>
<p>For more information on continuous winds and the timing of these measurements, see the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/cwind.shtml">continuous winds</a> help section.</p>
<h3 id="Detailed-Wave-Summary-Realtime-data-files-only"><a href="#Detailed-Wave-Summary-Realtime-data-files-only" class="headerlink" title="Detailed Wave Summary (Realtime data files only)"></a>Detailed Wave Summary (Realtime data files only)</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WVHT  SwH  SwP  WWH  WWP SwD WWD  STEEPNESS  APD MWD
#yr  mo dy hr mn    m    m  sec    m  sec  -  degT     -      sec degT
2014 09 11 17 00  0.6  0.4  5.6  0.4  4.3  SE  MM        N/A  4.2 134<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>WVHT</th>
<th>Significant Wave Height is the average height (meters) of the     highest one-third of the waves during a 20 minute sampling period.</th>
</tr>
</thead>
<tbody><tr>
<td>SwH</td>
<td>Swell height is the vertical distance (meters) between any swell     crest and the succeeding swell wave trough.</td>
</tr>
<tr>
<td>SwP</td>
<td>Swell Period is the time (usually measured in seconds) that it takes     successive swell wave crests or troughs pass a fixed point.</td>
</tr>
<tr>
<td>WWH</td>
<td>Wind Wave Height is the vertical distance (meters) between any wind     wave crest and the succeeding wind wave trough (independent of swell     waves).</td>
</tr>
<tr>
<td>WWP</td>
<td>Wind Wave Period is the time (in seconds) that it takes successive     wind wave crests or troughs to pass a fixed point.</td>
</tr>
<tr>
<td>SwD</td>
<td>The direction from which the swell waves at the swell wave      period (SWPD) are coming.  The units are degrees from true North,      increasing clockwise, with North as 0 (zero) degrees and East as 90      degrees.</td>
</tr>
<tr>
<td>WWD</td>
<td>The direction from which the wind waves at the wind wave period (WWPD)     are coming.  The units are degrees from true North, increasing clockwise,      with North as 0 (zero) degrees and East as 90 degrees.</td>
</tr>
<tr>
<td>STEEPNESS</td>
<td>Wave steepness is the ratio of wave height to wave length and is an     indicator of wave stability.  When wave steepness exceeds a 1/7 ratio;     the wave becomes unstable and begins to break.</td>
</tr>
<tr>
<td>APD</td>
<td>Average Wave Period is the average period (seconds) of the highest     one-third of the wave observed during a 20 minute sampling period.</td>
</tr>
<tr>
<td>MWD</td>
<td>The direction from which the waves at the dominant period (DPD) are      coming. The units are degrees from true North, increasing clockwise, with      North as 0 (zero) degrees and East as 90 degrees.       See the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wave.shtml">Wave Measurements</a> section.</td>
</tr>
</tbody></table>
<h3 id="Spectral-Wave-Data"><a href="#Spectral-Wave-Data" class="headerlink" title="Spectral Wave Data"></a>Spectral Wave Data</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm Sep_Freq  &lt; spec_1 (freq_1) spec_2 (freq_2) spec_3 (freq_3) ... &gt;
2014 09 11 17 00 0.225 0.000 (0.033) 0.000 (0.038) 0.000 (0.043) ...&gt; 
#YY  MM DD hh mm alpha1_1 (freq_1) alpha1_2 (freq_2) alpha1_3 (freq_3) ... &gt;
2014 09 11 17 00 999.0 (0.033) 999.0 (0.038) 999.0 (0.043) ...&gt;
#YY  MM DD hh mm alpha2_1 (freq_1) alpha2_2 (freq_2) alpha2_3 (freq_3) ... &gt;
2014 09 11 17 00 999.0 (0.033) 999.0 (0.038) 999.0 (0.043) ...
#YY  MM DD hh mm r1_1 (freq_1) r1_2 (freq_2) r1_3 (freq_3) ... &gt;
2014 09 11 17 00 999.00 (0.033) 999.00 (0.038) 999.00 (0.043) ...&gt;
#YY  MM DD hh mm r2_1 (freq_1) r2_2 (freq_2) r2_3 (freq_3) ... &gt;
2014 09 11 17 00 999.00 (0.033) 999.00 (0.038) 999.00 (0.043) ...&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>Sep_Freq</th>
<th>The Separation Frequency is the frequency that separates wind waves (WWH, WWP, WWD)     from swell waves (SWH, SWP,SWD). NDBC inserts the value 9.999 if  Sep_Freq is missing.</th>
</tr>
</thead>
<tbody><tr>
<td>Spectral wave density</td>
<td>Energy in (meter*meter)/Hz, for each frequency bin (typically from     0.03 Hz to 0.40 Hz).</td>
</tr>
<tr>
<td>Spectral wave direction</td>
<td>Mean wave direction, in degrees from true North, for each frequency     bin. A list of <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/dwa.shtml">directional stations</a> is available.</td>
</tr>
<tr>
<td>Directional Wave Spectrum</td>
<td>= C11(f) * D(f,A), f=frequency (Hz), A=Azimuth angle measured     clockwise from true North to the direction wave is from.      D(f,A) = (1/PI)<em>(0.5+R1</em>COS(A-ALPHA1)+R2<em>COS(2</em>(A-ALPHA2))).       R1 and R2 are the first and second normalized polar coordinates of the Fourier coefficients and are nondimensional. ALPHA1 and ALPHA2      are respectively mean and principal wave directions. In terms of     Longuet-Higgins Fourier Coefficients     R1 = (SQRT(a1<em>a1+b1</em>b1))/a0     R2 = (SQRT(a2<em>a2+b2</em>b2))/a0     ALPHA1 = 270.0-ARCTAN(b1,a1)     ALPHA2 = 270.0-(0.5*ARCTAN(b2,a2)+{0. or 180.})</td>
</tr>
<tr>
<td></td>
<td>Notes: The R1 and R2 values in the monthly and yearly historical data files are scaled by 100, a carryover from how the data are transported to the archive centers.  The units are hundredths, so the R1 and R2 values in those files should  be multiplied by 0.01. D(f,A) can take on negative values because of the trigonometric sine and cosine functions. There are several approaches to prevent or deal  with the negative values. For more information and discussion of some  approaches see:  Use of advanced directional wave spectra analysis  methods, M. D. Earle,  K. E. Steele, and D. W. C. Wang, Ocean  Engineering, Volume 26, Issue 12, December 1999, Pages 1421-1434. ALPHA2 has ambiguous results in using the arctangent function with  the Fourier Coefficients,b 2 ,a 2 . When necessary, NDBC adds 180  degrees to ALPHA2 in order to minimize the difference between ALPHA 1  and ALPHA2.</td>
</tr>
</tbody></table>
<p>For more information on the mathematics behind the measuring of  surface water waves, see the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/wave.shtml">waves</a> help section.</p>
<h3 id="Ocean-Current-Data"><a href="#Ocean-Current-Data" class="headerlink" title="Ocean Current Data"></a>Ocean Current Data</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm DEP01 DIR01 SPD01 DEP02 DIR02 SPD02 DEP03 DIR03 SPD03 ...&gt;
#yr  mo dy hr mn     m  degT  cm/s     m  degT  cm/s     m  degT  cm/s ...&gt;
2014 09 11 17 04     2    40     8    10   120     5    14   250    13 ...&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>DEP01,DEP02,…</th>
<th>The distance from the sea surface to the middle of the depth cells,     or bins, measured in meters.</th>
</tr>
</thead>
<tbody><tr>
<td>DIR01,DIR02,…</td>
<td>The direction the ocean current is flowing toward.  0-360 degrees,     360 is due north, 0 means no measurable current.</td>
</tr>
<tr>
<td>SPD01,SPD02,…</td>
<td>The speed of the ocean current measured in cm/s.</td>
</tr>
</tbody></table>
<h3 id="Ocean-Current-Data-Expanded-ADCP-format"><a href="#Ocean-Current-Data-Expanded-ADCP-format" class="headerlink" title="Ocean Current Data (Expanded ADCP format)"></a>Ocean Current Data (Expanded ADCP format)</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm I Bin   Depth Dir Speed ErrVl VerVl %Good3 %Good4 %GoodE   EI1   EI2   EI3   EI4   CM1   CM2   CM3   CM4 Flags
#yr  mo dy hr mn -   -     m  degT  cm/s  cm/s  cm/s      %      %      %     -     -     -     -     -     -     -     - -
2014 09 11 17 46 1   1    69.4 117  63.2  -0.7  -1.2      0    100      0   171   166   177   170   234   231   233   230 393333330
2014 09 11 17 46 1   2   101.4 122  63.1  -1.0  -3.7      0    100      0   147   145   154   150   236   236   235   237 393333330
2014 09 11 17 46 1   3   133.4 120  54.1   4.2  -3.4      0    100      0   142   134   142   140   225   238   236   238 393333330<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>Instrument Number</th>
<th>Stations may have more than one ADCP instrument.  This field  distinguishes these instruments by number.  Valid values are 0-9, with 0 being reserved for surface measurements.</th>
</tr>
</thead>
<tbody><tr>
<td>Bin</td>
<td>The bin number, ranging from 1 to 128, where 1 is the bin closest to the transducer head.</td>
</tr>
<tr>
<td>Depth</td>
<td>The distance from the sea surface to the middle of the depth cells,        or bins, measured in meters.</td>
</tr>
<tr>
<td>Dir</td>
<td>The direction the ocean current is flowing toward.  0-360 degrees,     360 is due north, 0 means no measurable current.</td>
</tr>
<tr>
<td>Speed</td>
<td>The speed of the ocean current measured in cm/s.</td>
</tr>
<tr>
<td>ErrVl</td>
<td>The error velocity measured in cm/s.</td>
</tr>
<tr>
<td>VerVl</td>
<td>The vertical velocity of the ocean current measured in cm/s.</td>
</tr>
<tr>
<td>%Good3</td>
<td>The percentage of three-beam solutions that are good.</td>
</tr>
<tr>
<td>%Good4</td>
<td>The percentage of four-beam solutions that are good.</td>
</tr>
<tr>
<td>%GoodE</td>
<td>The percentage of transformations rejected.</td>
</tr>
<tr>
<td>EI1,EI2,EI3,EI4</td>
<td>The echo intensity values for the four beams.  Valid values are 0 to 255.      EI1 = Echo Intensity for beam #1;      EI2 = Echo Intensity for beam #1;      EI3 = Echo Intensity for beam #3; and      EI4 = Echo Intensity for beam #4.</td>
</tr>
<tr>
<td>CM1,CM2,CM3,CM4</td>
<td>The correlation magnitude values for the four beams.  Valid values are 0 to 255.      CM1 = Correlation Magnitude for beam #1;      CM2 = Correlation Magnitude for beam #1;      CM3 = Correlation Magnitude for beam #3; and      CM4 = Correlation Magnitude for beam #4.</td>
</tr>
<tr>
<td>Flags</td>
<td>The nine quality flags represent the results of the following quality tests based on their position in the flags field.     Flag 1 represents the overall bin status.      Flag 2 represents the ADCP Built-In Test (BIT) status.      Flag 3 represents the Error Velocity test status.      Flag 4 represents the Percent Good test status.      Flag 5 represents the Correlation Magnitude test status.      Flag 6 represents the Vertical Velocity test status.      Flag 7 represents the North Horizontal Velocity test status.      Flag 8 represents the East Horizontal Velocity test status.      Flag 9 represents the Echo Intensity test status.     Valid values are:      0 = quality not evaluated;      1 = failed quality test;      2 = questionable or suspect data;      3 = good data/passed quality test; and      9 = missing data.</td>
</tr>
</tbody></table>
<h3 id="Marsh-McBirney-Current-Measurements"><a href="#Marsh-McBirney-Current-Measurements" class="headerlink" title="Marsh-McBirney Current Measurements"></a>Marsh-McBirney Current Measurements</h3><pre class="line-numbers language-none"><code class="language-none">YY MM DD hh mm    DIR    SPD
96 10 31 23  0    198    1.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>DIR</th>
<th>Direction the current is flowing TOWARDS, measured in degrees     clockwise from North.</th>
</tr>
</thead>
<tbody><tr>
<td>SPD</td>
<td>Current speed in cm/s.</td>
</tr>
</tbody></table>
<h3 id="Water-Level"><a href="#Water-Level" class="headerlink" title="Water Level"></a>Water Level</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm TG01 TG02 TG03 TG04 TG05 TG06 TG07 TG08 TG09 TG10
2014 07 01 00 00 10.6 10.6 10.6 10.5 10.6 10.6 10.6 10.7 10.7 10.8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>TG01, TG02,…,TG10</th>
<th>Six-minute water levels representing the height, in feet, of the     water above or below <a target="_blank" rel="noopener" href="https://tidesandcurrents.noaa.gov/datum_options.html#MLLW">Mean Lower Low Water (MLLW)</a>,     offset by 10 ft. to prevent negative values.   Please subtract 10     ft. from every value to obtain the true water level value, in reference to MLLW.</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Oceanographic-Data"><a href="#Oceanographic-Data" class="headerlink" title="Oceanographic Data"></a>Oceanographic Data</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm   DEPTH  OTMP   COND   SAL   O2% O2PPM  CLCON  TURB    PH    EH
#yr  mo dy hr mn       m  degC  mS/cm   psu     %   ppm   ug/l   FTU     -    mv
2014 09 11 17 00     1.0 29.05     MM 34.98    MM    MM     MM    MM    MM    MM<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>Depth (DEPTH)</th>
<th>Depth (meters) at which measurements are taken.</th>
</tr>
</thead>
<tbody><tr>
<td>Ocean Temperature (OTMP)</td>
<td>The direct measurement (Celsius) of the Ocean Temperature (as opposed     to the indirect measurement  (see WTMP above)).</td>
</tr>
<tr>
<td>Conductivity (COND)</td>
<td>Conductivity is a measure of the electrical conductivity properties of     seawater in milliSiemens per centimeter.</td>
</tr>
<tr>
<td>Salinity (SAL)</td>
<td>Salinity is computed by a known functional relationship between the     measured electrical conductivity of seawater (CON), temperature (OTMP) and     pressure. Salinity is computed using the Practical Salinity Scale of 1978     (PSS78) and reported in Practical Salinity Units.</td>
</tr>
<tr>
<td>Oxygen Concentration (O2%)</td>
<td>Dissolved oxygen as a percentage.</td>
</tr>
<tr>
<td>Oxygen Concentration (O2PPM)</td>
<td>Dissolved oxygen in parts per million.</td>
</tr>
<tr>
<td>Chlorophyll Concentration (CLCON)</td>
<td>Chlorophyll concentration in micrograms per liter (ug/l).</td>
</tr>
<tr>
<td>Turbidity (TURB)</td>
<td>Turbidity is an expression of the optical property that causes light to     be scattered and absorbed rather than transmitted in straight lines through     the sample (APHA 1980). Units are Formazine Turbidity Units (FTU).</td>
</tr>
<tr>
<td>pH (PH)</td>
<td>A measure of the acidity or alkalinity of the seawater.</td>
</tr>
<tr>
<td>Eh (EH)</td>
<td>Redox (oxidation and reduction) potential of seawater in millivolts.</td>
</tr>
</tbody></table>
<h3 id="Solar-Radiation-Data"><a href="#Solar-Radiation-Data" class="headerlink" title="Solar Radiation Data"></a>Solar Radiation Data</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm  SRAD1  SWRAD  LWRAD
#yr  mo dy hr mn   w/m2   w/m2   w/m2
2014 09 11 18 00 1061.0     MM     MM<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>Shortwave Radiation  (SRAD1, SWRAD)</th>
<th>Average shortwave radiation in watts per square     meter for the preceding hour. Sample frequency is 2 times per second (2     Hz).   If present, SRAD1 is from a LI-COR LI-200 pyranometer sensor, and     SWRAD is from an Eppley PSP Precision Spectral Pyranometer.</th>
</tr>
</thead>
<tbody><tr>
<td>Longwave Radiation (LWRAD)</td>
<td>Average downwelling longwave radiation in watts per     square meter for the preceding hour.  Sample frequency is 2 times per     second (2 Hz).  If present, LWRAD is from an Eppley PIR Precision     Infrared Radiometer.</td>
</tr>
</tbody></table>
<h3 id="DART-Tsunameters-Measurements"><a href="#DART-Tsunameters-Measurements" class="headerlink" title="DART (Tsunameters) Measurements"></a>DART (Tsunameters) Measurements</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm ss T   HEIGHT
#yr  mo dy hr mn  s -        m
2014 09 11 17 00 00 1 5848.422<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>T (TYPE)</th>
<th>Measurement Type:     1 = 15-minute measurement;     2 = 1-minute measurement; and     3 = 15-second measurement.</th>
</tr>
</thead>
<tbody><tr>
<td>HEIGHT</td>
<td>Height of water column in meters.</td>
</tr>
<tr>
<td>tt = Tsunami Trigger Time, see the <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/dart/algorithm.shtml">Tsunami Detection Algorithm</a>      ts = data Time Stamp(s)</td>
<td></td>
</tr>
</tbody></table>
<h3 id="24-Hour-Rain-Measurements"><a href="#24-Hour-Rain-Measurements" class="headerlink" title="24-Hour Rain Measurements"></a>24-Hour Rain Measurements</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm   RATE  PCT  SDEV
#yr  mo dy hr mn   mm/h   %     -
2008 01 01 12 00   0.0   0.0   0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>24-Hour Rain Rate</th>
<th>Average precipitation rate in units of millimeters per hour over 24-hour period from 00:00 to 23:59.99 GMT.</th>
</tr>
</thead>
<tbody><tr>
<td>Percent Time Raining in 24-Hour Period</td>
<td>Percentage of 144 ten-minute periods within a 24 hour period with a measurable accumulation of precipitation.</td>
</tr>
<tr>
<td>SDev</td>
<td>—</td>
</tr>
<tr>
<td>Flag</td>
<td>In the case of 24-hour rainfall measurements, a flag is assigned  when over half of the 10-minute measurements from which it is derived  are flagged.</td>
</tr>
</tbody></table>
<h3 id="Hourly-Rain-Measurements"><a href="#Hourly-Rain-Measurements" class="headerlink" title="Hourly Rain Measurements"></a>Hourly Rain Measurements</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm  ACCUM
#yr  mo dy hr mn    mm
2008 01 01 00 30   0.0 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>Hourly Rain Accumulation</th>
<th>Total accumulation of precipitation in units of millimeters on  station during the 60-minute period from minute 0 to minute 59:59.99 of  the hour.</th>
</tr>
</thead>
<tbody><tr>
<td>Flag</td>
<td>In the case of one-hour accumulation, a flag is assigned when over half of the 10-minute measurements from which it is derived have been  flagged.</td>
</tr>
</tbody></table>
<h3 id="10-Minute-Rain-Measurements"><a href="#10-Minute-Rain-Measurements" class="headerlink" title="10-Minute Rain Measurements"></a>10-Minute Rain Measurements</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm   RATE
#yr  mo dy hr mn   mm/h
2008 01 01 00 00   0.0 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>10-Minute Rain Rate</th>
<th>Rain rate in units of millimeters per hour on station over the  10-minute period from 5 minutes before to 4 minutes 59.99 seconds after  the time with which it is associated.</th>
</tr>
</thead>
<tbody><tr>
<td>Flag</td>
<td>In the case of 10-minute rainfall measurements, a flag is assigned to any measurement when either the -5 or +5 minute rain measurement  from which it is derived is missing or obviously an error.</td>
</tr>
</tbody></table>
<h3 id="Housekeeping-Measurements"><a href="#Housekeeping-Measurements" class="headerlink" title="Housekeeping Measurements"></a>Housekeeping Measurements</h3><pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm  BATTV BATTCURR BATTTEMP REMCAP
#yr  mo dy hr mn  Volts     Amps     DegC     Ah
2016 09 15 19 00 12.381   -0.177     32.9  116.8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th>BATTV</th>
<th>Hourly Average Battery Voltage (volts)</th>
</tr>
</thead>
<tbody><tr>
<td>BATTCURR</td>
<td>Hourly Average Battery Current (amperes)</td>
</tr>
<tr>
<td>BATTTEMP</td>
<td>Hourly Average Battery Temperature (degrees Celsius)</td>
</tr>
<tr>
<td>REMCAP</td>
<td>Remaining Battery Capacity (ampere-hours)</td>
</tr>
</tbody></table>
<h3 id="Discontinued-Measurement-Abbreviations"><a href="#Discontinued-Measurement-Abbreviations" class="headerlink" title="Discontinued Measurement Abbreviations"></a>Discontinued Measurement Abbreviations</h3><p>Some historical files have column heading abbreviations that have  changed over time.  The old abbreviations are listed below with links to the new standardized abbreviation description.</p>
<table>
<thead>
<tr>
<th>Old</th>
<th>New Abbreviation</th>
</tr>
</thead>
<tbody><tr>
<td>WD</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#wdir">WDIR</a> - Wind Direction</td>
</tr>
<tr>
<td>DIR</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#wdir">WDIR</a> - 10 Minute Wind Direction</td>
</tr>
<tr>
<td>SPD</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#cwspd">WSPD</a> - 10 Minute Wind Speed</td>
</tr>
<tr>
<td>GSP</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#cgst">GST</a> - Gust in Continuous Winds data</td>
</tr>
<tr>
<td>GMN</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#gtime">GTIME</a> - Time of Gust in Continuous Winds data</td>
</tr>
<tr>
<td>BARO</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#pres">PRES</a> - Pressure</td>
</tr>
<tr>
<td>H0</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#wvht">WVHT</a> - Significant Wave Height</td>
</tr>
<tr>
<td>DOMPD</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#dpd">DPD</a> - Dominant Wave Period</td>
</tr>
<tr>
<td>AVP</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#apd">APD</a> - Average Wave Period</td>
</tr>
<tr>
<td>SRAD</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#swrad">SWRAD</a> - Short Wave Solar Radiation</td>
</tr>
<tr>
<td>SRAD2</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#swrad">SWRAD</a> - LI-COR Short Wave Solar Radiation</td>
</tr>
<tr>
<td>LRAD</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#lwrad">LWRAD</a> - Long Wave Solar Radiation</td>
</tr>
<tr>
<td>LRAD1</td>
<td><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/measdes.shtml#lwrad">LWRAD</a> - Long Wave Solar Radiation</td>
</tr>
</tbody></table>
<h2 id="参考资料-4"><a href="#参考资料-4" class="headerlink" title="参考资料"></a>参考资料</h2><p>官网历史数据下载、站点年份信息：<a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/historical_data.shtml">https://www.ndbc.noaa.gov/historical_data.shtml</a></p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220211125419.png"></p>
<p>选择所需下载数据类型，打开浮标年份，下载当年的gzip文件即可；</p>
</blockquote>
<p>站点经纬度信息：<a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/to_station.shtml">https://www.ndbc.noaa.gov/to_station.shtml</a></p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220211142137.png"></p>
<p>点击浮标站点，可发现对应的经纬度信息；</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1rp4y1x73V?from=search&amp;seid=17647565350839510722&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1rp4y1x73V?from=search&amp;seid=17647565350839510722&amp;spm_id_from=333.337.0.0</a></p>
<blockquote>
<p>matlab 很简单的爬取网页内容的方法;</p>
<p>webread，<strong>标签</strong>，<strong>我是用的是这个</strong></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1ti4y1V7uS?from=search&amp;seid=13018614422108302117&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1ti4y1V7uS?from=search&amp;seid=13018614422108302117&amp;spm_id_from=333.337.0.0</a></p>
<blockquote>
<p>通过MATLAB自带的<strong>Webread,Regexpi,Cell,Writetable</strong>等函数批量提取网页相关信息。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11V411f7Wo/?spm_id_from=333.788.recommend_more_video.-1">https://www.bilibili.com/video/BV11V411f7Wo/?spm_id_from=333.788.recommend_more_video.-1</a></p>
<blockquote>
<p>一个MATLAB与<strong>ie交互</strong>的案例代码，爬虫效率较慢</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1ti4y1t7L4?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1ti4y1t7L4?spm_id_from=333.999.0.0</a></p>
<blockquote>
<p>MATLAB如何<strong>爬取B站Up信息</strong>；</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40845110/article/details/115215561">https://blog.csdn.net/qq_40845110/article/details/115215561</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39892788/article/details/89875983">https://blog.csdn.net/weixin_39892788/article/details/89875983</a></p>
<blockquote>
<p>MATLAB webread 配置浏览器；</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/matlabcentral/answers/92506-how-can-i-configure-matlab-to-allow-access-to-self-signed-https-servers">https://ww2.mathworks.cn/matlabcentral/answers/92506-how-can-i-configure-matlab-to-allow-access-to-self-signed-https-servers</a></p>
<blockquote>
<p>How can I configure MATLAB to allow access to self-signed HTTPS servers?</p>
</blockquote>
<h2 id="How-can-I-configure-MATLAB-to-allow-access-to-self-signed-HTTPS-servers"><a href="#How-can-I-configure-MATLAB-to-allow-access-to-self-signed-HTTPS-servers" class="headerlink" title="How can I configure MATLAB to allow access to self-signed HTTPS servers?"></a>How can I configure MATLAB to allow access to self-signed HTTPS servers?</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/matlabcentral/answers/92506-how-can-i-configure-matlab-to-allow-access-to-self-signed-https-servers">https://ww2.mathworks.cn/matlabcentral/answers/92506-how-can-i-configure-matlab-to-allow-access-to-self-signed-https-servers</a></p>
</blockquote>
<h3 id="question-description"><a href="#question-description" class="headerlink" title="question description"></a>question description</h3><p>webread:</p>
<pre class="line-numbers language-none"><code class="language-none">webread('https://self-signed.badssl.com/')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>In MATLAB releases prior to R2016b actually returns the data without any error or warning for this server:</p>
<pre class="line-numbers language-none"><code class="language-none">ans =
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
  &lt;link rel="shortcut icon" href="/icons/favicon-red.ico"/&gt;
  &lt;link rel="apple-touch-icon" href="/icons/icon-red.png"/&gt;
  &lt;title&gt;self-signed.badssl.com&lt;/title&gt;
  &lt;link rel="stylesheet" href="/style.css"&gt;
  &lt;style&gt;body { background: red; }&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="content"&gt;
  &lt;h1 style="font-size: 12vw;"&gt;
    self-signed.&lt;br&gt;badssl.com
  &lt;/h1&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>But for another server:</p>
<pre class="line-numbers language-none"><code class="language-none">webread('https://localhost/')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>I receive:</p>
<p>Error using readContentFromWebService (line 45)</p>
<p>The server returned the message: “sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find</p>
<p>valid certification path to requested target” for URL, ‘<a target="_blank" rel="noopener" href="https://localhost/'">https://localhost/'</a> (with HTTP response code unknown).</p>
<p>Error in webread (line 122)</p>
<p>[varargout{1:nargout}] = readContentFromWebService(connection, options);</p>
<p>And in MATLAB release R2016b:</p>
<pre class="line-numbers language-none"><code class="language-none">webread('https://self-signed.badssl.com/')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Throws:</p>
<p>Error using webread (line 119)</p>
<p><strong>Could not establish a secure connection to “self-signed.badssl.com”. The reason is “error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed”.</strong></p>
<p><strong>Check your certificate file (C:\MATLAB\R2016b\sys\certificates\ca\rootcerts.pem) for expired, missing or invalid certificates</strong>.</p>
<p>For both servers actually.</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212120034.png"></p>
<h3 id="answer：MathWorks-Support-Team-STAFF-2019-6-19"><a href="#answer：MathWorks-Support-Team-STAFF-2019-6-19" class="headerlink" title="answer：MathWorks Support Team, STAFF, 2019-6-19"></a>answer：MathWorks Support Team, STAFF, 2019-6-19</h3><p>Before continuing please note that certificates are used for a reason and an untrusted certificate may indicate that communication with the website that you are trying to access may not be secure; you may even be accessing a different website than you might have expected (also see the further explanations in your webbrowser when trying to access the website).</p>
<p>MATLAB verifies HTTPS server certificates in a number of different ways.</p>
<p>WHEN YOU ARE WORKING WITH URLREAD/URLWRITE OR JAVA CLASSES DIRECTLY, the verification is basically performed by the JRE in MATLAB. The JRE uses a keystore with trusted certificate authorities to determine which certificates are trusted. I.e. it only accepts certificates which have been signed by a trusted authority and self-signed certificates are not accepted. If you would like to add a (self-signed) certificate or authority to this store, use the following steps:</p>
<ol>
<li><p>Download the certificate using your web browser/operating system as CER-or CRT-file.</p>
</li>
<li><p>Use the attached MATLAB function to add this certificate as trusted to MATLAB’s JRE’s keystore. You will need to manually type “yes” when prompted to actually accept the certificate.</p>
</li>
<li><p>Restart MATLAB after importing the certificate into the keystore.</p>
</li>
</ol>
<p>Note that the steps above require read/write permissions for the following file and the directory in which it is located:</p>
<pre class="line-numbers language-none"><code class="language-none">fullfile(matlabroot,'sys','java','jre',computer('arch'),'jre','lib','security','cacerts')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>This means that you may need to start MATLAB as Administrator/root depending on where MATLAB is installed and the permissions set on this location.</p>
<p>WHEN WORKING WITH WEBREAD/WEBWRITE/WEBSAVE, there are two major situations:</p>
<ol>
<li><p>You are connecting to a server with basic or no further authentication whatsoever. In this case webread/webwrite/websave only performs its own verification. But again there two situations:</p>
<ul>
<li><p>a. In releases prior to R2016b the verification is limited to only verifying that the URL you are accessing matches the CN in the certificate; there is no validation of the certificate’s authenticity however. I.e. it accepts self-signed certificates as long as they are valid for the server in question.</p>
</li>
<li><p>b. In release R2016b it first verifies the authenticity of the certificates using a keystore similar to- but separate from- the keystore of the JRE mentioned above. I.e. it only accepts certificates which have been signed by a trusted authority. If this validation fails, you receive the error: ERROR: Error using webread (line 119) Could not establish a secure connection to “self-signed.badssl.com”. The reason is “error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed”. Check your certificate file (C:\MATLAB\R2016b\sys\certificates\ca\rootcerts.pem) for expired, missing or invalid certificates.</p>
</li>
</ul>
<p>If you want to access a server with a self-signed certificate anyway you can either:</p>
<ul>
<li><p>i) Add the certificate to the trusted keystore of webread/webwrite/webstore, see the documentation of weboptions to learn more about this:</p>
<p><a target="_blank" rel="noopener" href="http://www.mathworks.com/help/releases/R2016b/matlab/ref/weboptions.html#expand_panel_body_input_argument_namevalue_CertificateFilename">http://www.mathworks.com/help/releases/R2016b/matlab/ref/weboptions.html#expand_panel_body_input_argument_namevalue_CertificateFilename</a></p>
</li>
<li><p>ii) Disable the authenticity verification (i.e. fall back to the behavior in older releases), as noted on the documentation page mentioned above this can be accomplished by setting ‘CertificateFilename’ to empty:</p>
<pre class="line-numbers language-none"><code class="language-none">&gt;&gt; o = weboptions('CertificateFilename','');
&gt;&gt; webread('https://self-signed.badssl.com/',o)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p>You are connecting to a server with authentication other than basic (e.g. NTLM). In this case webread/webwrite/websave first performs the verification described under point 1 but then falls back to using a Java interface which actually also performs its own authentication. If this part fails, you receive the error: ERROR: Error using readContentFromWebService (line 45) The server returned the message: “sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target” for URL, ‘<a target="_blank" rel="noopener" href="https://localhost/'">https://localhost/'</a> (with HTTP response code unknown). Error in webread (line 122) [varargout{1:nargout}] = readContentFromWebService(connection, options);</p>
<p>See the “WHEN YOU ARE WORKING WITH URLREAD/URLWRITE OR JAVA CLASSES DIRECTLY” section above on how to make this Java part trust your self-signed servers.</p>
<p>Note that this means that if you want to work with webread, a self-signed HTTPS server with NTLM authentication in MATLAB R2016b, you need to actually add the self-signed certificate in two places: the keystore specified by CertificateFilename (or set this to empty) and the JRE keystore.</p>
<p>Note: Above script did not work for older MATLAB installs, such as R2007b, as the directory structure is different for the JRE that comes with the older MATLAB. Pasting something similar to below into a command prompt, allowed the certificate to be added. However there were new java issues afterward, such as a missing server hello.</p>
<p>“C:\Program Files\MATLAB\R2007b\sys\java\jre\win64\jre1.6.0\bin\keytool.exe” -import -file C:\temp\My_Downloaded_Cert_from_Chrome.cer -keystore “C:\Program Files\MATLAB\R2007b\sys\java\jre\win64\jre1.6.0\lib\security\cacerts” -storepass changeit</p>
</li>
</ol>
<h3 id="answer：Jerome-Blaha，2021-7-26"><a href="#answer：Jerome-Blaha，2021-7-26" class="headerlink" title="answer：Jerome Blaha，2021-7-26"></a>answer：Jerome Blaha，2021-7-26</h3><p>Never got this to run correctly.  The easier solution was to completely switch to using a Matlab script exection of a DOS Curl.exe to get around this issue.  Not quite as fast, but a working solution.</p>
<p>If you go this route, you’ll want to call the Curl.exe in a directory and also to supress any additional messages or warning that Curl may return.  It worked like a charm to pull data from both secure and non-secure sites.  Good Luck.</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">try</span>
    clear zz<span class="token punctuation">;</span>
    zz<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">% Attempt to read in JSON</span>
    <span class="token comment">%zz=webread('https://www.jsoninsecurewebsite.com/json',options); Matlab 2016</span>
    <span class="token punctuation">[</span>status<span class="token punctuation">,</span>zz<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">dos</span><span class="token punctuation">(</span><span class="token string">'"C:\curl\src\curl" --fail --silent --show-error https://www.jsoninsecurewebsite.com/json -k --insecure'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%[status,zz]=dos('"C:\curl\src\curl" --fail --silent --show-error https://www.ndbc.noaa.gov/to_station.shtml -k --insecure');</span>
    sizepull<span class="token operator">=</span><span class="token function">whos</span><span class="token punctuation">(</span><span class="token string">'zz'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sizepull<span class="token operator">=</span>sizepull<span class="token punctuation">.</span>bytes<span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'   Returned Pull in %.2f sec with %.3fMB of data \n--&gt;Starting Parse...'</span><span class="token punctuation">,</span>toc<span class="token punctuation">,</span><span class="token punctuation">(</span>sizepull<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">catch</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Exception thrown !\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="answer：Chirag-Patel，2017-3-9，（成功-）"><a href="#answer：Chirag-Patel，2017-3-9，（成功-）" class="headerlink" title="answer：Chirag Patel，2017-3-9，（成功~~）"></a>answer：Chirag Patel，2017-3-9，（成功~~）</h3><p>Had same issue in MATLAB R2014b. I was getting error while executing &gt;&gt;webread(url,options)</p>
<p>PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target</p>
<p>Solution:</p>
<ul>
<li><p>Step1: Go to Google Chrome: Access same URL: Download Certificate (call it myCert.cer)</p>
<p>Open Google Chrome. Click on Three Dots on Right-Top Most Corner, Select More Tools/Developer Tools –&gt; Go to Security Tab –&gt; Select View Certificate –&gt; Go to Details Tab –&gt; Click on Copy to File.</p>
</li>
<li><p>Step2: Download importcert.m and execute &gt;&gt; importcert(‘myCert.cer’)</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token function">importcert</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nargin <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token comment">% If no certificate specified show open file dialog to select</span>
        <span class="token punctuation">[</span>filename<span class="token punctuation">,</span>path<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">uigetfile</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'*.cer;*.crt'</span><span class="token punctuation">,</span><span class="token string">'Certificates (*.cer,*.crt)'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'Select Certificate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>filename<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">return</span><span class="token punctuation">,</span> <span class="token keyword">end</span>
        filename <span class="token operator">=</span> <span class="token function">fullfile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token comment">% Determine Java keytool location and cacerts location</span>
    keytool <span class="token operator">=</span> <span class="token function">fullfile</span><span class="token punctuation">(</span>matlabroot<span class="token punctuation">,</span><span class="token string">'sys'</span><span class="token punctuation">,</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token function">computer</span><span class="token punctuation">(</span><span class="token string">'arch'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token string">'bin'</span><span class="token punctuation">,</span><span class="token string">'keytool'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cacerts <span class="token operator">=</span> <span class="token function">fullfile</span><span class="token punctuation">(</span>matlabroot<span class="token punctuation">,</span><span class="token string">'sys'</span><span class="token punctuation">,</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token function">computer</span><span class="token punctuation">(</span><span class="token string">'arch'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token string">'lib'</span><span class="token punctuation">,</span><span class="token string">'security'</span><span class="token punctuation">,</span><span class="token string">'cacerts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">% Create backup of cacerts</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token function">exist</span><span class="token punctuation">(</span><span class="token punctuation">[</span>cacerts <span class="token string">'.org'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">copyfile</span><span class="token punctuation">(</span>cacerts<span class="token punctuation">,</span><span class="token punctuation">[</span>cacerts <span class="token string">'.org'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    <span class="token comment">% Construct and execute keytool</span>
    command <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string">'"%s" -import -file "%s" -keystore "%s" -storepass changeit'</span><span class="token punctuation">,</span>keytool<span class="token punctuation">,</span>filename<span class="token punctuation">,</span>cacerts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dos</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>Step3: Restart MATLAB</p>
</li>
</ul>
<h2 id="下载、plot-NDBC浮标Standard-Meterological历史数据（matlab）"><a href="#下载、plot-NDBC浮标Standard-Meterological历史数据（matlab）" class="headerlink" title="下载、plot NDBC浮标Standard Meterological历史数据（matlab）"></a>下载、plot NDBC浮标Standard Meterological历史数据（matlab）</h2><h3 id="ndbc-station-info-m"><a href="#ndbc-station-info-m" class="headerlink" title="ndbc_station_info.m"></a>ndbc_station_info.m</h3><p>创建包含NDBC所有浮标（or station）经纬度信息、数据年份信息的<code>ndbc_station_info</code>变量，保存到<code>ndbc_station_info.mat</code>。</p>
<blockquote>
<p>网页上的浮标还可能可以爬取的数据有：Air temp height，Anemometer height，Barometer elevation，Sea temp depth，Water dept，Watch circle radius。</p>
<p>王玥师姐，20220211晚上，给我发了包含<strong>115个浮标</strong>以上信息的excel表格。</p>
</blockquote>
<blockquote>
<p><code>ndbc_station_info.mat</code> 和 师姐的excel表格：</p>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1aW3U1dJrRNlKfZ7d-Ot5Iw">https://pan.baidu.com/s/1aW3U1dJrRNlKfZ7d-Ot5Iw</a><br>提取码：98gr<br>–来自百度网盘</p>
</blockquote>
<p><code>ndbc_station_info.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>

<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-12 first verison.</span>

clc<span class="token punctuation">,</span> clear all<span class="token punctuation">;</span>

<span class="token comment">%% webread 正常运行</span>
url1 <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/to_station.shtml'</span><span class="token punctuation">;</span>
<span class="token comment">%url2 = 'http://www.ndbc.noaa.gov/to_station.shtml'; %http 和 https 的区别：https://www.zhihu.com/question/436800837</span>
<span class="token comment">%url3 = 'https://blog.csdn.net/';</span>
<span class="token comment">%url4 = 'https://www.ndbc.noaa.gov';</span>
<span class="token comment">%url5 = 'http://baidu.com';</span>

UserAgent <span class="token operator">=</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'</span><span class="token punctuation">;</span><span class="token comment">%如何查看火狐浏览器的useragent：https://blog.csdn.net/weixin_39892788/article/details/89875983</span>
<span class="token comment">%UserAgent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36';</span>

<span class="token comment">%options = weboptions();</span>
<span class="token comment">%options = weboptions('UserAgent',UserAgent);</span>
options <span class="token operator">=</span> <span class="token function">weboptions</span><span class="token punctuation">(</span><span class="token string">'UserAgent'</span><span class="token punctuation">,</span>UserAgent<span class="token punctuation">,</span><span class="token string">'Timeout'</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%针对自己的浏览器填写</span>
<span class="token comment">% ,'CertificateFilename',''</span>
<span class="token comment">%设置模拟浏览器：https://blog.csdn.net/qq_40845110/article/details/115215561</span>

station_list_pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%读取station_list的网页源代码</span>
<span class="token comment">%webread 和 urlread 的功能一样，[Contents Status] = urlread('https://www.ndbc.noaa.gov/to_station.shtml');</span>

<span class="token comment">%-------------------------------------------------------------------</span>
<span class="token comment">%  ps1：webread运行失败，直接去网页复制源代码所有内容，简单粘贴赋值给一个变量是不能的，另外，对于大量网页也是不可行的；</span>
<span class="token comment">%  ps2：webread运行失败可能的报错：未建立与 "https://www.ndbc.noaa.gov/to_station.shtml" 的安全连接，因为 "schannel: failed to receive handshake, SSL/TLS connection failed"。请检查您的系统证书是否过期、丢失或无效。</span>
<span class="token comment">%       webread运行失败可能的报错：无法建立与 "www.ndbc.noaa.gov" 的安全连接。原因是 ""。请检查您的证书文件(D:\Program Files (x86)\MATLAB\R2017b\sys\certificates\ca\rootcerts.pem)中的证书是否已过期、丢失或无效。</span>
<span class="token comment">%       webread运行失败可能的报错：无法建立与 "https://www.ndbc.noaa.gov/to_station.shtml" 的安全连接。原因是 "schannel: failed to receive handshake, SSL/TLS connection failed"。可能服务器不接受 HTTPS 连接。</span>
<span class="token comment">%  ps3：本人遇到的情况，matlab 2020a webread运行失败， matlab 2017b 运行成功，但是第二天早上运行2017b又失败了；</span>
<span class="token comment">%                       matlab 2020a，导入证书后成功，但是过一会儿又失败了；</span>
<span class="token comment">%                       matlab 2020a，导入证书，关闭clash代理后，成功；（希望别过一会儿又失败了）</span>
<span class="token comment">%       不知道为什么 ndbc 总是时不时的在抽风，有时候网页登不上去，不知道是不是自己网络的问题；</span>
<span class="token comment">%-------------------------------------------------------------------</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'ndbc webread 能正常运行。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
table_station <span class="token operator">=</span> table<span class="token punctuation">;</span> <span class="token comment">%table类型；</span>

<span class="token comment">%% Text Analytics Toolbox 提取所有浮标ID（需要下载 Text Analytics Toolbox，下载时也需要关闭clash代理）</span>
hT <span class="token operator">=</span> <span class="token function">htmlTree</span><span class="token punctuation">(</span>station_list_pagesource<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%解析网页源代码</span>
<span class="token comment">%-------------------------------------------------------------------</span>
<span class="token comment">%  ps1：help htmlTree，2020版本有提示：'htmlTree' 需要 Text Analytics Toolbox。</span>
<span class="token comment">%                      2017没有提示；</span>
<span class="token comment">%-------------------------------------------------------------------</span>

<span class="token comment">% 在浏览器的网页中，观察源代码，发现所有浮标ID都在 &lt;a&gt;&lt;/a&gt; 标签里，</span>
<span class="token comment">% 且标签中的 href 都有h"station_page.php?station=" 部分；</span>
A_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>hT<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取页面中所有a标签；</span>
A_label_href <span class="token operator">=</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span>A_label<span class="token punctuation">,</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取所有a标签的href内容；</span>
A_label_needed <span class="token operator">=</span> <span class="token function">A_label</span><span class="token punctuation">(</span><span class="token function">contains</span><span class="token punctuation">(</span>A_label_href<span class="token punctuation">,</span><span class="token string">'station_page.php?station='</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取包含浮标ID的所有a标签</span>
<span class="token comment">%A_label_needed(171)</span>
<span class="token comment">%extractHTMLText(A_label_needed(171))</span>
station_ID <span class="token operator">=</span> <span class="token function">extractHTMLText</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取所有浮标的ID；</span>


<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取所有浮标ID成功。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
save station_ID station_ID
table_station<span class="token punctuation">.</span>station_ID <span class="token operator">=</span> station_ID<span class="token punctuation">;</span> <span class="token comment">%将浮标的ID保存到table_station的第一列；</span>

<span class="token comment">%% Text Analytics Toolbox 提取每个浮标经度、纬度，tic toc 30分钟?</span>
station_lon <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
station_lat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
warning_station <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>table_station<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">% table_station 与 A_label_needed 站点ID一一顺序对应，不对应，输出错误；</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">==</span><span class="token function">extractHTMLText</span><span class="token punctuation">(</span><span class="token function">A_label_needed</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">% 获取网页的b标签内容</span>
        href <span class="token operator">=</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token function">A_label_needed</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%得到指定浮标的href</span>
        url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/'</span><span class="token operator">+</span> href<span class="token punctuation">;</span>
        pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%html</span>
        
        hT <span class="token operator">=</span> <span class="token function">htmlTree</span><span class="token punctuation">(</span>pagesource<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%htmlTree</span>
        B_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>hT<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%b label</span>
        B_text <span class="token operator">=</span> <span class="token function">extractHTMLText</span><span class="token punctuation">(</span>B_label<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% b label text</span>
        
        <span class="token comment">% 从b标签内容筛选出lat和lon</span>
        text0 <span class="token operator">=</span> <span class="token function">B_text</span><span class="token punctuation">(</span> <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">'°'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
            <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">'('</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
            <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">')'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
            <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% str,contains,?   % 例如显示为 "30.517 N 152.127 E (30°31'2" N 152°7'38" E)"</span>
        <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>text0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">~=</span><span class="token number">1</span>
            <span class="token function">warning</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'经纬度提取失败，text0的维度不为1,为'</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>text0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'。（大于1时很可能报错。）'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            warning_station <span class="token operator">=</span> <span class="token punctuation">[</span>warning_station<span class="token punctuation">;</span><span class="token punctuation">{</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
            lat <span class="token operator">=</span> nan<span class="token punctuation">;</span>
            lon <span class="token operator">=</span> nan<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            text0 <span class="token operator">=</span> <span class="token function">char</span><span class="token punctuation">(</span>text0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%单引号 char, 双引号 string ：https://blog.csdn.net/weixin_43793141/article/details/105084788</span>
            temp <span class="token operator">=</span> <span class="token function">strfind</span><span class="token punctuation">(</span>text0<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%text 中空格的位置</span>
            lat <span class="token operator">=</span> <span class="token function">text0</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% char索引得到lat字符串</span>
            lon <span class="token operator">=</span> <span class="token function">text0</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取'</span><span class="token operator">+</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'浮标经度、纬度成功。'</span><span class="token operator">+</span><span class="token string">'i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token comment">% 加到station_lon，station_lat</span>
        station_lat <span class="token operator">=</span> <span class="token punctuation">[</span>station_lat<span class="token punctuation">;</span><span class="token punctuation">{</span>lat<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% 以cell形式存储，加了{}</span>
        station_lon <span class="token operator">=</span> <span class="token punctuation">[</span>station_lon<span class="token punctuation">;</span><span class="token punctuation">{</span>lon<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        
        
    <span class="token keyword">else</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取'</span><span class="token operator">+</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'浮标经度、纬度时出错。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取每个浮标经度、纬度完成。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
save station_lat station_lat
save station_lon station_lon
table_station<span class="token punctuation">.</span>station_lat <span class="token operator">=</span> station_lat<span class="token punctuation">;</span> 
table_station<span class="token punctuation">.</span>station_lon <span class="token operator">=</span> station_lon<span class="token punctuation">;</span> 

<span class="token comment">%% Text Analytics Toolbox 提取 Standard Meterological 历史数据年份信息</span>
station_historyYear <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
warning_station <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/historical_data.shtml'</span><span class="token punctuation">;</span>
pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> 
hT <span class="token operator">=</span> <span class="token function">htmlTree</span><span class="token punctuation">(</span>pagesource<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%htmlTree</span>
LI_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>hT<span class="token punctuation">,</span><span class="token string">'li'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% li label, LI_label(13)</span>
LI_label_needed <span class="token operator">=</span> <span class="token function">LI_label</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 包含 Standard Meterological 的li label</span>
A_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>LI_label_needed<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%a label</span>
A_label_href <span class="token operator">=</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span>A_label<span class="token punctuation">,</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取所有a标签的href内容；</span>

<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>table_station<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'/download_data.php?filename='</span><span class="token punctuation">,</span><span class="token function">lower</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%选择标准</span>
    A_label_needed <span class="token operator">=</span> <span class="token function">A_label</span><span class="token punctuation">(</span><span class="token function">contains</span><span class="token punctuation">(</span>A_label_href<span class="token punctuation">,</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span>
        historyYear <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">extractHTMLText</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">)</span><span class="token operator">'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取'</span><span class="token operator">+</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'的 Standard Meterological 历史数据年份信息成功。'</span><span class="token operator">+</span><span class="token string">'i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token function">warning</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'的 Standard Meterological 历史数据年份信息提取失败，historyYear的维度不大于0,为'</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        warning_station <span class="token operator">=</span> <span class="token punctuation">[</span>warning_station<span class="token punctuation">;</span><span class="token punctuation">{</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
        historyYear <span class="token operator">=</span> nan<span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    station_historyYear <span class="token operator">=</span> <span class="token punctuation">[</span>station_historyYear<span class="token punctuation">;</span><span class="token punctuation">{</span>historyYear<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取 Standard Meterological 历史数据年份信息完成。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
save station_historyYear station_historyYear
table_station<span class="token punctuation">.</span>station__historyYear_SM <span class="token operator">=</span> station_historyYear<span class="token punctuation">;</span> 

<span class="token comment">%% ndbc_station_info</span>
ndbc_station_info <span class="token operator">=</span> table_station<span class="token punctuation">;</span>
save ndbc_station_info ndbc_station_info<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>ndbc_station_info</code>：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220213134031.png"></p>
<h4 id="如何查看火狐浏览器的useragent"><a href="#如何查看火狐浏览器的useragent" class="headerlink" title="如何查看火狐浏览器的useragent"></a>如何查看火狐浏览器的useragent</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39892788/article/details/89875983">https://blog.csdn.net/weixin_39892788/article/details/89875983</a></p>
</blockquote>
<ol>
<li><p>打开火狐浏览器的任意一个网站，如： <a target="_blank" rel="noopener" href="https://blog.csdn.net/">https://blog.csdn.net/</a></p>
</li>
<li><p>按F12，点击<code>网络</code>，再<strong>重新刷新</strong>载入页面；（一定要重新刷新）</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212125654.png"></p>
</li>
<li><p>点击下图任意一行；</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212125736.png" alt=" " style="zoom:80%;"></li>
<li><p>如图所示，如果不能复制User-Agent，点击<code>原始头</code>；</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212125840.png"></p>
</li>
</ol>
<h4 id="如何为MATLAB配置ndbc的-HTTPS-servers的证书（Certificate）？"><a href="#如何为MATLAB配置ndbc的-HTTPS-servers的证书（Certificate）？" class="headerlink" title="如何为MATLAB配置ndbc的 HTTPS servers的证书（Certificate）？"></a>如何为MATLAB配置ndbc的 HTTPS servers的证书（Certificate）？</h4><blockquote>
<pre><code>% 本网页上面出现的一个标题：How can I configure MATLAB to allow access to self-signed HTTPS servers?
%    看Chirag Patel，2017-3-9这个人的回答；
</code></pre>
</blockquote>
<ol>
<li><p>Go to Google Chrome: Access same URL: Download Certificate (call it <code>ndbc.cer</code>)</p>
<p>Open Google Chrome. Click on Three Dots on Right-Top Most Corner, Select More Tools/Developer Tools –&gt; Go to Security Tab –&gt; Select View Certificate –&gt; Go to Details Tab –&gt; Click on Copy to File.</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212131402.png"></p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212131528.png" style="zoom:50%;">

<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212131607.png" style="zoom:50%;">

<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212131720.png" style="zoom:50%;"></li>
<li><p> Download <code>importcert.m</code> ：</p>
</li>
</ol>
<blockquote>
<p>我是在<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/matlabcentral/answers/92506-how-can-i-configure-matlab-to-allow-access-to-self-signed-https-servers%E4%B8%8B%E8%BD%BD%E7%9A%84%E6%AD%A4%E6%96%87%E4%BB%B6%EF%BC%9A">https://ww2.mathworks.cn/matlabcentral/answers/92506-how-can-i-configure-matlab-to-allow-access-to-self-signed-https-servers下载的此文件：</a></p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212132127.png" alt=" " style="zoom:50%;">
</blockquote>
   <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token function">importcert</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nargin <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token comment">% If no certificate specified show open file dialog to select</span>
        <span class="token punctuation">[</span>filename<span class="token punctuation">,</span>path<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">uigetfile</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'*.cer;*.crt'</span><span class="token punctuation">,</span><span class="token string">'Certificates (*.cer,*.crt)'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'Select Certificate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>filename<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">return</span><span class="token punctuation">,</span> <span class="token keyword">end</span>
        filename <span class="token operator">=</span> <span class="token function">fullfile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token comment">% Determine Java keytool location and cacerts location</span>
    keytool <span class="token operator">=</span> <span class="token function">fullfile</span><span class="token punctuation">(</span>matlabroot<span class="token punctuation">,</span><span class="token string">'sys'</span><span class="token punctuation">,</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token function">computer</span><span class="token punctuation">(</span><span class="token string">'arch'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token string">'bin'</span><span class="token punctuation">,</span><span class="token string">'keytool'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cacerts <span class="token operator">=</span> <span class="token function">fullfile</span><span class="token punctuation">(</span>matlabroot<span class="token punctuation">,</span><span class="token string">'sys'</span><span class="token punctuation">,</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token function">computer</span><span class="token punctuation">(</span><span class="token string">'arch'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'jre'</span><span class="token punctuation">,</span><span class="token string">'lib'</span><span class="token punctuation">,</span><span class="token string">'security'</span><span class="token punctuation">,</span><span class="token string">'cacerts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">% Create backup of cacerts</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token function">exist</span><span class="token punctuation">(</span><span class="token punctuation">[</span>cacerts <span class="token string">'.org'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">copyfile</span><span class="token punctuation">(</span>cacerts<span class="token punctuation">,</span><span class="token punctuation">[</span>cacerts <span class="token string">'.org'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    <span class="token comment">% Construct and execute keytool</span>
    command <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string">'"%s" -import -file "%s" -keystore "%s" -storepass changeit'</span><span class="token punctuation">,</span>keytool<span class="token punctuation">,</span>filename<span class="token punctuation">,</span>cacerts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dos</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li><p>execute &gt;&gt; <code>importcert('ndbc.cer')</code></p>
<p>执行时还要输入<code>yes</code>，<code>y</code>，<code>是</code>…</p>
<p>具体忘记是哪一个了，好像是<code>y</code>…</p>
<p>一个一个尝试吧~~</p>
</li>
<li><p>Restart MATLAB;</p>
<p>一定要重启！</p>
</li>
</ol>
<h4 id="matlab-如何储存大量数据比较合理？"><a href="#matlab-如何储存大量数据比较合理？" class="headerlink" title="matlab 如何储存大量数据比较合理？"></a>matlab 如何储存大量数据比较合理？</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/46755643">https://www.zhihu.com/question/46755643</a></p>
</blockquote>
<p>第一种是：用结构体实现，比如：a.b.c.d.e=matrix1</p>
<p>第二种是：用cell实现，但是可能必须（比如占用每一cell第一行）对数据对应属性进行描述。</p>
<p>题主是不是在纠结 cell 好还是 struct 好啊，我帮你再添加一个纠结的选项吧，你可以看看新出的 table 类型，这个可能比较适合你的需求</p>
<h4 id="MATLAB如何使用table函数创建和编辑表格？"><a href="#MATLAB如何使用table函数创建和编辑表格？" class="headerlink" title="MATLAB如何使用table函数创建和编辑表格？"></a>MATLAB如何使用table函数创建和编辑表格？</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://jingyan.baidu.com/article/f25ef254b9e3b5482d1b826a.html">https://jingyan.baidu.com/article/f25ef254b9e3b5482d1b826a.html</a></p>
</blockquote>
<ol>
<li><p><strong>table(列表1,列表2,列表3…)<strong>可以创建一个表格，其中的</strong>列表n</strong>可以是数值列向量，逻辑值列向量，categorical列向量，元胞数组列向量等等。</p>
<p>每个列表组成表格中的一列。</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212203022.png"></p>
</li>
<li><p>table函数可以带有参数’**VariableNames’**以指定列名称。</p>
<p>如图，指定第一列为Gender，第二列为Age，第三列为Vote。</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212203131.png"></p>
</li>
<li><p>table函数可以带有参数**’RowNames’**以指示每一行的行名称。</p>
<p>如图，将姓名列表指定为行名称。</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212203223.png"></p>
</li>
<li><p>table函数只有这两个额外选项，但是它们可以同时使用。</p>
<p>如图，同时指定’**RowNames’<strong>和</strong>‘VariableNames’**参数。</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212203337.png"></p>
</li>
<li><p>创建表格的另一种办法，是首先使用无参数的table创建空表格，然后给空表格添加列变量。</p>
<p>如图，使用<strong>T.Name=strs1</strong>; 在列表T中创建列Name，并把列表strs1的内容赋值给该列。</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212203433.png"></p>
</li>
<li><p>给列表添加信息可以使用列表属性。</p>
<p>如图，通过<strong>T.Properties.VariableNames</strong>可以获取或<strong>设置</strong>列名称；</p>
<p>通过<strong>T.Properties.RowNames</strong>可以获取或设置行名称；</p>
<p>通过<strong>T.Properties.DimensionNames</strong>可以获取或设置维度名称。</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220212203603.png"></p>
</li>
<li><p>table表格所支持的属性值很多，除了正文中提到的，还有<strong>Description</strong>,<strong>VariableDescriptions</strong>,<strong>VariableUnits</strong>,<strong>UserData</strong></p>
</li>
</ol>
<h4 id="second-function-path-save"><a href="#second-function-path-save" class="headerlink" title="second,  function, path_save"></a>second,  function, path_save</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>ndbc_station_info<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span>
<span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>

<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-12 first verison.</span>
<span class="token comment">%    2022-02-19 second, function, path_save.</span>

<span class="token comment">%%</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'-----------------------ndbc_station_info'</span><span class="token punctuation">)</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>

<span class="token comment">%%</span>
<span class="token keyword">if</span> <span class="token function">contains</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token string">'default'</span><span class="token punctuation">)</span>
    load ndbc_station_info<span class="token punctuation">.</span>mat
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'ndbc_station_info'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'ndbc_station_info'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span>
    <span class="token comment">%% webread 正常运行</span>
    url1 <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/to_station.shtml'</span><span class="token punctuation">;</span>
    <span class="token comment">%url2 = 'http://www.ndbc.noaa.gov/to_station.shtml'; %http 和 https 的区别：https://www.zhihu.com/question/436800837</span>
    <span class="token comment">%url3 = 'https://blog.csdn.net/';</span>
    <span class="token comment">%url4 = 'https://www.ndbc.noaa.gov';</span>
    <span class="token comment">%url5 = 'http://baidu.com';</span>
    
    UserAgent <span class="token operator">=</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'</span><span class="token punctuation">;</span><span class="token comment">%如何查看火狐浏览器的useragent：https://blog.csdn.net/weixin_39892788/article/details/89875983</span>
    <span class="token comment">%UserAgent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36';</span>
    
    <span class="token comment">%options = weboptions();</span>
    <span class="token comment">%options = weboptions('UserAgent',UserAgent);</span>
    options <span class="token operator">=</span> <span class="token function">weboptions</span><span class="token punctuation">(</span><span class="token string">'UserAgent'</span><span class="token punctuation">,</span>UserAgent<span class="token punctuation">,</span><span class="token string">'Timeout'</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%针对自己的浏览器填写</span>
    <span class="token comment">% ,'CertificateFilename',''</span>
    <span class="token comment">%设置模拟浏览器：https://blog.csdn.net/qq_40845110/article/details/115215561</span>
    
    station_list_pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%读取station_list的网页源代码</span>
    <span class="token comment">%webread 和 urlread 的功能一样，[Contents Status] = urlread('https://www.ndbc.noaa.gov/to_station.shtml');</span>
    
    <span class="token comment">%-------------------------------------------------------------------</span>
    <span class="token comment">%  ps1：webread运行失败，直接去网页复制源代码所有内容，简单粘贴赋值给一个变量是不能的，另外，对于大量网页也是不可行的；</span>
    <span class="token comment">%  ps2：webread运行失败可能的报错：未建立与 "https://www.ndbc.noaa.gov/to_station.shtml" 的安全连接，因为 "schannel: failed to receive handshake, SSL/TLS connection failed"。请检查您的系统证书是否过期、丢失或无效。</span>
    <span class="token comment">%       webread运行失败可能的报错：无法建立与 "www.ndbc.noaa.gov" 的安全连接。原因是 ""。请检查您的证书文件(D:\Program Files (x86)\MATLAB\R2017b\sys\certificates\ca\rootcerts.pem)中的证书是否已过期、丢失或无效。</span>
    <span class="token comment">%       webread运行失败可能的报错：无法建立与 "https://www.ndbc.noaa.gov/to_station.shtml" 的安全连接。原因是 "schannel: failed to receive handshake, SSL/TLS connection failed"。可能服务器不接受 HTTPS 连接。</span>
    <span class="token comment">%  ps3：本人遇到的情况，matlab 2020a webread运行失败， matlab 2017b 运行成功，但是第二天早上运行2017b又失败了；</span>
    <span class="token comment">%                       matlab 2020a，导入证书后成功，但是过一会儿又失败了；</span>
    <span class="token comment">%                       matlab 2020a，导入证书，关闭clash代理后，成功；（希望别过一会儿又失败了）</span>
    <span class="token comment">%       不知道为什么 ndbc 总是时不时的在抽风，有时候网页登不上去，不知道是不是自己网络的问题；</span>
    <span class="token comment">%-------------------------------------------------------------------</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'ndbc webread 能正常运行。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    table_station <span class="token operator">=</span> table<span class="token punctuation">;</span> <span class="token comment">%table类型；</span>
    
    <span class="token comment">%% Text Analytics Toolbox 提取所有浮标ID（需要下载 Text Analytics Toolbox，下载时也需要关闭clash代理）</span>
    hT <span class="token operator">=</span> <span class="token function">htmlTree</span><span class="token punctuation">(</span>station_list_pagesource<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%解析网页源代码</span>
    <span class="token comment">%-------------------------------------------------------------------</span>
    <span class="token comment">%  ps1：help htmlTree，2020版本有提示：'htmlTree' 需要 Text Analytics Toolbox。</span>
    <span class="token comment">%                      2017没有提示；</span>
    <span class="token comment">%-------------------------------------------------------------------</span>
    
    <span class="token comment">% 在浏览器的网页中，观察源代码，发现所有浮标ID都在 &lt;a&gt;&lt;/a&gt; 标签里，</span>
    <span class="token comment">% 且标签中的 href 都有h"station_page.php?station=" 部分；</span>
    A_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>hT<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取页面中所有a标签；</span>
    A_label_href <span class="token operator">=</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span>A_label<span class="token punctuation">,</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取所有a标签的href内容；</span>
    A_label_needed <span class="token operator">=</span> <span class="token function">A_label</span><span class="token punctuation">(</span><span class="token function">contains</span><span class="token punctuation">(</span>A_label_href<span class="token punctuation">,</span><span class="token string">'station_page.php?station='</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取包含浮标ID的所有a标签</span>
    <span class="token comment">%A_label_needed(171)</span>
    <span class="token comment">%extractHTMLText(A_label_needed(171))</span>
    station_ID <span class="token operator">=</span> <span class="token function">extractHTMLText</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取所有浮标的ID；</span>
    
    
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取所有浮标ID成功。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'station_ID'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'station_ID'</span><span class="token punctuation">)</span>
    table_station<span class="token punctuation">.</span>station_ID <span class="token operator">=</span> station_ID<span class="token punctuation">;</span> <span class="token comment">%将浮标的ID保存到table_station的第一列；</span>
    
    <span class="token comment">%% Text Analytics Toolbox 提取每个浮标经度、纬度，tic toc 30分钟?</span>
    station_lon <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    station_lat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    warning_station <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>table_station<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment">% table_station 与 A_label_needed 站点ID一一顺序对应，不对应，输出错误；</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">==</span><span class="token function">extractHTMLText</span><span class="token punctuation">(</span><span class="token function">A_label_needed</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">% 获取网页的b标签内容</span>
            href <span class="token operator">=</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token function">A_label_needed</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%得到指定浮标的href</span>
            url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/'</span><span class="token operator">+</span> href<span class="token punctuation">;</span>
            pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%html</span>
            
            hT <span class="token operator">=</span> <span class="token function">htmlTree</span><span class="token punctuation">(</span>pagesource<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%htmlTree</span>
            B_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>hT<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%b label</span>
            B_text <span class="token operator">=</span> <span class="token function">extractHTMLText</span><span class="token punctuation">(</span>B_label<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% b label text</span>
            
            <span class="token comment">% 从b标签内容筛选出lat和lon</span>
            text0 <span class="token operator">=</span> <span class="token function">B_text</span><span class="token punctuation">(</span> <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">'°'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
                <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">'('</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
                <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">')'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
                <span class="token function">contains</span><span class="token punctuation">(</span>B_text<span class="token punctuation">,</span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% str,contains,?   % 例如显示为 "30.517 N 152.127 E (30°31'2" N 152°7'38" E)"</span>
            <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>text0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">~=</span><span class="token number">1</span>
                <span class="token function">warning</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'经纬度提取失败，text0的维度不为1,为'</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>text0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'。（大于1时很可能报错。）'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                warning_station <span class="token operator">=</span> <span class="token punctuation">[</span>warning_station<span class="token punctuation">;</span><span class="token punctuation">{</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
                lat <span class="token operator">=</span> nan<span class="token punctuation">;</span>
                lon <span class="token operator">=</span> nan<span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                text0 <span class="token operator">=</span> <span class="token function">char</span><span class="token punctuation">(</span>text0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%单引号 char, 双引号 string ：https://blog.csdn.net/weixin_43793141/article/details/105084788</span>
                temp <span class="token operator">=</span> <span class="token function">strfind</span><span class="token punctuation">(</span>text0<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%text 中空格的位置</span>
                lat <span class="token operator">=</span> <span class="token function">text0</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% char索引得到lat字符串</span>
                lon <span class="token operator">=</span> <span class="token function">text0</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取'</span><span class="token operator">+</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'浮标经度、纬度成功。'</span><span class="token operator">+</span><span class="token string">'i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token comment">% 加到station_lon，station_lat</span>
            station_lat <span class="token operator">=</span> <span class="token punctuation">[</span>station_lat<span class="token punctuation">;</span><span class="token punctuation">{</span>lat<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% 以cell形式存储，加了{}</span>
            station_lon <span class="token operator">=</span> <span class="token punctuation">[</span>station_lon<span class="token punctuation">;</span><span class="token punctuation">{</span>lon<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            
            
        <span class="token keyword">else</span>
            <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取'</span><span class="token operator">+</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'浮标经度、纬度时出错。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取每个浮标经度、纬度完成。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%save station_lat station_lat</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'station_lat'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'station_lat'</span><span class="token punctuation">)</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'station_lon'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'station_lon'</span><span class="token punctuation">)</span>
    <span class="token comment">%save station_lon station_lon</span>
    table_station<span class="token punctuation">.</span>station_lat <span class="token operator">=</span> station_lat<span class="token punctuation">;</span>
    table_station<span class="token punctuation">.</span>station_lon <span class="token operator">=</span> station_lon<span class="token punctuation">;</span>
    
    <span class="token comment">%% Text Analytics Toolbox 提取 Standard Meterological 历史数据年份信息</span>
    station_historyYear <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    warning_station <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/historical_data.shtml'</span><span class="token punctuation">;</span>
    pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    hT <span class="token operator">=</span> <span class="token function">htmlTree</span><span class="token punctuation">(</span>pagesource<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%htmlTree</span>
    LI_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>hT<span class="token punctuation">,</span><span class="token string">'li'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% li label, LI_label(13)</span>
    LI_label_needed <span class="token operator">=</span> <span class="token function">LI_label</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 包含 Standard Meterological 的li label</span>
    A_label <span class="token operator">=</span> <span class="token function">findElement</span><span class="token punctuation">(</span>LI_label_needed<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%a label</span>
    A_label_href <span class="token operator">=</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span>A_label<span class="token punctuation">,</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%获取所有a标签的href内容；</span>
    
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>table_station<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        temp <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'/download_data.php?filename='</span><span class="token punctuation">,</span><span class="token function">lower</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%选择标准</span>
        A_label_needed <span class="token operator">=</span> <span class="token function">A_label</span><span class="token punctuation">(</span><span class="token function">contains</span><span class="token punctuation">(</span>A_label_href<span class="token punctuation">,</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span>
            historyYear <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">extractHTMLText</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">)</span><span class="token operator">'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取'</span><span class="token operator">+</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'的 Standard Meterological 历史数据年份信息成功。'</span><span class="token operator">+</span><span class="token string">'i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token function">warning</span><span class="token punctuation">(</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token string">'的 Standard Meterological 历史数据年份信息提取失败，historyYear的维度不大于0,为'</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>A_label_needed<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            warning_station <span class="token operator">=</span> <span class="token punctuation">[</span>warning_station<span class="token punctuation">;</span><span class="token punctuation">{</span>table_station<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
            historyYear <span class="token operator">=</span> nan<span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        station_historyYear <span class="token operator">=</span> <span class="token punctuation">[</span>station_historyYear<span class="token punctuation">;</span><span class="token punctuation">{</span>historyYear<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Text Analytics Toolbox 提取 Standard Meterological 历史数据年份信息完成。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%save station_historyYear station_historyYear</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'station_historyYear'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'station_historyYear'</span><span class="token punctuation">)</span>
    table_station<span class="token punctuation">.</span>station__historyYear_SM <span class="token operator">=</span> station_historyYear<span class="token punctuation">;</span>
    
    <span class="token comment">%% ndbc_station_info</span>
    ndbc_station_info <span class="token operator">=</span> table_station<span class="token punctuation">;</span>
    <span class="token comment">%save ndbc_station_info ndbc_station_info</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'ndbc_station_info'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'ndbc_station_info'</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="ndbc-station-info-needed-m"><a href="#ndbc-station-info-needed-m" class="headerlink" title="ndbc_station_info_needed.m"></a>ndbc_station_info_needed.m</h3><p>加载<code>ndbc_station_info.mat</code>，创建包含所需NDBC浮标（or station）经纬度信息、所需数据年份信息的<code>ndbc_station_info_needed</code>变量，保存到<code>ndbc_station_info_needed.mat</code>。</p>
<p><code>ndbc_station_info_needed.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>

<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-13 first verison.</span>

clc<span class="token punctuation">,</span> clear all
load ndbc_station_info<span class="token punctuation">.</span>mat
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_info.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 区域，needed</span>
<span class="token comment">% 从gridgen.east-USA_P25.nml得到的经纬度范围</span>
lat_max <span class="token operator">=</span> <span class="token number">46</span><span class="token punctuation">;</span>  <span class="token comment">% 纬度为负数，表示南纬</span>
lat_min <span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span>
lon_max <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">58</span><span class="token punctuation">;</span> <span class="token comment">% 经度为负数，表示西经</span>
lon_min <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">75</span><span class="token punctuation">;</span>

<span class="token comment">% 将ndbc_station_info中的经纬度字符串信息转为数字，</span>
<span class="token comment">% 例如</span>
<span class="token comment">% '17.984 S'转换为-17.984</span>
<span class="token comment">% '17.984 W'转换为-17.984</span>
<span class="token comment">% cell类型的NaN转为数值的NaN</span>
lat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
lon <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token function">cell2mat</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%判断是否为nan</span>
    <span class="token keyword">if</span> <span class="token function">isnan</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
        lat <span class="token operator">=</span> <span class="token punctuation">[</span>lat<span class="token punctuation">;</span>nan<span class="token punctuation">]</span><span class="token punctuation">;</span>
        lon <span class="token operator">=</span> <span class="token punctuation">[</span>lon<span class="token punctuation">;</span>nan<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        temp <span class="token operator">=</span> <span class="token function">char</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%lat</span>
        <span class="token keyword">if</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'N'</span>
            lat <span class="token operator">=</span> <span class="token punctuation">[</span>lat<span class="token punctuation">;</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'S'</span>
            lat <span class="token operator">=</span> <span class="token punctuation">[</span>lat<span class="token punctuation">;</span><span class="token operator">-</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        
        temp <span class="token operator">=</span> <span class="token function">char</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%lon</span>
        <span class="token keyword">if</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'E'</span>
            lon <span class="token operator">=</span> <span class="token punctuation">[</span>lon<span class="token punctuation">;</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'W'</span>
            lon <span class="token operator">=</span> <span class="token punctuation">[</span>lon<span class="token punctuation">;</span><span class="token operator">-</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将ndbc_station_info中的经纬度字符串信息转为数字！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ndbc_station_info<span class="token punctuation">.</span>lat <span class="token operator">=</span> lat<span class="token punctuation">;</span>
ndbc_station_info<span class="token punctuation">.</span>lon <span class="token operator">=</span> lon<span class="token punctuation">;</span>


<span class="token comment">% 选取所需区域的浮标</span>
temp <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_station_info<span class="token punctuation">.</span>lat<span class="token operator">&gt;=</span>lat_min <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
    ndbc_station_info<span class="token punctuation">.</span>lat<span class="token operator">&lt;=</span>lat_max <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
    ndbc_station_info<span class="token punctuation">.</span>lon<span class="token operator">&lt;=</span>lon_max <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
    ndbc_station_info<span class="token punctuation">.</span>lon<span class="token operator">&gt;=</span>lon_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
ndbc_station_info_needed0 <span class="token operator">=</span> <span class="token function">ndbc_station_info</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将所需区域的浮标选取出来！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 年份，needed</span>
<span class="token comment">% 将所需区域浮标SM历史年份数据为nan的去除；</span>
<span class="token comment">%ndbc_station_info_needed0.station__historyYear_SM{34}</span>
temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info_needed0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span>
        <span class="token keyword">if</span> <span class="token function">isnan</span><span class="token punctuation">(</span>ndbc_station_info_needed0<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            temp <span class="token operator">=</span> <span class="token punctuation">[</span>temp<span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% nan 数据</span>
        <span class="token keyword">else</span>
            temp <span class="token operator">=</span> <span class="token punctuation">[</span>temp<span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% 单个字符串</span>
        <span class="token keyword">end</span>
    <span class="token keyword">catch</span>
        temp <span class="token operator">=</span> <span class="token punctuation">[</span>temp<span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% 多个字符串组成的string类型</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
ndbc_station_info_needed0 <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed0</span><span class="token punctuation">(</span><span class="token function">logical</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%int8</span>

<span class="token comment">%?特定年份？年份范围？</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将所需区域对应年份的浮标选取出来！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">%% save，在运行完前面的内容后，单独运行保存这一部分</span>
<span class="token comment">%不支持将 'ndbc_station_info_needed' 同时用作变量名称和脚本名称。</span>
<span class="token comment">%ndbc_station_info_needed = ndbc_station_info_needed0; </span>
<span class="token comment">%save ndbc_station_info_needed ndbc_station_info_needed</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>ndbc_station_info_needed</code>变量：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220213155046.png"></p>
<h4 id="second-function-path-save-1"><a href="#second-function-path-save-1" class="headerlink" title="second,  function, path_save"></a>second,  function, path_save</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>ndbc_station_info_needed<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">,</span>lat_max<span class="token punctuation">,</span>lat_min<span class="token punctuation">,</span>lon_max<span class="token punctuation">,</span>lon_min<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span>
<span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>

<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-13 first verison.</span>
<span class="token comment">%    2022-02-19 second, function, path_save.</span>

<span class="token comment">%clc, clear all</span>
<span class="token comment">%load ndbc_station_info.mat</span>
<span class="token comment">%disp('已加载ndbc_station_info.mat！'); pause(1);</span>

<span class="token comment">%%</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'-----------------------ndbc_station_info_needed'</span><span class="token punctuation">)</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>

<span class="token comment">%% 区域，needed</span>
<span class="token comment">% 从gridgen.east-USA_P25.nml得到的经纬度范围</span>
<span class="token comment">%lat_max = 46;  % 纬度为负数，表示南纬</span>
<span class="token comment">%lat_min = 36;</span>
<span class="token comment">%lon_max = -58; % 经度为负数，表示西经</span>
<span class="token comment">%lon_min = -75;</span>

<span class="token comment">% 将ndbc_station_info中的经纬度字符串信息转为数字，</span>
<span class="token comment">% 例如</span>
<span class="token comment">% '17.984 S'转换为-17.984</span>
<span class="token comment">% '17.984 W'转换为-17.984</span>
<span class="token comment">% cell类型的NaN转为数值的NaN</span>
lat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
lon <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token function">cell2mat</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%判断是否为nan</span>
    <span class="token keyword">if</span> <span class="token function">isnan</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
        lat <span class="token operator">=</span> <span class="token punctuation">[</span>lat<span class="token punctuation">;</span>nan<span class="token punctuation">]</span><span class="token punctuation">;</span>
        lon <span class="token operator">=</span> <span class="token punctuation">[</span>lon<span class="token punctuation">;</span>nan<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        temp <span class="token operator">=</span> <span class="token function">char</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%lat</span>
        <span class="token keyword">if</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'N'</span>
            lat <span class="token operator">=</span> <span class="token punctuation">[</span>lat<span class="token punctuation">;</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'S'</span>
            lat <span class="token operator">=</span> <span class="token punctuation">[</span>lat<span class="token punctuation">;</span><span class="token operator">-</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        
        temp <span class="token operator">=</span> <span class="token function">char</span><span class="token punctuation">(</span>ndbc_station_info<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%lon</span>
        <span class="token keyword">if</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'E'</span>
            lon <span class="token operator">=</span> <span class="token punctuation">[</span>lon<span class="token punctuation">;</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'W'</span>
            lon <span class="token operator">=</span> <span class="token punctuation">[</span>lon<span class="token punctuation">;</span><span class="token operator">-</span><span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将ndbc_station_info中的经纬度字符串信息转为数字！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ndbc_station_info<span class="token punctuation">.</span>lat <span class="token operator">=</span> lat<span class="token punctuation">;</span>
ndbc_station_info<span class="token punctuation">.</span>lon <span class="token operator">=</span> lon<span class="token punctuation">;</span>


<span class="token comment">% 选取所需区域的浮标</span>
temp <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_station_info<span class="token punctuation">.</span>lat<span class="token operator">&gt;=</span>lat_min <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
    ndbc_station_info<span class="token punctuation">.</span>lat<span class="token operator">&lt;=</span>lat_max <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
    ndbc_station_info<span class="token punctuation">.</span>lon<span class="token operator">&lt;=</span>lon_max <span class="token operator">&amp;</span> <span class="token punctuation">...</span>
    ndbc_station_info<span class="token punctuation">.</span>lon<span class="token operator">&gt;=</span>lon_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
ndbc_station_info_needed0 <span class="token operator">=</span> <span class="token function">ndbc_station_info</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将所需区域的浮标选取出来！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 年份，needed</span>
<span class="token comment">% 将所需区域浮标SM历史年份数据为nan的去除；</span>
<span class="token comment">%ndbc_station_info_needed0.station__historyYear_SM{34}</span>
temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info_needed0<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span>
        <span class="token keyword">if</span> <span class="token function">isnan</span><span class="token punctuation">(</span>ndbc_station_info_needed0<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            temp <span class="token operator">=</span> <span class="token punctuation">[</span>temp<span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% nan 数据</span>
        <span class="token keyword">else</span>
            temp <span class="token operator">=</span> <span class="token punctuation">[</span>temp<span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% 单个字符串</span>
        <span class="token keyword">end</span>
    <span class="token keyword">catch</span>
        temp <span class="token operator">=</span> <span class="token punctuation">[</span>temp<span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% 多个字符串组成的string类型</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
ndbc_station_info_needed0 <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed0</span><span class="token punctuation">(</span><span class="token function">logical</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%int8</span>

<span class="token comment">%?特定年份？年份范围？</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将所需区域对应年份的浮标选取出来！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">%% save，在运行完前面的内容后，单独运行保存这一部分</span>
<span class="token comment">%不支持将 'ndbc_station_info_needed' 同时用作变量名称和脚本名称。</span>
ndbc_station_info_needed <span class="token operator">=</span> ndbc_station_info_needed0<span class="token punctuation">;</span> 
<span class="token comment">%save ndbc_station_info_needed ndbc_station_info_needed</span>
<span class="token function">save</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'ndbc_station_info_needed'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'ndbc_station_info_needed'</span><span class="token punctuation">)</span>

<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="ndbc-station-info-needed-plot-m"><a href="#ndbc-station-info-needed-plot-m" class="headerlink" title="ndbc_station_info_needed_plot.m"></a>ndbc_station_info_needed_plot.m</h3><p>加载<code>ndbc_station_info_needed.mat</code>，用matlab中的<a target="_blank" rel="noopener" href="https://www.eoas.ubc.ca/~rich/map.html">m_map工具包</a>对ndbc浮标进行绘图。</p>
<p>m_map工具包下载后是一个<code>m_map</code>文件夹，调用时，需要添加<code>path(path,'m_map')</code>，当然也可以将这个文件夹添加到matlab的环境中。</p>
<blockquote>
<p>m_map工具包百度网盘：</p>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1d2HEilJMh1XLItnuI3pVCw">https://pan.baidu.com/s/1d2HEilJMh1XLItnuI3pVCw</a><br>提取码：mr76 </p>
</blockquote>
<p><code>ndbc_station_info_needed_plot.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-13 first verison.</span>
<span class="token comment">%    2022-02-18 second, 添加map到ndbc_station_download_NC_analyse;</span>
%
<span class="token comment">% ps：许多 m_* 函数的应用，可以在 https://www.eoas.ubc.ca/~rich/map.html 网页，crtl+F搜索使用其的例子。</span>

clc<span class="token punctuation">,</span> clear all
load ndbc_station_info_needed<span class="token punctuation">.</span>mat
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_info_needed.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 可调参数</span>
<span class="token comment">% 区域范围信息</span>
lon1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">75</span><span class="token punctuation">;</span> <span class="token comment">%100</span>
lon2 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">58</span><span class="token punctuation">;</span> <span class="token comment">%125</span>
lat1 <span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span> <span class="token comment">%0</span>
lat2 <span class="token operator">=</span> <span class="token number">46</span><span class="token punctuation">;</span> <span class="token comment">%30</span>

<span class="token comment">% 经度和纬度显示的刻度信息</span>
xtick_lon <span class="token operator">=</span> lon1<span class="token operator">:</span><span class="token number">5</span><span class="token operator">:</span>lon2<span class="token punctuation">;</span>%
xticklabels_lon <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span>xtick_lon<span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>%
ytick_lat <span class="token operator">=</span> lat1<span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span>lat2<span class="token punctuation">;</span>
yticklabels_lat <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span>ytick_lat<span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% 水深colorbar信息</span>
water_min <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">6000</span><span class="token punctuation">;</span> <span class="token comment">%水深范围；（先用jet去试试，确定后再用blue，因为blue中的白色容易漏掉，有特别深的水深数据）</span>
etopo2_contourf <span class="token operator">=</span> <span class="token punctuation">[</span>water_min<span class="token operator">:</span><span class="token operator">-</span>water_min<span class="token operator">/</span><span class="token number">100</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% /10，/100，分母越大好像越好</span>
CM_piece_num <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span><span class="token comment">%colorbar平均分的块数</span>
CM_type <span class="token operator">=</span> <span class="token string">'blue'</span><span class="token punctuation">;</span> <span class="token comment">% jet, gland</span>
                  <span class="token comment">% CM_type 可以组合：CM = colormap([m_colmap('jet',CM_piece_num);m_colmap('gland',48)]); </span>
                  <span class="token comment">%                 自己去对应位置调；</span>
CM_Ytick <span class="token operator">=</span> <span class="token function">fliplr</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">-</span><span class="token number">1200</span>  <span class="token operator">-</span><span class="token number">2400</span> <span class="token operator">-</span><span class="token number">3600</span> <span class="token operator">-</span><span class="token number">4800</span> <span class="token operator">-</span><span class="token number">6000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%colorbar刻度信息</span>
CM_position <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.8</span> <span class="token number">0.1</span> <span class="token number">0.0288</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%colorbar位置</span>
CM_TickLength <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.01</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%colorbar刻度长</span>
               


<span class="token comment">% 浮标点的信息</span>
point_lon <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>lon<span class="token punctuation">;</span> <span class="token comment">%[108 116 119 114 116 110]';</span>
point_lat <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>lat<span class="token punctuation">;</span> <span class="token comment">%[20 21 20 17 11 14]';</span>
<span class="token comment">% point_name=['P1', 'P2', 'P3', 'P4', 'P5'];</span>
<span class="token comment">%point_name={'P1', 'P2', 'P3', 'P4', 'P5', 'P6'};</span>
<span class="token comment">%buoy_name={'1','2','3','4','5','6','7','8','9'};</span>


<span class="token comment">%% m_map</span>
F1 <span class="token operator">=</span> <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">path</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token string">'m_map'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% m_proj：投影</span>
<span class="token function">m_proj</span><span class="token punctuation">(</span><span class="token string">'Mercator'</span><span class="token punctuation">,</span><span class="token string">'lon'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>lon1 lon2<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'lat'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>lat1 lat2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%%矩形</span>

<span class="token comment">% m_etopo2, m_contfbar：水深数据及其 colorbar</span>
<span class="token punctuation">[</span>CS<span class="token punctuation">,</span>CH<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">m_etopo2</span><span class="token punctuation">(</span><span class="token string">'contourf'</span><span class="token punctuation">,</span>etopo2_contourf<span class="token punctuation">,</span><span class="token string">'edgecolor'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>ax<span class="token punctuation">,</span>h<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">m_contfbar</span><span class="token punctuation">(</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>CS<span class="token punctuation">,</span>CH<span class="token punctuation">,</span><span class="token string">'endpiece'</span><span class="token punctuation">,</span><span class="token string">'no'</span><span class="token punctuation">,</span><span class="token string">'axfrac'</span><span class="token punctuation">,</span><span class="token number">.05</span><span class="token punctuation">,</span><span class="token string">'edgecolor'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% m_plot, m_text ：画点及标出名称</span>
hold on
<span class="token keyword">for</span> ii<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>point_lon<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'ro'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">5.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hold on
    <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hold on
<span class="token keyword">end</span>




<span class="token comment">% m_gshhs_*：海岸线数据</span>
<span class="token comment">%m_coast('patch',[.6 .6 .7]);</span>
<span class="token comment">% m_gshhs_c('patch',[.7 .7 .7]);</span>
<span class="token comment">%m_gshhs_l('patch',[.5 .5 .5]);</span>
<span class="token function">m_gshhs_i</span><span class="token punctuation">(</span><span class="token string">'patch'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">.7</span> <span class="token number">.7</span> <span class="token number">.7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%m_gshhs_f('patch',[.7 .7 .7]); %full</span>


<span class="token comment">% m_grid：网格</span>
<span class="token function">m_grid</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span><span class="token string">'fancy'</span><span class="token punctuation">,</span><span class="token string">'tickdir'</span><span class="token punctuation">,</span><span class="token string">'in'</span><span class="token punctuation">,</span><span class="token string">'tickstyle'</span><span class="token punctuation">,</span><span class="token string">'dm'</span><span class="token punctuation">,</span><span class="token string">'xtick'</span><span class="token punctuation">,</span>xtick_lon<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'xticklabels'</span><span class="token punctuation">,</span>xticklabels_lon<span class="token punctuation">,</span><span class="token string">'ytick'</span><span class="token punctuation">,</span>ytick_lat<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'yticklabels'</span><span class="token punctuation">,</span>yticklabels_lat<span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'linestyle'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
XL1 <span class="token operator">=</span> <span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Longitude(°E)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
YL1 <span class="token operator">=</span> <span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Latitude(°N)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% colorbar的设置</span>
<span class="token comment">% figure 背景为白色</span>
<span class="token function">set</span><span class="token punctuation">(</span>gcf<span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">% otherwise 'print' turns lakes black</span>

<span class="token comment">% 水深colorbar信息</span>
CM <span class="token operator">=</span> <span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">m_colmap</span><span class="token punctuation">(</span>CM_type<span class="token punctuation">,</span>CM_piece_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% CM = colormap([m_colmap('jet',CM_piece_num);m_colmap('gland',48)]); %colormap选取</span>

<span class="token function">set</span><span class="token punctuation">(</span>ax<span class="token punctuation">.</span>YLabel<span class="token punctuation">,</span><span class="token string">'string'</span><span class="token punctuation">,</span><span class="token string">'Water Depth (m)'</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%colorbar对应的名称</span>
<span class="token function">set</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span><span class="token string">'position'</span><span class="token punctuation">,</span>CM_position<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'Ytick'</span><span class="token punctuation">,</span>CM_Ytick<span class="token punctuation">,</span><span class="token punctuation">...</span><span class="token comment">%'Yticklabel',{'0';'600';'1200';'1800';'2400';'3000';'3600';'4200';'4800';'5400';'6000'},...</span>
    <span class="token string">'YTickLabelMode'</span><span class="token punctuation">,</span><span class="token string">'auto'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'TickLength'</span><span class="token punctuation">,</span>CM_TickLength<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'Ydir'</span><span class="token punctuation">,</span><span class="token string">'reverse'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%colorbar位置，刻度</span>


<span class="token comment">%% 添加map到ndbc_station_download_NC_analyse</span>
<span class="token comment">%load ndbc_station_download_NC_analyse</span>
<span class="token comment">%savefig(F1,strcat('.\fig\区域ndbc浮标图','.fig'));</span>
<span class="token comment">%ndbc_station_download_NC_analyse.BuoyPointsMap{1,1} = strcat('openfig(".\fig\区域ndbc浮标图','.fig")');</span>
<span class="token comment">%close(F1)</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行得到的图形（还需要调整参数才能更好看，这里就粗略咯）：</p>
<blockquote>
<p>可以根据标号确定索引，选择想要点的浮标；</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220213202735.png"></p>
<h4 id="南海论文中浮标的图"><a href="#南海论文中浮标的图" class="headerlink" title="南海论文中浮标的图"></a>南海论文中浮标的图</h4><p><code>Step0_plot_quyu_buoy.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">%%%%画图</span>
clc<span class="token punctuation">,</span>clear all

<span class="token comment">%% 参数</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    lon1<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
    lon2<span class="token operator">=</span><span class="token number">125</span><span class="token punctuation">;</span>
    lat1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    lat2<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span>
    
    point_lon<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">108</span> <span class="token number">116</span> <span class="token number">119</span> <span class="token number">114</span> <span class="token number">116</span> <span class="token number">110</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">;</span>
    point_lat<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">20</span> <span class="token number">21</span> <span class="token number">20</span> <span class="token number">17</span> <span class="token number">11</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">;</span>
    <span class="token comment">% point_name=['P1', 'P2', 'P3', 'P4', 'P5'];</span>
    point_name<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'P1'</span><span class="token punctuation">,</span> <span class="token string">'P2'</span><span class="token punctuation">,</span> <span class="token string">'P3'</span><span class="token punctuation">,</span> <span class="token string">'P4'</span><span class="token punctuation">,</span> <span class="token string">'P5'</span><span class="token punctuation">,</span> <span class="token string">'P6'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_name<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'5'</span><span class="token punctuation">,</span><span class="token string">'6'</span><span class="token punctuation">,</span><span class="token string">'7'</span><span class="token punctuation">,</span><span class="token string">'8'</span><span class="token punctuation">,</span><span class="token string">'9'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span>
<span class="token keyword">end</span>

<span class="token comment">%% 句柄</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    F1 <span class="token operator">=</span> <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">path</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token string">'m_map'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">m_proj</span><span class="token punctuation">(</span><span class="token string">'Mercator'</span><span class="token punctuation">,</span><span class="token string">'lon'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>lon1 lon2<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'lat'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>lat1 lat2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%%矩形</span>
    %
    <span class="token punctuation">[</span>CS<span class="token punctuation">,</span>CH<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">m_etopo2</span><span class="token punctuation">(</span><span class="token string">'contourf'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6000</span><span class="token operator">:</span><span class="token number">200</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'edgecolor'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>ax<span class="token punctuation">,</span>h<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">m_contfbar</span><span class="token punctuation">(</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>CS<span class="token punctuation">,</span>CH<span class="token punctuation">,</span><span class="token string">'endpiece'</span><span class="token punctuation">,</span><span class="token string">'no'</span><span class="token punctuation">,</span><span class="token string">'axfrac'</span><span class="token punctuation">,</span><span class="token number">.05</span><span class="token punctuation">,</span><span class="token string">'edgecolor'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    hold on
    <span class="token keyword">for</span> ii<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span>
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'ro'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">5.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hold on
        <span class="token comment">% m_text(point_lon(ii)-0.3,point_lat(ii)-0.6,point_name(2*(ii-1)+1:2*(ii-1)+2),'fontsize',12)</span>
        point_name<span class="token punctuation">{</span>ii<span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0.7</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">,</span>point_name<span class="token punctuation">{</span>ii<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hold on
    <span class="token keyword">end</span>
    
    <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'ro'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">5.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hold on
    point_name<span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">,</span>point_name<span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hold on
    
    <span class="token comment">%m_coast('patch',[.6 .6 .7]);</span>
    <span class="token comment">% m_gshhs_c('patch',[.7 .7 .7]);</span>
    <span class="token comment">%m_gshhs_l('patch',[.5 .5 .5]);</span>
    <span class="token function">m_gshhs_i</span><span class="token punctuation">(</span><span class="token string">'patch'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">.7</span> <span class="token number">.7</span> <span class="token number">.7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%m_gshhs_f('patch',[.7 .7 .7]); %full</span>
    
    <span class="token function">m_grid</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span><span class="token string">'fancy'</span><span class="token punctuation">,</span><span class="token string">'tickdir'</span><span class="token punctuation">,</span><span class="token string">'in'</span><span class="token punctuation">,</span><span class="token string">'tickstyle'</span><span class="token punctuation">,</span><span class="token string">'dm'</span><span class="token punctuation">,</span><span class="token string">'xtick'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">100</span> <span class="token number">105</span> <span class="token number">110</span> <span class="token number">115</span> <span class="token number">120</span> <span class="token number">125</span> <span class="token number">130</span> <span class="token number">135</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'xticklabels'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'100'</span><span class="token punctuation">;</span><span class="token string">'105'</span><span class="token punctuation">;</span><span class="token string">'110'</span><span class="token punctuation">;</span><span class="token string">'115'</span><span class="token punctuation">;</span><span class="token string">'120'</span><span class="token punctuation">;</span><span class="token string">'125'</span><span class="token punctuation">;</span><span class="token string">'130'</span><span class="token punctuation">;</span><span class="token string">'135'</span><span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'ytick'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">5</span> <span class="token number">10</span> <span class="token number">15</span> <span class="token number">20</span> <span class="token number">25</span> <span class="token number">30</span> <span class="token number">35</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'yticklabels'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'5 '</span><span class="token punctuation">;</span> <span class="token string">'10'</span><span class="token punctuation">;</span><span class="token string">'15'</span><span class="token punctuation">;</span><span class="token string">'20'</span><span class="token punctuation">;</span><span class="token string">'25'</span><span class="token punctuation">;</span><span class="token string">'30'</span><span class="token punctuation">;</span><span class="token string">'35'</span><span class="token punctuation">;</span><span class="token string">'40'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'linestyle'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    XL1 <span class="token operator">=</span> <span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Longitude(°E)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    YL1 <span class="token operator">=</span> <span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Latitude(°N)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    %
    A<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">105</span> <span class="token number">105</span> <span class="token number">120</span> <span class="token number">120</span> <span class="token number">105</span><span class="token punctuation">;</span><span class="token number">9</span> <span class="token number">25</span> <span class="token number">25</span> <span class="token number">9</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'r-'</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    %
    point_lon<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">118.2</span>  <span class="token number">116.17</span> <span class="token number">117.34</span> <span class="token number">119</span> <span class="token number">111.53</span> <span class="token number">111.83</span>  <span class="token number">111</span> <span class="token number">117.29</span> <span class="token number">109.17</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">;</span>
    point_lat<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">23.63</span> <span class="token number">22.15</span>  <span class="token number">22.33</span>  <span class="token number">22.6</span> <span class="token number">20.73</span> <span class="token number">19.35</span> <span class="token number">18.51</span> <span class="token number">20.99</span> <span class="token number">20.5</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">;</span>
    hold on
    <span class="token keyword">try</span>
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>

        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
        
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
        
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
        
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
        
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
        
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
        
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
        
        <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%右移--加。下移--减。</span>
        <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>buoy_name<span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hold on <span class="token comment">%左移--减。上移--加。</span>
    <span class="token keyword">end</span>
    <span class="token keyword">break</span>
<span class="token keyword">end</span>

<span class="token comment">%% 调参</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">%----------------------------------------%</span>
    CM_piece_num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">%colorbar</span>
    CM <span class="token operator">=</span> <span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">m_colmap</span><span class="token punctuation">(</span><span class="token string">'blues'</span><span class="token punctuation">,</span>CM_piece_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%colormap(jet(CM_piece_num)); %colormap(m_colmap('blues')); %CM = colormap(cool(CM_piece_num));</span>
    <span class="token comment">%cmocean_deep;% cmocean__deep; % colormap(cmocean__deep(round((256/5)*(1:1:5)),:));</span>
    
    <span class="token function">set</span><span class="token punctuation">(</span>gcf<span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">% otherwise 'print' turns lakes black</span>
    <span class="token function">set</span><span class="token punctuation">(</span>ax<span class="token punctuation">.</span>YLabel<span class="token punctuation">,</span><span class="token string">'string'</span><span class="token punctuation">,</span><span class="token string">'Water Depth (m)'</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">set</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span><span class="token string">'position'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.8</span> <span class="token number">0.1</span> <span class="token number">0.0388</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'Ytick'</span><span class="token punctuation">,</span><span class="token function">fliplr</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">-</span><span class="token number">1200</span>  <span class="token operator">-</span><span class="token number">2400</span> <span class="token operator">-</span><span class="token number">3600</span> <span class="token operator">-</span><span class="token number">4800</span> <span class="token operator">-</span><span class="token number">6000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">...</span><span class="token comment">%'Yticklabel',{'0';'600';'1200';'1800';'2400';'3000';'3600';'4200';'4800';'5400';'6000'},...</span>
        <span class="token string">'YTickLabelMode'</span><span class="token punctuation">,</span><span class="token string">'auto'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'TickLength'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.01</span> <span class="token number">0.01</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'Ydir'</span><span class="token punctuation">,</span><span class="token string">'reverse'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        

    <span class="token keyword">break</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行结果：</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220213161526.png" style="zoom:60%;">

<h4 id="second-function-path-save-2"><a href="#second-function-path-save-2" class="headerlink" title="second,  function, path_save"></a>second,  function, path_save</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>ndbc_station_info_needed<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed_plot</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">,</span>lat_max<span class="token punctuation">,</span>lat_min<span class="token punctuation">,</span>lon_max<span class="token punctuation">,</span>lon_min<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span>
<span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-13 first verison.</span>
<span class="token comment">%    2022-02-19 second, function, path_save.</span>
%
<span class="token comment">% ps：许多 m_* 函数的应用，可以在 https://www.eoas.ubc.ca/~rich/map.html 网页，crtl+F搜索使用其的例子。</span>

<span class="token comment">%clc, clear all</span>
<span class="token comment">%load ndbc_station_info_needed.mat</span>
<span class="token comment">%disp('已加载ndbc_station_info_needed.mat！'); pause(1);</span>

<span class="token comment">%%</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'-----------------------ndbc_station_info_needed_plot'</span><span class="token punctuation">)</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>

<span class="token comment">%% 可调参数</span>
<span class="token comment">% 区域范围信息</span>
lon1 <span class="token operator">=</span> lon_min<span class="token punctuation">;</span> <span class="token comment">%100</span>
lon2 <span class="token operator">=</span> lon_max<span class="token punctuation">;</span> <span class="token comment">%125</span>
lat1 <span class="token operator">=</span> lat_min<span class="token punctuation">;</span> <span class="token comment">%0</span>
lat2 <span class="token operator">=</span> lat_max<span class="token punctuation">;</span> <span class="token comment">%30</span>

<span class="token comment">% 经度和纬度显示的刻度信息</span>
xtick_lon <span class="token operator">=</span> lon1<span class="token operator">:</span><span class="token number">5</span><span class="token operator">:</span>lon2<span class="token punctuation">;</span>%
xticklabels_lon <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span>xtick_lon<span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>%
ytick_lat <span class="token operator">=</span> lat1<span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span>lat2<span class="token punctuation">;</span>
yticklabels_lat <span class="token operator">=</span> <span class="token function">num2str</span><span class="token punctuation">(</span>ytick_lat<span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% 水深colorbar信息</span>
water_min <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">6000</span><span class="token punctuation">;</span> <span class="token comment">%水深范围；（先用jet去试试，确定后再用blue，因为blue中的白色容易漏掉，有特别深的水深数据）</span>
etopo2_contourf <span class="token operator">=</span> <span class="token punctuation">[</span>water_min<span class="token operator">:</span><span class="token operator">-</span>water_min<span class="token operator">/</span><span class="token number">100</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% /10，/100，分母越大好像越好</span>
CM_piece_num <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span><span class="token comment">%colorbar平均分的块数</span>
CM_type <span class="token operator">=</span> <span class="token string">'blue'</span><span class="token punctuation">;</span> <span class="token comment">% jet, gland</span>
<span class="token comment">% CM_type 可以组合：CM = colormap([m_colmap('jet',CM_piece_num);m_colmap('gland',48)]);</span>
<span class="token comment">%                 自己去对应位置调；</span>
CM_Ytick <span class="token operator">=</span> <span class="token function">fliplr</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">-</span><span class="token number">1200</span>  <span class="token operator">-</span><span class="token number">2400</span> <span class="token operator">-</span><span class="token number">3600</span> <span class="token operator">-</span><span class="token number">4800</span> <span class="token operator">-</span><span class="token number">6000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%colorbar刻度信息</span>
CM_position <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.8</span> <span class="token number">0.1</span> <span class="token number">0.0288</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%colorbar位置</span>
CM_TickLength <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.01</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%colorbar刻度长</span>



<span class="token comment">% 浮标点的信息</span>
point_lon <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>lon<span class="token punctuation">;</span> <span class="token comment">%[108 116 119 114 116 110]';</span>
point_lat <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>lat<span class="token punctuation">;</span> <span class="token comment">%[20 21 20 17 11 14]';</span>
<span class="token comment">% point_name=['P1', 'P2', 'P3', 'P4', 'P5'];</span>
<span class="token comment">%point_name={'P1', 'P2', 'P3', 'P4', 'P5', 'P6'};</span>
<span class="token comment">%buoy_name={'1','2','3','4','5','6','7','8','9'};</span>


<span class="token comment">%% m_map</span>
F1 <span class="token operator">=</span> <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% m_map</span>
<span class="token comment">%cd(path_save);</span>
<span class="token comment">%cd('..'); % 跳到上一级路径下</span>
<span class="token comment">%path(path,'\m_map');</span>
<span class="token comment">%cd(path_save) % 返回之前的路径</span>


<span class="token comment">% m_proj：投影</span>
<span class="token function">m_proj</span><span class="token punctuation">(</span><span class="token string">'Mercator'</span><span class="token punctuation">,</span><span class="token string">'lon'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>lon1 lon2<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'lat'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>lat1 lat2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%%矩形</span>

<span class="token comment">% m_etopo2, m_contfbar：水深数据及其 colorbar</span>
<span class="token punctuation">[</span>CS<span class="token punctuation">,</span>CH<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">m_etopo2</span><span class="token punctuation">(</span><span class="token string">'contourf'</span><span class="token punctuation">,</span>etopo2_contourf<span class="token punctuation">,</span><span class="token string">'edgecolor'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>ax<span class="token punctuation">,</span>h<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">m_contfbar</span><span class="token punctuation">(</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>CS<span class="token punctuation">,</span>CH<span class="token punctuation">,</span><span class="token string">'endpiece'</span><span class="token punctuation">,</span><span class="token string">'no'</span><span class="token punctuation">,</span><span class="token string">'axfrac'</span><span class="token punctuation">,</span><span class="token number">.05</span><span class="token punctuation">,</span><span class="token string">'edgecolor'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% m_plot, m_text ：画点及标出名称</span>
hold on
<span class="token keyword">for</span> ii<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>point_lon<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">m_plot</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'ro'</span><span class="token punctuation">,</span><span class="token string">'MarkerEdgeColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'MarkerFaceColor'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">5.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hold on
    <span class="token function">m_text</span><span class="token punctuation">(</span><span class="token function">point_lon</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">point_lat</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hold on
<span class="token keyword">end</span>




<span class="token comment">% m_gshhs_*：海岸线数据</span>
<span class="token comment">%m_coast('patch',[.6 .6 .7]);</span>
<span class="token comment">% m_gshhs_c('patch',[.7 .7 .7]);</span>
<span class="token comment">%m_gshhs_l('patch',[.5 .5 .5]);</span>
<span class="token function">m_gshhs_i</span><span class="token punctuation">(</span><span class="token string">'patch'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">.7</span> <span class="token number">.7</span> <span class="token number">.7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%m_gshhs_f('patch',[.7 .7 .7]); %full</span>


<span class="token comment">% m_grid：网格</span>
<span class="token function">m_grid</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span><span class="token string">'fancy'</span><span class="token punctuation">,</span><span class="token string">'tickdir'</span><span class="token punctuation">,</span><span class="token string">'in'</span><span class="token punctuation">,</span><span class="token string">'tickstyle'</span><span class="token punctuation">,</span><span class="token string">'dm'</span><span class="token punctuation">,</span><span class="token string">'xtick'</span><span class="token punctuation">,</span>xtick_lon<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'xticklabels'</span><span class="token punctuation">,</span>xticklabels_lon<span class="token punctuation">,</span><span class="token string">'ytick'</span><span class="token punctuation">,</span>ytick_lat<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'yticklabels'</span><span class="token punctuation">,</span>yticklabels_lat<span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'linestyle'</span><span class="token punctuation">,</span><span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
XL1 <span class="token operator">=</span> <span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Longitude(°E)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
YL1 <span class="token operator">=</span> <span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Latitude(°N)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% colorbar的设置</span>
<span class="token comment">% figure 背景为白色</span>
<span class="token function">set</span><span class="token punctuation">(</span>gcf<span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">% otherwise 'print' turns lakes black</span>

<span class="token comment">% 水深colorbar信息</span>
CM <span class="token operator">=</span> <span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">m_colmap</span><span class="token punctuation">(</span>CM_type<span class="token punctuation">,</span>CM_piece_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% CM = colormap([m_colmap('jet',CM_piece_num);m_colmap('gland',48)]); %colormap选取</span>

<span class="token function">set</span><span class="token punctuation">(</span>ax<span class="token punctuation">.</span>YLabel<span class="token punctuation">,</span><span class="token string">'string'</span><span class="token punctuation">,</span><span class="token string">'Water Depth (m)'</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%colorbar对应的名称</span>
<span class="token function">set</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span><span class="token string">'position'</span><span class="token punctuation">,</span>CM_position<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'Ytick'</span><span class="token punctuation">,</span>CM_Ytick<span class="token punctuation">,</span><span class="token punctuation">...</span><span class="token comment">%'Yticklabel',{'0';'600';'1200';'1800';'2400';'3000';'3600';'4200';'4800';'5400';'6000'},...</span>
    <span class="token string">'YTickLabelMode'</span><span class="token punctuation">,</span><span class="token string">'auto'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'TickLength'</span><span class="token punctuation">,</span>CM_TickLength<span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'Ydir'</span><span class="token punctuation">,</span><span class="token string">'reverse'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%colorbar位置，刻度</span>

<span class="token comment">%% 添加map到ndbc_station_download_NC_analyse</span>
<span class="token comment">%load ndbc_station_download_NC_analyse</span>
mkdir fig
<span class="token function">savefig</span><span class="token punctuation">(</span>F1<span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'fig\区域ndbc浮标图'</span><span class="token punctuation">,</span><span class="token string">'.fig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ndbc_station_info_needed<span class="token punctuation">.</span>BuoyPointsMap<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'cd(path_save); openfig(".\fig\区域ndbc浮标图'</span><span class="token punctuation">,</span><span class="token string">'.fig")'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%ndbc_station_download_NC_analyse.BuoyPointsMap{1,1} = strcat('openfig(".\fig\区域ndbc浮标图','.fig")');</span>
<span class="token function">close</span><span class="token punctuation">(</span>F1<span class="token punctuation">)</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="ndbc-station-info-needed-etopo1-m"><a href="#ndbc-station-info-needed-etopo1-m" class="headerlink" title="ndbc_station_info_needed_etopo1.m"></a>ndbc_station_info_needed_etopo1.m</h3><p>加载<code>ndbc_station_info_needed.mat</code>，获取对应浮标的<code>etopo1</code>水深数据，<code>etopo1.nc</code>位于<code>m_map\ETOPO1\</code>。</p>
<p><code>ndbc_station_info_needed_etopo1.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">clc<span class="token punctuation">,</span> clear all
load ndbc_station_info_needed<span class="token punctuation">.</span>mat
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_info_needed.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%%%%%%%%%%%  水深  %%%%%%%%%%%</span>
lon <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span><span class="token string">'m_map\ETOPO1\etopo1.nc'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lat <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span><span class="token string">'m_map\ETOPO1\etopo1.nc'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
water <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span><span class="token string">'m_map\ETOPO1\etopo1.nc'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%%%% 提取特定位置的水深 %%%%%</span>
point_lon<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">108</span> <span class="token number">116</span> <span class="token number">119</span> <span class="token number">114</span> <span class="token number">116</span> <span class="token number">110</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">;</span>
point_lat<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">20</span> <span class="token number">21</span> <span class="token number">20</span> <span class="token number">17</span> <span class="token number">11</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">;</span>
depth <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>point_lon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>point_lon<span class="token punctuation">)</span>
    a <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>lat<span class="token operator">==</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>lon<span class="token operator">==</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    c <span class="token operator">=</span> <span class="token function">water</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">depth</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="second-function-path-save-3"><a href="#second-function-path-save-3" class="headerlink" title="second,  function, path_save"></a>second,  function, path_save</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>ndbc_station_info_needed<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed_etopo1</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span>
<span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>

<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-19 second verison, function, path_save.</span>
%
<span class="token comment">% ps:</span>
<span class="token comment">%    etopo1的经度范围是0~360</span>
<span class="token comment">%    ndbc_station_info_needed的经度范围是-180~180</span>

<span class="token comment">%clc, clear all</span>
<span class="token comment">%load ndbc_station_info_needed.mat</span>
<span class="token comment">%disp('已加载ndbc_station_info_needed.mat！'); pause(1);</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'-----------------------ndbc_station_info_needed_etopo1'</span><span class="token punctuation">)</span>
<span class="token comment">%%%%%%%%%%%  水深  %%%%%%%%%%%</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>
<span class="token function">cd</span><span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span>
<span class="token comment">%ncdisp('m_map\ETOPO1\etopo1.nc')</span>
lon <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span><span class="token string">'m_map\ETOPO1\etopo1.nc'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lat <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span><span class="token string">'m_map\ETOPO1\etopo1.nc'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
water <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span><span class="token string">'m_map\ETOPO1\etopo1.nc'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%%%% 提取特定位置的水深 %%%%%</span>
<span class="token comment">% 经度范围是-180~180，变成0~360</span>
point_lon <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>lon<span class="token punctuation">;</span>
tf <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>point_lon<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">point_lon</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">point_lon</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">360</span><span class="token punctuation">;</span>
%
point_lat <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>lat<span class="token punctuation">;</span>
depth <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>point_lon<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">% 查找每个浮标对应NC文件的最近网格点经纬度（索引）</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>point_lon<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">% lat 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">lat</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">point_lat</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">% lon 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">lon</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">point_lon</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">% </span>
    c <span class="token operator">=</span> <span class="token function">water</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">depth</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
<span class="token keyword">end</span>

ndbc_station_info_needed<span class="token punctuation">.</span>etopo1 <span class="token operator">=</span> depth<span class="token punctuation">;</span>

<span class="token comment">%% 可以去 https://www.ndbc.noaa.gov/to_station.shtml 查找一些浮标的水深，验证etopo1的准确性</span>


<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="etopo1来源机构及其论文参考"><a href="#etopo1来源机构及其论文参考" class="headerlink" title="etopo1来源机构及其论文参考"></a>etopo1来源机构及其论文参考</h4><p>水深数据采用 NOAA 的地球物理数据中心(National Geophysical Data Center，NGDC)提供的 <strong>ETOPO-1 数据</strong>(<strong>Amante and Eakins,2009</strong>)。 </p>
<h3 id="ndbc-station-download-m"><a href="#ndbc-station-download-m" class="headerlink" title="ndbc_station_download.m"></a>ndbc_station_download.m</h3><p>加载<code>ndbc_station_info_needed.mat</code>，根据<code>ndbc_station_info_needed</code>变量的信息，从网页上爬取对应所需数据矩阵，并以table数据形式存储浮标的数据矩阵（<strong>一个浮标、一个table</strong>），将所有浮标的table放在<code>ndbc_station_download</code>变量，最终生成<code>ndbc_station_download.mat</code>。</p>
<blockquote>
<p>ps，保存成mat比txt所占内存更小。</p>
</blockquote>
<blockquote>
<p>存在bug，num2str()，暂时先放着~~</p>
</blockquote>
<p>网页上的一个浮标一年的数据例子：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220214221646.png"></p>
<p><code>ndbc_station_download.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-14 first verison. bug：num2str()</span>

clc<span class="token punctuation">,</span> clear all
load ndbc_station_info_needed<span class="token punctuation">.</span>mat
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_info_needed.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
UserAgent <span class="token operator">=</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'</span><span class="token punctuation">;</span><span class="token comment">%如何查看火狐浏览器的useragent：https://blog.csdn.net/weixin_39892788/article/details/89875983</span>
options <span class="token operator">=</span> <span class="token function">weboptions</span><span class="token punctuation">(</span><span class="token string">'UserAgent'</span><span class="token punctuation">,</span>UserAgent<span class="token punctuation">,</span><span class="token string">'Timeout'</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%针对自己的浏览器填写</span>

<span class="token comment">%% 提取浮标的 Standard Meterological 历史数据</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token number">5</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token comment">%1:1:size(ndbc_station_info_needed,1) %浮标循环</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'---------------------------------------------'</span><span class="token punctuation">)</span>
    <span class="token comment">% 确定存储浮标历史数据的数据结构：table</span>
    buoy_table <span class="token operator">=</span> table<span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>YY<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>MM<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>DD<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>hh<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>mm<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>WDIR<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>WSPD<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>GST<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>WVHT<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>DPD<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>APD<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>MWD<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>PRES<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>ATMP<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>WTMP<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>DEWP<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>VIS<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>TIDE<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableUnits <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'yr'</span> <span class="token string">'mo'</span> <span class="token string">'dy'</span> <span class="token string">'hr'</span> <span class="token string">'mn'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'m'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_table<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableDescriptions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'年'</span> <span class="token string">'月'</span> <span class="token string">'日'</span> <span class="token string">'小时'</span> <span class="token string">'分钟'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'有效波高'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token comment">% 记录导入失败的浮标</span>
    buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">% 获取table中各项所需数据 18：YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
    count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">%输入数据进入table时,需要的索引；</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">%历史数据年份循环,[1 19]</span>
        <span class="token comment">% 获取浮标某年的网页数据；</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{12,1},2)</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{17,1},2)</span>
        temp <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        nian <span class="token operator">=</span> temp<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/view_text_file.php?filename='</span><span class="token operator">+</span><span class="token punctuation">...</span>
            <span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span><span class="token punctuation">...</span>
            nian<span class="token operator">+</span><span class="token string">'.txt.gz&amp;dir=data/historical/stdmet/'</span><span class="token punctuation">;</span>
        <span class="token comment">%url = 'https://www.ndbc.noaa.gov/view_text_file.php?filename=41002h1976.txt.gz&amp;dir=data/historical/stdmet/';</span>
        pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%pagesource(1:100)</span>
        <span class="token comment">%temp=find(isstrprop(pagesource(1:200),'digit')==1);pagesource(1:temp(1));</span>
        
        <span class="token comment">% 获取 pagesource 第一次出现数字的索引，从而通过str2num()得到数据矩阵</span>
        temp <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">isstrprop</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'digit'</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%数据中出现数字的索引；</span>
        <span class="token punctuation">[</span>data<span class="token punctuation">,</span>tf<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%网页上得到的一年的数据，后面会对其列数进行验证。</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):166));  %1</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):167));  %0</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):246)); %1</span>
        <span class="token comment">%  上面tf的变化，说明当第一行数据的列数确定后，猜测通过/enter换行？，后面的数据列数如果存在缺失，返回[]；</span>
        <span class="token comment">%  上面的规则基本保证使用str2num()是没大问题的！</span>
        
        
        <span class="token comment">% 判别网页数据格式是在哪一时间段，从而知道每一列代表什么；</span>
        <span class="token comment">% ndbc 数据不同年份的数据格式：</span>
        <span class="token comment">%          1970-1998，索引~79，16列，YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          1999，索引~81，16列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          2000-2004，索引~87，17列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2005-2006，索引~90，18列，YYYY MM DD hh mm  WD  WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2007-2020，索引179&gt;150，18列，#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%                              #yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft</span>
        
        
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token comment">%1970-1998</span>
            <span class="token comment">% YY+1900 MM DD hh （mm=0） WD   WSPD GST  WVHT  DPD   APD MWD  BAR    ATMP  WTMP  DEWP  VIS (TIDE)</span>
            <span class="token comment">% data 的改造</span>
            data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1900</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">{</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            count <span class="token operator">=</span> count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token comment">%1999</span>
            <span class="token comment">% data 的改造</span>
            data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            count <span class="token operator">=</span> count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token comment">%2000-2004</span>
            <span class="token comment">% data 的改造</span>
            data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            count <span class="token operator">=</span> count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token comment">%2005-2020</span>
            buoy_table<span class="token punctuation">{</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            count <span class="token operator">=</span> count<span class="token operator">+</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">'若tf=0，那么str2num()出现问题，导致data=[]，根本原因可能是TIDE数据有缺失空白。'</span><span class="token punctuation">)</span>
            buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_fail<span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">%44008h2000不符合一般的数据格式特点？i=5,j=19  %%TIDE 有空白</span>
            <span class="token comment">%44008h2017不符合一般的数据格式特点？i=5,j=35</span>
            <span class="token comment">%error(lower(ndbc_station_info_needed{i,1})+'h'+nian+'可能在调用str2num()时出错，因为矩阵列数不为16，不符合1970-1998的数据格式特点？。');</span>
        <span class="token keyword">end</span>
        
        
    <span class="token keyword">end</span>
    
    <span class="token comment">% 存储浮标历史数据的table保存到： ndbc_station_info_needed.station_historyData_SM{i,1}</span>
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> buoy_table<span class="token punctuation">;</span>
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> buoy_fail<span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'的table数据到ndbc_station_info_needed.station_historyData_SM！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已提取浮标的 Standard Meterological 历史数据到 ndbc_station_info_needed。'</span><span class="token punctuation">)</span>

<span class="token comment">%% save</span>
<span class="token comment">%ndbc_station_download = ndbc_station_info_needed;</span>
<span class="token comment">%save ndbc_station_download ndbc_station_download</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行生成的<code>ndbc_station_download</code>变量：（2、5、7浮标标号对应plot中的2、5、7标号，用这3个浮标进行数据分析）</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220214223552.png"></p>
<h4 id="问题得到大佬们的指点解决：str2num"><a href="#问题得到大佬们的指点解决：str2num" class="headerlink" title="问题得到大佬们的指点解决：str2num()"></a>问题得到大佬们的指点解决：str2num()</h4><blockquote>
<p>要求char中没有字母，否则返回[]；</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220213225116.png"></p>
<blockquote>
<p>数据缺失也会返回[]；</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220214220453.png"></p>
<h4 id="ndbc-数据不同年份的数据格式"><a href="#ndbc-数据不同年份的数据格式" class="headerlink" title="ndbc 数据不同年份的数据格式"></a>ndbc 数据不同年份的数据格式</h4><p>EB01: <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=eb01h1970.txt.gz&amp;dir=data/historical/stdmet/">1970</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=eb01h1971.txt.gz&amp;dir=data/historical/stdmet/">1971</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=eb01h1972.txt.gz&amp;dir=data/historical/stdmet/">1972</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=eb01h1973.txt.gz&amp;dir=data/historical/stdmet/">1973</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=eb01h1974.txt.gz&amp;dir=data/historical/stdmet/">1974</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=eb01h1975.txt.gz&amp;dir=data/historical/stdmet/">1975</a> ；</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/historical_data.shtml">https://www.ndbc.noaa.gov/historical_data.shtml</a> 的<strong>Standard Meterological</strong>中，crtl+F搜索到最早的是<code>1970</code>年；</p>
</blockquote>
<p>41002: <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1976.txt.gz&amp;dir=data/historical/stdmet/">1976</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1977.txt.gz&amp;dir=data/historical/stdmet/">1977</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1978.txt.gz&amp;dir=data/historical/stdmet/">1978</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1979.txt.gz&amp;dir=data/historical/stdmet/">1979</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1980.txt.gz&amp;dir=data/historical/stdmet/">1980</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1981.txt.gz&amp;dir=data/historical/stdmet/">1981</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1982.txt.gz&amp;dir=data/historical/stdmet/">1982</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1983.txt.gz&amp;dir=data/historical/stdmet/">1983</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1984.txt.gz&amp;dir=data/historical/stdmet/">1984</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1985.txt.gz&amp;dir=data/historical/stdmet/">1985</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1986.txt.gz&amp;dir=data/historical/stdmet/">1986</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1987.txt.gz&amp;dir=data/historical/stdmet/">1987</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1988.txt.gz&amp;dir=data/historical/stdmet/">1988</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1989.txt.gz&amp;dir=data/historical/stdmet/">1989</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1990.txt.gz&amp;dir=data/historical/stdmet/">1990</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1991.txt.gz&amp;dir=data/historical/stdmet/">1991</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1992.txt.gz&amp;dir=data/historical/stdmet/">1992</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1993.txt.gz&amp;dir=data/historical/stdmet/">1993</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1994.txt.gz&amp;dir=data/historical/stdmet/">1994</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1995.txt.gz&amp;dir=data/historical/stdmet/">1995</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1996.txt.gz&amp;dir=data/historical/stdmet/">1996</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1997.txt.gz&amp;dir=data/historical/stdmet/">1997</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1998.txt.gz&amp;dir=data/historical/stdmet/">1998</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h1999.txt.gz&amp;dir=data/historical/stdmet/">1999</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2000.txt.gz&amp;dir=data/historical/stdmet/">2000</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2001.txt.gz&amp;dir=data/historical/stdmet/">2001</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2002.txt.gz&amp;dir=data/historical/stdmet/">2002</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2003.txt.gz&amp;dir=data/historical/stdmet/">2003</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2004.txt.gz&amp;dir=data/historical/stdmet/">2004</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2005.txt.gz&amp;dir=data/historical/stdmet/">2005</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2006.txt.gz&amp;dir=data/historical/stdmet/">2006</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2007.txt.gz&amp;dir=data/historical/stdmet/">2007</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2008.txt.gz&amp;dir=data/historical/stdmet/">2008</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2010.txt.gz&amp;dir=data/historical/stdmet/">2010</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2012.txt.gz&amp;dir=data/historical/stdmet/">2012</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2013.txt.gz&amp;dir=data/historical/stdmet/">2013</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2014.txt.gz&amp;dir=data/historical/stdmet/">2014</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2015.txt.gz&amp;dir=data/historical/stdmet/">2015</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2016.txt.gz&amp;dir=data/historical/stdmet/">2016</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2017.txt.gz&amp;dir=data/historical/stdmet/">2017</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2018.txt.gz&amp;dir=data/historical/stdmet/">2018</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2019.txt.gz&amp;dir=data/historical/stdmet/">2019</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41002h2020.txt.gz&amp;dir=data/historical/stdmet/">2020</a>；</p>
<p>41009: <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2009.txt.gz&amp;dir=data/historical/stdmet/">2009</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2011.txt.gz&amp;dir=data/historical/stdmet/">2011</a>  <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2012.txt.gz&amp;dir=data/historical/stdmet/">2012</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2013.txt.gz&amp;dir=data/historical/stdmet/">2013</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2014.txt.gz&amp;dir=data/historical/stdmet/">2014</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2015.txt.gz&amp;dir=data/historical/stdmet/">2015</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2016.txt.gz&amp;dir=data/historical/stdmet/">2016</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2017.txt.gz&amp;dir=data/historical/stdmet/">2017</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2018.txt.gz&amp;dir=data/historical/stdmet/">2018</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2019.txt.gz&amp;dir=data/historical/stdmet/">2019</a> <a target="_blank" rel="noopener" href="https://www.ndbc.noaa.gov/download_data.php?filename=41009h2020.txt.gz&amp;dir=data/historical/stdmet/">2020</a>;</p>
<pre class="line-numbers language-none"><code class="language-none">YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
70 02 26 20 009 14.9 99.0 99.00 99.00 99.00 999 1012.0  00.0 999.0  00.0 99.0


YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
71 01 01 01 109 15.9 99.0 99.00 99.00 99.00 999 1000.0  12.6 999.0 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
72 01 09 19 129 10.9 99.0 99.00 99.00 99.00 999 1020.0  15.6 999.0  15.6 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
73 01 01 13 229 07.7 99.0 99.00 99.00 99.00 999 1020.0  17.6 999.0  17.6 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
74 01 25 13 050 06.1 99.0 99.00 99.00 99.00 999 1023.0  16.3 999.0  15.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
75 01 01 00 165 09.0 99.0 99.00 99.00 99.00 999 1023.5  16.0 999.0  10.6 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
76 01 01 00 197 16.6 99.0 99.00 99.00 99.00 999 1008.3  22.3  23.2 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
77 01 01 00 294 14.0 99.0 02.90 99.00 06.50 999 1005.8  19.2  21.6 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
78 01 01 00 293 06.2 99.0 02.10 99.00 06.50 999 1017.8  19.9  21.4 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
79 01 20 00 358 02.3 99.0 99.00 99.00 99.00 999 1022.9  13.0  20.6 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
80 01 01 00 281 09.9 12.6 99.00 99.00 99.00 999 1008.6  18.1  22.2 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
81 01 01 00 301 07.8 10.2 02.20 11.10 06.30 999 1009.9  16.4  22.1 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
82 01 03 15 151 07.6 09.3 01.80 09.10 05.70 999 1026.1  19.1  23.5 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
83 01 01 01 077 02.0 02.8 01.90 09.10 06.10 999 1022.8  21.4  22.0 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
84 01 01 00 357 13.9 17.9 04.70 09.10 06.70 999 1024.2  15.4  22.2 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
85 01 01 00 167 04.9 06.1 99.00 99.00 99.00 999 1026.0  23.0  24.5 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
86 03 26 18 097 09.8 12.1 02.20 08.30 05.30 999 1028.3  19.9  20.8 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
87 01 01 00 063 07.1 09.0 01.60 10.00 05.20 999 1022.3  15.7  23.5 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
88 01 01 00 144 02.6 04.6 02.20 12.50 08.80 999 1034.4  15.6  21.1 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
89 01 01 01 068 04.2 05.5 01.40 05.60 05.10 999 1020.6  21.4  23.6 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
90 03 27 21 038 09.9 12.5 02.20 07.70 05.50 999 1021.3  17.1  21.9 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
91 01 01 00 246 03.0 06.5 01.90 11.10 06.00 999 1023.3  21.3  22.8 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
92 01 01 00 083 11.4 13.9 03.40 10.00 06.70 999 1023.8  18.9  22.4 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
93 01 01 00 202 04.5 05.5 02.00 10.00 07.60 999 1021.4  21.2  21.9 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
94 01 01 00 315 03.4 05.5 01.40 10.00 05.70 999 1029.2  13.4  20.4 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
95 01 01 00 135 10.3 12.9 02.60 06.20 06.10 999 1023.8  19.9  22.2 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
96 01 01 00 163  8.6  9.9 99.00 99.00 99.00 999 1012.4  18.1  19.8 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
97 01 01 00 235  4.6  5.6  1.32  5.26  5.02 999 1018.9  20.7  20.6 999.0 99.0

YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
98 01 01 00 289 14.1 18.9  4.41 10.00  7.04 999 1018.8  14.0  21.4 999.0 99.0

YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS
1999 01 01 00 999 99.0 99.0 99.00 99.00 99.00 999 9999.0 999.0 999.0 999.0 99.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>1999年开始，YY更换为YYYY</strong>。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE
2000 01 01 00 275  5.0  5.9  1.42  6.25  5.14 999 1020.6  19.9  21.5 999.0 99.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>2000年开始，新增了TIDE，其部分数据是空白的</strong>，其他数据是否也会空白？。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE
2001 01 01 00 280  8.1 11.2  2.01  7.14  5.29 999 1020.7  11.8  21.4 999.0 99.0 99.00

YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE
2002 01 01 00 129  8.1  9.6  0.72  7.69  5.64 999 1015.1  17.7  21.8 999.0 99.0 99.00

YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE
2003 01 01 00 168 10.7 12.9  2.05  7.14  5.39 999 1020.6  22.3  22.4  16.6 99.0 99.00

YYYY MM DD hh  WD  WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE
2004 01 01 00  99  1.4  2.9  1.27  6.67  5.80 999 1026.8  19.0  23.0  10.5 99.0 99.00

YYYY MM DD hh mm  WD  WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE
2005 01 01 00 00 177  3.1  4.0  0.93 10.00  6.43 999 1030.9  19.7  21.1  13.3 99.0 99.00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>2005年开始，新增了mm</strong>。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">YYYY MM DD hh mm  WD  WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE
2006 01 01 00 00 225 11.4 13.5  1.85  6.25  4.79 999 9999.0  22.0  21.9 999.0 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC  nmi    ft
2007 01 01 00 00 119  8.0 10.4  1.25  8.33  5.19 999 1026.0  20.8  24.4  16.0 99.0 99.00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>2007年开始，WD更换为WDIR，BAR更换为PRES，增添了单位这一行</strong>。</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec deg    hPa  degC  degC  degC  nmi    ft
2008 01 01 00 00  58  3.7  5.1  1.77  6.25  5.57 999 1019.9  21.0  23.9 999.0 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2008 12 31 23 50 295  8.7 10.6  0.78  5.00  4.17 999 1016.4  22.2  24.1  14.9 99.0 99.00
2009 01 01 00 20 291 10.2 12.3  0.90  3.85  3.84 999 1016.6  22.1  24.1  14.8 99.0 99.00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>可能出现这种虽然是2009年文件，但是有2008数据；</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec deg    hPa  degC  degC  degC  nmi    ft
2010 04 19 03 50  39 10.3 13.0  2.47  9.09  5.32 999 1014.3  19.7  22.6  14.7 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2010 12 31 23 50 138  8.1  9.7  1.28  5.26  4.07 999 1022.5  21.9  22.3  14.6 99.0 99.00
2011 01 01 00 20 134  7.8  9.0  1.24  5.26  3.92 999 1022.8  22.0  22.3  14.7 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2011 12 31 23 50  67  2.2  2.8  0.38 10.00  5.15 999 1022.3  22.3  23.0  12.8 99.0 99.00
2012 01 01 00 20  82  2.3  2.9  0.40 10.00  5.37 999 1022.7  22.4  22.9  13.1 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2012 12 31 23 50 136  5.7  7.2  1.03  6.25  4.69  35 1024.5  21.0  22.4  13.5 99.0 99.00
2013 01 01 00 20 145  6.0  7.6 99.00 99.00 99.00 999 1024.4  21.1  22.4  13.1 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2013 12 31 23 50  37  6.2  7.8  1.11  5.26  4.84 336 1024.8  21.3  25.1  13.3 99.0 99.00
2014 01 01 00 20  47  6.0  8.2 99.00 99.00 99.00 999 1025.0  21.5  25.1  13.7 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2015 01 01 00 20  40  8.4 10.0 99.00 99.00 99.00 999 1023.8  21.4  24.1  16.9 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2015 12 31 23 50 153  3.0  3.7  0.90  8.33  5.54  96 1020.0  25.2  25.2  23.3 99.0 99.00
2016 01 01 00 20 161  2.6  3.1 99.00 99.00 99.00 999 1020.4  25.3  25.2  23.2 99.0 99.00

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2017 04 22 15 30 161  5.2  6.7 99.00 99.00 99.00 999 1016.2  24.4  24.0  19.9 99.0 99.00 

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2018 01 01 00 00 330  3.3  4.9 99.00 99.00 99.00 999 1020.3  18.0  24.3  13.6 99.0 99.00 

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2019 01 01 00 00 156  6.3  7.9 99.00 99.00 99.00 999 1021.7  24.3 999.0  21.7 99.0 99.00 

#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE
#yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft
2020 01 01 00 00 288  4.1  5.6 99.00 99.00 99.00 999 1017.9  18.5  25.0   8.1 99.0 99.00 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ndbc-station-download-m（第二版本-使用-datetime-数据类型-）"><a href="#ndbc-station-download-m（第二版本-使用-datetime-数据类型-）" class="headerlink" title="ndbc_station_download.m（第二版本, 使用 datetime 数据类型 ）"></a>ndbc_station_download.m（第二版本, 使用 datetime 数据类型 ）</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-14 first verison. bug：num2str()</span>
<span class="token comment">%    2022-02-15 second version. 使用 datetime 数据类型 </span>

clc<span class="token punctuation">,</span> clear all
load ndbc_station_info_needed<span class="token punctuation">.</span>mat
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_info_needed.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
UserAgent <span class="token operator">=</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'</span><span class="token punctuation">;</span><span class="token comment">%如何查看火狐浏览器的useragent：https://blog.csdn.net/weixin_39892788/article/details/89875983</span>
options <span class="token operator">=</span> <span class="token function">weboptions</span><span class="token punctuation">(</span><span class="token string">'UserAgent'</span><span class="token punctuation">,</span>UserAgent<span class="token punctuation">,</span><span class="token string">'Timeout'</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%针对自己的浏览器填写</span>

<span class="token comment">%% 提取浮标的 Standard Meterological 历史数据</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token number">5</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token comment">%1:1:size(ndbc_station_info_needed,1) %浮标循环</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'---------------------------------------------'</span><span class="token punctuation">)</span>
    <span class="token comment">% 确定存储浮标历史数据的数据结构：table</span>
    buoy_table_All <span class="token operator">=</span> table<span class="token punctuation">;</span>
 
    <span class="token comment">% 记录导入失败的浮标</span>
    buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">% 获取table中各项所需数据 18：YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">%历史数据年份循环,[1 19]</span>
        <span class="token comment">% 保存本年数据的table；</span>
        buoy_table <span class="token operator">=</span> table<span class="token punctuation">;</span>
        
        <span class="token comment">% 获取浮标某年的网页数据；</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{12,1},2)</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{17,1},2)</span>
        temp <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        nian <span class="token operator">=</span> temp<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/view_text_file.php?filename='</span><span class="token operator">+</span><span class="token punctuation">...</span>
            <span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span><span class="token punctuation">...</span>
            nian<span class="token operator">+</span><span class="token string">'.txt.gz&amp;dir=data/historical/stdmet/'</span><span class="token punctuation">;</span>
        <span class="token comment">%url = 'https://www.ndbc.noaa.gov/view_text_file.php?filename=41002h1976.txt.gz&amp;dir=data/historical/stdmet/';</span>
        pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%pagesource(1:100)</span>
        <span class="token comment">%temp=find(isstrprop(pagesource(1:200),'digit')==1);pagesource(1:temp(1));</span>
        
        <span class="token comment">% 获取 pagesource 第一次出现数字的索引，从而通过str2num()得到数据矩阵</span>
        temp <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">isstrprop</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'digit'</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%数据中出现数字的索引；</span>
        <span class="token punctuation">[</span>data<span class="token punctuation">,</span>tf<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%网页上得到的一年的数据，后面会对其列数进行验证。</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):166));  %1</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):167));  %0</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):246)); %1</span>
        <span class="token comment">%  上面tf的变化，说明当第一行数据的列数确定后，猜测通过/enter换行？，后面的数据列数如果存在缺失，返回[]；</span>
        <span class="token comment">%  上面的规则基本保证使用str2num()是没大问题的！</span>
        
        
        <span class="token comment">% 判别网页数据格式是在哪一时间段，从而知道每一列代表什么；</span>
        <span class="token comment">% ndbc 数据不同年份的数据格式：</span>
        <span class="token comment">%          1970-1998，索引~79，16列，YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          1999，索引~81，16列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          2000-2004，索引~87，17列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2005-2006，索引~90，18列，YYYY MM DD hh mm  WD  WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2007-2020，索引179&gt;150，18列，#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%                              #yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft</span>
        
        
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token comment">%1970-1998</span>
            <span class="token comment">% YY+1900 MM DD hh （mm=0） WD   WSPD GST  WVHT  DPD   APD MWD  BAR    ATMP  WTMP  DEWP  VIS (TIDE)</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1900</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token comment">%1999</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token comment">%2000-2004</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token comment">%2005-2020</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">'若tf=0，那么str2num()出现问题，导致data=[]，根本原因可能是TIDE数据有缺失空白。'</span><span class="token punctuation">)</span>
            buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_fail<span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">%44008h2000不符合一般的数据格式特点？i=5,j=19  %%TIDE 有空白</span>
            <span class="token comment">%44008h2017不符合一般的数据格式特点？i=5,j=35</span>
            <span class="token comment">%error(lower(ndbc_station_info_needed{i,1})+'h'+nian+'可能在调用str2num()时出错，因为矩阵列数不为16，不符合1970-1998的数据格式特点？。');</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span>
    
    <span class="token comment">% 存储浮标历史数据的table保存到： ndbc_station_info_needed.station_historyData_SM{i,1}</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'YY_MM_DD_hh_mm'</span> <span class="token string">'WDIR'</span> <span class="token string">'WSPD'</span> <span class="token string">'GST'</span>  <span class="token string">'WVHT'</span>   <span class="token string">'DPD'</span>   <span class="token string">'APD'</span> <span class="token string">'MWD'</span>   <span class="token string">'PRES'</span>  <span class="token string">'ATMP'</span>  <span class="token string">'WTMP'</span>  <span class="token string">'DEWP'</span>  <span class="token string">'VIS'</span>  <span class="token string">'TIDE'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableUnits <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'YY_MM_DD_hh_mm'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'m'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableDescriptions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'年月日小时分钟,秒数都默认为0，ndbc没包含此信息'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'有效波高'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> buoy_table_All<span class="token punctuation">;</span>
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> buoy_fail<span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'的table数据到ndbc_station_info_needed.station_historyData_SM！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已提取浮标的 Standard Meterological 历史数据到 ndbc_station_info_needed。'</span><span class="token punctuation">)</span>

<span class="token comment">%% save</span>
<span class="token comment">%ndbc_station_download = ndbc_station_info_needed;</span>
<span class="token comment">%save ndbc_station_download ndbc_station_download</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行得到：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220215231637.png"></p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220215231748.png"></p>
<h4 id="third-ndbc-station-download-NC-analyse"><a href="#third-ndbc-station-download-NC-analyse" class="headerlink" title="third, ndbc_station_download_NC_analyse"></a>third, ndbc_station_download_NC_analyse</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-14 first verison. bug：num2str()</span>
<span class="token comment">%    2022-02-15 second version. 使用 datetime 数据类型 </span>
<span class="token comment">%    2022-02-18 third, ndbc_station_download_NC_analyse</span>

clc<span class="token punctuation">,</span> clear all
<span class="token comment">%load ndbc_station_info_needed.mat</span>
load ndbc_station_download_NC_analyse<span class="token punctuation">.</span>mat<span class="token punctuation">;</span> ndbc_station_info_needed <span class="token operator">=</span> ndbc_station_download_NC_analyse<span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_info_needed.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
UserAgent <span class="token operator">=</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'</span><span class="token punctuation">;</span><span class="token comment">%如何查看火狐浏览器的useragent：https://blog.csdn.net/weixin_39892788/article/details/89875983</span>
options <span class="token operator">=</span> <span class="token function">weboptions</span><span class="token punctuation">(</span><span class="token string">'UserAgent'</span><span class="token punctuation">,</span>UserAgent<span class="token punctuation">,</span><span class="token string">'Timeout'</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%针对自己的浏览器填写</span>

<span class="token comment">%% 提取浮标的 Standard Meterological 历史数据</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token comment">%1:1:size(ndbc_station_info_needed,1) %浮标循环</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'---------------------------------------------'</span><span class="token punctuation">)</span>
    <span class="token comment">% 确定存储浮标历史数据的数据结构：table</span>
    buoy_table_All <span class="token operator">=</span> table<span class="token punctuation">;</span>
 
    <span class="token comment">% 记录导入失败的浮标</span>
    buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">% 获取table中各项所需数据 18：YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">%历史数据年份循环,[1 19]</span>
        <span class="token comment">% 保存本年数据的table；</span>
        buoy_table <span class="token operator">=</span> table<span class="token punctuation">;</span>
        
        <span class="token comment">% 获取浮标某年的网页数据；</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{12,1},2)</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{17,1},2)</span>
        temp <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        nian <span class="token operator">=</span> temp<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/view_text_file.php?filename='</span><span class="token operator">+</span><span class="token punctuation">...</span>
            <span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span><span class="token punctuation">...</span>
            nian<span class="token operator">+</span><span class="token string">'.txt.gz&amp;dir=data/historical/stdmet/'</span><span class="token punctuation">;</span>
        <span class="token comment">%url = 'https://www.ndbc.noaa.gov/view_text_file.php?filename=41002h1976.txt.gz&amp;dir=data/historical/stdmet/';</span>
        pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%pagesource(1:100)</span>
        <span class="token comment">%temp=find(isstrprop(pagesource(1:200),'digit')==1);pagesource(1:temp(1));</span>
        
        <span class="token comment">% 获取 pagesource 第一次出现数字的索引，从而通过str2num()得到数据矩阵</span>
        temp <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">isstrprop</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'digit'</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%数据中出现数字的索引；</span>
        <span class="token punctuation">[</span>data<span class="token punctuation">,</span>tf<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%网页上得到的一年的数据，后面会对其列数进行验证。</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):166));  %1</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):167));  %0</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):246)); %1</span>
        <span class="token comment">%  上面tf的变化，说明当第一行数据的列数确定后，猜测通过/enter换行？，后面的数据列数如果存在缺失，返回[]；</span>
        <span class="token comment">%  上面的规则基本保证使用str2num()是没大问题的！</span>
        
        
        <span class="token comment">% 判别网页数据格式是在哪一时间段，从而知道每一列代表什么；</span>
        <span class="token comment">% ndbc 数据不同年份的数据格式：</span>
        <span class="token comment">%          1970-1998，索引~79，16列，YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          1999，索引~81，16列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          2000-2004，索引~87，17列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2005-2006，索引~90，18列，YYYY MM DD hh mm  WD  WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2007-2020，索引179&gt;150，18列，#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%                              #yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft</span>
        
        
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token comment">%1970-1998</span>
            <span class="token comment">% YY+1900 MM DD hh （mm=0） WD   WSPD GST  WVHT  DPD   APD MWD  BAR    ATMP  WTMP  DEWP  VIS (TIDE)</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1900</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token comment">%1999</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token comment">%2000-2004</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token comment">%2005-2020</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">'若tf=0，那么str2num()出现问题，导致data=[]，根本原因可能是TIDE数据有缺失空白。'</span><span class="token punctuation">)</span>
            buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_fail<span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">%44008h2000不符合一般的数据格式特点？i=5,j=19  %%TIDE 有空白</span>
            <span class="token comment">%44008h2017不符合一般的数据格式特点？i=5,j=35</span>
            <span class="token comment">%error(lower(ndbc_station_info_needed{i,1})+'h'+nian+'可能在调用str2num()时出错，因为矩阵列数不为16，不符合1970-1998的数据格式特点？。');</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span>
    
    <span class="token comment">% 存储浮标历史数据的table保存到： ndbc_station_info_needed.station_historyData_SM{i,1}</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'YY_MM_DD_hh_mm'</span> <span class="token string">'WDIR'</span> <span class="token string">'WSPD'</span> <span class="token string">'GST'</span>  <span class="token string">'WVHT'</span>   <span class="token string">'DPD'</span>   <span class="token string">'APD'</span> <span class="token string">'MWD'</span>   <span class="token string">'PRES'</span>  <span class="token string">'ATMP'</span>  <span class="token string">'WTMP'</span>  <span class="token string">'DEWP'</span>  <span class="token string">'VIS'</span>  <span class="token string">'TIDE'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableUnits <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'YY_MM_DD_hh_mm'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'m'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableDescriptions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'年月日小时分钟,秒数都默认为0，ndbc没包含此信息'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'有效波高'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> buoy_table_All<span class="token punctuation">;</span>
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> buoy_fail<span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'的table数据到ndbc_station_info_needed.station_historyData_SM！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已提取浮标的 Standard Meterological 历史数据到 ndbc_station_info_needed。'</span><span class="token punctuation">)</span>

<span class="token comment">%% save</span>
<span class="token comment">%ndbc_station_download = ndbc_station_info_needed;</span>
<span class="token comment">%save ndbc_station_download ndbc_station_download</span>

<span class="token comment">%%</span>
<span class="token comment">%ndbc_station_download_NC_analyse = ndbc_station_info_needed;</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="fourth-function-path-save-图床思想"><a href="#fourth-function-path-save-图床思想" class="headerlink" title="fourth, function, path_save, 图床思想"></a>fourth, function, path_save, 图床思想</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>ndbc_station_info_needed<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span>
<span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-14 first verison. bug：num2str()</span>
<span class="token comment">%    2022-02-15 second version. 使用 datetime 数据类型 </span>
<span class="token comment">%    2022-02-18 third, ndbc_station_download_NC_analyse</span>
<span class="token comment">%    2022-02-19 fourth, function, path_save.</span>
<span class="token comment">%    2022-02-19         图床思想, work_table.station_historyData_SM</span>

<span class="token comment">%clc, clear all</span>
<span class="token comment">%load ndbc_station_info_needed.mat</span>
<span class="token comment">%load ndbc_station_download_NC_analyse.mat; ndbc_station_info_needed = ndbc_station_download_NC_analyse;</span>
<span class="token comment">%disp('已加载ndbc_station_info_needed.mat！'); pause(1);</span>

<span class="token comment">%%</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'-----------------------ndbc_station_download'</span><span class="token punctuation">)</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>
mkdir station_historyData_SM
%
UserAgent <span class="token operator">=</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'</span><span class="token punctuation">;</span><span class="token comment">%如何查看火狐浏览器的useragent：https://blog.csdn.net/weixin_39892788/article/details/89875983</span>
options <span class="token operator">=</span> <span class="token function">weboptions</span><span class="token punctuation">(</span><span class="token string">'UserAgent'</span><span class="token punctuation">,</span>UserAgent<span class="token punctuation">,</span><span class="token string">'Timeout'</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%针对自己的浏览器填写</span>

<span class="token comment">%% 提取浮标的 Standard Meterological 历史数据</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span>station_tf_download<span class="token comment">%1:1:size(ndbc_station_info_needed,1) %浮标循环</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'---------------------------------------------'</span><span class="token punctuation">)</span>
    <span class="token comment">% 确定存储浮标历史数据的数据结构：table</span>
    buoy_table_All <span class="token operator">=</span> table<span class="token punctuation">;</span>
 
    <span class="token comment">% 记录导入失败的浮标</span>
    buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">% 获取table中各项所需数据 18：YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">%历史数据年份循环,[1 19]</span>
        <span class="token comment">% 保存本年数据的table；</span>
        buoy_table <span class="token operator">=</span> table<span class="token punctuation">;</span>
        
        <span class="token comment">% 获取浮标某年的网页数据；</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{12,1},2)</span>
        <span class="token comment">%   % size(ndbc_station_info_needed.station__historyYear_SM{17,1},2)</span>
        temp <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">.</span>station__historyYear_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        nian <span class="token operator">=</span> temp<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        url <span class="token operator">=</span> <span class="token string">'https://www.ndbc.noaa.gov/view_text_file.php?filename='</span><span class="token operator">+</span><span class="token punctuation">...</span>
            <span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span><span class="token punctuation">...</span>
            nian<span class="token operator">+</span><span class="token string">'.txt.gz&amp;dir=data/historical/stdmet/'</span><span class="token punctuation">;</span>
        <span class="token comment">%url = 'https://www.ndbc.noaa.gov/view_text_file.php?filename=41002h1976.txt.gz&amp;dir=data/historical/stdmet/';</span>
        pagesource <span class="token operator">=</span> <span class="token function">webread</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%pagesource(1:100)</span>
        <span class="token comment">%temp=find(isstrprop(pagesource(1:200),'digit')==1);pagesource(1:temp(1));</span>
        
        <span class="token comment">% 获取 pagesource 第一次出现数字的索引，从而通过str2num()得到数据矩阵</span>
        temp <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">isstrprop</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'digit'</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%数据中出现数字的索引；</span>
        <span class="token punctuation">[</span>data<span class="token punctuation">,</span>tf<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%网页上得到的一年的数据，后面会对其列数进行验证。</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):166));  %1</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):167));  %0</span>
        <span class="token comment">%[data,tf]= str2num(pagesource(temp(1):246)); %1</span>
        <span class="token comment">%  上面tf的变化，说明当第一行数据的列数确定后，猜测通过/enter换行？，后面的数据列数如果存在缺失，返回[]；</span>
        <span class="token comment">%  上面的规则基本保证使用str2num()是没大问题的！</span>
        
        
        <span class="token comment">% 判别网页数据格式是在哪一时间段，从而知道每一列代表什么；</span>
        <span class="token comment">% ndbc 数据不同年份的数据格式：</span>
        <span class="token comment">%          1970-1998，索引~79，16列，YY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          1999，索引~81，16列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS</span>
        <span class="token comment">%          2000-2004，索引~87，17列，YYYY MM DD hh WD   WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2005-2006，索引~90，18列，YYYY MM DD hh mm  WD  WSPD GST  WVHT  DPD   APD  MWD  BAR    ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%          2007-2020，索引179&gt;150，18列，#YY  MM DD hh mm WDIR WSPD GST  WVHT   DPD   APD MWD   PRES  ATMP  WTMP  DEWP  VIS  TIDE</span>
        <span class="token comment">%                              #yr  mo dy hr mn degT m/s  m/s     m   sec   sec degT   hPa  degC  degC  degC   mi    ft</span>
        
        
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token comment">%1970-1998</span>
            <span class="token comment">% YY+1900 MM DD hh （mm=0） WD   WSPD GST  WVHT  DPD   APD MWD  BAR    ATMP  WTMP  DEWP  VIS (TIDE)</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1900</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token function">pagesource</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token comment">%1999</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token number">99</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token comment">%2000-2004</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token comment">%2005-2020</span>
            <span class="token comment">% data 的改造</span>
            data_time <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data_other <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">% 导入 data 进入 table</span>
            buoy_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm <span class="token operator">=</span> data_time<span class="token punctuation">;</span>
            buoy_table<span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">num2cell</span><span class="token punctuation">(</span>data_other<span class="token punctuation">)</span><span class="token punctuation">;</span>
            %
            buoy_table_All <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_table_All<span class="token punctuation">;</span>buoy_table<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'数据到对应浮标的table！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">'若tf=0，那么str2num()出现问题，导致data=[]，根本原因可能是TIDE数据有缺失空白。'</span><span class="token punctuation">)</span>
            buoy_fail <span class="token operator">=</span> <span class="token punctuation">[</span>buoy_fail<span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'h'</span><span class="token operator">+</span>nian<span class="token operator">+</span><span class="token string">'不符合一般的数据格式特点？i='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',j='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',tf='</span><span class="token operator">+</span><span class="token function">num2str</span><span class="token punctuation">(</span>tf<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">',导入table失败。'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">%44008h2000不符合一般的数据格式特点？i=5,j=19  %%TIDE 有空白</span>
            <span class="token comment">%44008h2017不符合一般的数据格式特点？i=5,j=35</span>
            <span class="token comment">%error(lower(ndbc_station_info_needed{i,1})+'h'+nian+'可能在调用str2num()时出错，因为矩阵列数不为16，不符合1970-1998的数据格式特点？。');</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span>
    
    <span class="token comment">% 存储浮标历史数据的table保存到： ndbc_station_info_needed.station_historyData_SM{i,1}</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'YY_MM_DD_hh_mm'</span> <span class="token string">'WDIR'</span> <span class="token string">'WSPD'</span> <span class="token string">'GST'</span>  <span class="token string">'WVHT'</span>   <span class="token string">'DPD'</span>   <span class="token string">'APD'</span> <span class="token string">'MWD'</span>   <span class="token string">'PRES'</span>  <span class="token string">'ATMP'</span>  <span class="token string">'WTMP'</span>  <span class="token string">'DEWP'</span>  <span class="token string">'VIS'</span>  <span class="token string">'TIDE'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableUnits <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'YY_MM_DD_hh_mm'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'m'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    buoy_table_All<span class="token punctuation">.</span>Properties<span class="token punctuation">.</span>VariableDescriptions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'年月日小时分钟,秒数都默认为0，ndbc没包含此信息'</span> <span class="token string">'degT'</span> <span class="token string">'m/s'</span> <span class="token string">'m/s'</span> <span class="token string">'有效波高'</span> <span class="token string">'sec'</span> <span class="token string">'sec'</span> <span class="token string">'degT'</span> <span class="token string">'hPa'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'degC'</span> <span class="token string">'mi'</span> <span class="token string">'ft'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    %
    temp <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'station_historyData_SM\'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'.mat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">save</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span><span class="token string">'buoy_table_All'</span><span class="token punctuation">,</span><span class="token string">'-v7'</span><span class="token punctuation">)</span> <span class="token comment">%v7，压缩程度最大，但是限制2GB</span>
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>buoy_table_All<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>buoy_table_All<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">',station_historyData_SM\'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'.mat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_info_needed<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> buoy_fail<span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已导入'</span><span class="token operator">+</span><span class="token function">lower</span><span class="token punctuation">(</span>ndbc_station_info_needed<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'的table数据到ndbc_station_info_needed.station_historyData_SM！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">end</span>

<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已提取浮标的 Standard Meterological 历史数据到 ndbc_station_info_needed。'</span><span class="token punctuation">)</span>

<span class="token comment">%% save</span>
ndbc_station_download <span class="token operator">=</span> ndbc_station_info_needed<span class="token punctuation">;</span>
<span class="token comment">%cd(path_save)</span>
<span class="token comment">%save ndbc_station_download ndbc_station_download %可能占用内存特别大；</span>

<span class="token comment">%%</span>
<span class="token comment">%ndbc_station_download_NC_analyse = ndbc_station_info_needed;</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="NDBC浮标数据对比"><a href="#NDBC浮标数据对比" class="headerlink" title="NDBC浮标数据对比"></a>NDBC浮标数据对比</h2><h3 id="ndbc-station-download-NC-m"><a href="#ndbc-station-download-NC-m" class="headerlink" title="ndbc_station_download_NC.m"></a>ndbc_station_download_NC.m</h3><p>加载<code>ndbc_station_download.mat</code>，查找每个浮标在NC文件对应的最近网格点经纬度（索引），并提取NC中各浮标对应网格点的<strong>时间</strong>-数据放到table中，将所有table放在<code>ndbc_station_download_NC</code>变量，最终生成<code>ndbc_station_download_NC.mat</code>。</p>
<p>这里使用的数据是<code>wind.2011.nc</code>：</p>
<blockquote>
<p>此nc文件由WW3的ounf生成；</p>
</blockquote>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token function">ncdisp</span><span class="token punctuation">(</span><span class="token string">'wind.2011.nc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Source<span class="token operator">:</span>
           D<span class="token operator">:</span><span class="token operator">\</span>ndbc<span class="token operator">\</span>ww3<span class="token punctuation">.</span><span class="token number">2011.</span>nc
Format<span class="token operator">:</span>
           classic
Global Attributes<span class="token operator">:</span>
           WAVEWATCH_III_version_number <span class="token operator">=</span> <span class="token string">'6.07'</span>
           WAVEWATCH_III_switches       <span class="token operator">=</span> <span class="token string">'F90 NOGRB NC4 TRKNC DIST MPI PR3 UQ FLX0 LN1 ST4 STAB0 NL1 BT4 DB1 MLIM TR0 BS0 IC0 IS0 REF1 XX0 WNT2 WNX1 RWND CRT1 CRX1 TIDE O0 O1 O2 O2a O2b O2c O3 O4 O5 O6 O7'</span>
           product_name                 <span class="token operator">=</span> <span class="token string">'ww3.2011.nc'</span>
           area                         <span class="token operator">=</span> <span class="token string">'east-USA_P25'</span>
           latitude_resolution          <span class="token operator">=</span> <span class="token string">'0.'</span>
           longitude_resolution         <span class="token operator">=</span> <span class="token string">'0.'</span>
           southernmost_latitude        <span class="token operator">=</span> <span class="token string">'36.'</span>
           northernmost_latitude        <span class="token operator">=</span> <span class="token string">'46.'</span>
           westernmost_longitude        <span class="token operator">=</span> <span class="token string">'-75.'</span>
           easternmost_longitude        <span class="token operator">=</span> <span class="token string">'-58.'</span>
           minimum_altitude             <span class="token operator">=</span> <span class="token string">'-12000 m'</span>
           maximum_altitude             <span class="token operator">=</span> <span class="token string">'9000 m'</span>
           altitude_resolution          <span class="token operator">=</span> <span class="token string">'n/a'</span>
           start_date                   <span class="token operator">=</span> <span class="token string">'2011-08-31 20:00:00'</span>
           stop_date                    <span class="token operator">=</span> <span class="token string">'2011-09-11 00:00:00'</span>
Dimensions<span class="token operator">:</span>
           level     <span class="token operator">=</span> <span class="token number">1</span>
           longitude <span class="token operator">=</span> <span class="token number">69</span>
           latitude  <span class="token operator">=</span> <span class="token number">41</span>
           time      <span class="token operator">=</span> <span class="token number">245</span>   <span class="token punctuation">(</span>UNLIMITED<span class="token punctuation">)</span>
Variables<span class="token operator">:</span>
    longitude
           Size<span class="token operator">:</span>       <span class="token number">69</span>x1
           Dimensions<span class="token operator">:</span> longitude
           Datatype<span class="token operator">:</span>   single
           Attributes<span class="token operator">:</span>
                       units         <span class="token operator">=</span> <span class="token string">'degree_east'</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'longitude'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'longitude'</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">180</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">360</span>
                       axis          <span class="token operator">=</span> <span class="token string">'X'</span>
    latitude 
           Size<span class="token operator">:</span>       <span class="token number">41</span>x1
           Dimensions<span class="token operator">:</span> latitude
           Datatype<span class="token operator">:</span>   single
           Attributes<span class="token operator">:</span>
                       units         <span class="token operator">=</span> <span class="token string">'degree_north'</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'latitude'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'latitude'</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">90</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">180</span>
                       axis          <span class="token operator">=</span> <span class="token string">'Y'</span>
    time     
           Size<span class="token operator">:</span>       <span class="token number">245</span>x1
           Dimensions<span class="token operator">:</span> time
           Datatype<span class="token operator">:</span>   double
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'julian day (UT)'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'time'</span>
                       calendar      <span class="token operator">=</span> <span class="token string">'standard'</span>
                       units         <span class="token operator">=</span> <span class="token string">'days since 1990-01-01 00:00:00'</span>
                       conventions   <span class="token operator">=</span> <span class="token string">'relative julian days with decimal part (as parts of the day )'</span>
                       axis          <span class="token operator">=</span> <span class="token string">'T'</span>
    MAPSTA   
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'status map'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'status map'</span>
                       units         <span class="token operator">=</span> <span class="token string">'1'</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">32</span>
    dpt      
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'depth'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'depth'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'depth'</span>
                       units         <span class="token operator">=</span> <span class="token string">'m'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.5</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">90000</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">140000</span>
    ucur     
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'eastward current'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'eastward_sea_water_velocity'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'eastward_sea_water_velocity'</span>
                       units         <span class="token operator">=</span> <span class="token string">'m s-1'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.01</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">990</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">990</span>
                       comment       <span class="token operator">=</span> <span class="token string">'cur=sqrt(U**2+V**2)'</span>
    vcur     
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'northward current'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'northward_sea_water_velocity'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'northward_sea_water_velocity'</span>
                       units         <span class="token operator">=</span> <span class="token string">'m s-1'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.01</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">990</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">990</span>
                       comment       <span class="token operator">=</span> <span class="token string">'cur=sqrt(U**2+V**2)'</span>
    uwnd     
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'eastward_wind'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'eastward_wind'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'eastward_wind'</span>
                       units         <span class="token operator">=</span> <span class="token string">'m s-1'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.1</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">990</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">990</span>
                       comment       <span class="token operator">=</span> <span class="token string">'wind=sqrt(U10**2+V10**2)'</span>
    vwnd     
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'northward_wind'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'northward_wind'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'northward_wind'</span>
                       units         <span class="token operator">=</span> <span class="token string">'m s-1'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.1</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">990</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">990</span>
                       comment       <span class="token operator">=</span> <span class="token string">'wind=sqrt(U10**2+V10**2)'</span>
    hs       
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'significant height of wind and swell waves'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'sea_surface_wave_significant_height'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'significant_wave_height'</span>
                       units         <span class="token operator">=</span> <span class="token string">'m'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.002</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token number">0</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">32000</span>
    fp       
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'wave peak frequency'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'sea_surface_wave_peak_frequency'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'dominant_wave_frequency'</span>
                       units         <span class="token operator">=</span> <span class="token string">'s-1'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.001</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token number">0</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">10000</span>
    dir      
           Size<span class="token operator">:</span>       <span class="token number">69</span>x41x245
           Dimensions<span class="token operator">:</span> longitude<span class="token punctuation">,</span>latitude<span class="token punctuation">,</span>time
           Datatype<span class="token operator">:</span>   int16
           Attributes<span class="token operator">:</span>
                       long_name     <span class="token operator">=</span> <span class="token string">'wave mean direction'</span>
                       standard_name <span class="token operator">=</span> <span class="token string">'sea_surface_wave_from_direction'</span>
                       globwave_name <span class="token operator">=</span> <span class="token string">'wave_from_direction'</span>
                       units         <span class="token operator">=</span> <span class="token string">'degree'</span>
                       _FillValue    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">32767</span>
                       scale_factor  <span class="token operator">=</span> <span class="token number">0.1</span>
                       add_offset    <span class="token operator">=</span> <span class="token number">0</span>
                       valid_min     <span class="token operator">=</span> <span class="token number">0</span>
                       valid_max     <span class="token operator">=</span> <span class="token number">3600</span>
<span class="token punctuation">...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>ndbc_station_download_NC.m</code>：</p>
<blockquote>
<p>开始接触到了<code>datetime</code>数据类型；</p>
</blockquote>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-15 first verison. </span>
%
<span class="token comment">% reference</span>
<span class="token comment">%    Matlab在一组数据中查找最接近某个数据的值：https://www.ilovematlab.cn/thread-102665-1-1.html</span>
<span class="token comment">%    matlab 计算N天前（后）的日期：https://blog.csdn.net/weixin_41649786/article/details/84581351</span>
<span class="token comment">%    matlab中一个日期怎么一次加一个月或者一年：https://zhidao.baidu.com/question/2271028597414842268.html</span>
<span class="token comment">%    </span>

clc<span class="token punctuation">,</span> clear all
load ndbc_station_download<span class="token punctuation">.</span>mat
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_download.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ndbc_station_download_NC0 <span class="token operator">=</span> table<span class="token punctuation">;</span> <span class="token comment">%后面重新命名为ndbc_station_download_NC即可。</span>

<span class="token comment">%% 了解 nc 文件；</span>
ncid <span class="token operator">=</span> <span class="token string">'ww3.2011.nc'</span><span class="token punctuation">;</span>
<span class="token comment">%ncdisp(ncid);</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'了解 nc 文件！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 查找每个浮标对应NC文件的最近网格点经纬度（索引）</span>
nclat <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%查看纬度显示正常</span>
nclon <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%查看经度显示正常</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_download<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">% lat 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">nclat</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span>ndbc_station_download<span class="token punctuation">.</span><span class="token function">lat</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">nclat</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">%索引位置</span>
    <span class="token comment">% lon 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">nclon</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span>ndbc_station_download<span class="token punctuation">.</span><span class="token function">lon</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% </span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">nclon</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">%索引位置</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已添加每个浮标对应NC文件的最近网格点经纬度、索引！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% NC文件julian day转换为UT日期，datetime数据类型</span>
<span class="token comment">%ncdisp(ncid,'time');</span>
nctime <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% julian day (UT),'days since 1990-01-01 00:00:00'</span>

<span class="token comment">% help datetime</span>
<span class="token comment">% help datestr</span>
<span class="token comment">% help caldays</span>
<span class="token comment">% help calendarDuration</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+1.5</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+nctime(2) %成功，与ncview()中的时间对上了。</span>
<span class="token comment">% caldays(1.1)</span>
<span class="token comment">% caldays(1)</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+caldays(1)</span>

UTtime <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token string">'1990-01-01 00:00:00'</span><span class="token punctuation">,</span><span class="token string">'InputFormat'</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span><span class="token operator">+</span>nctime<span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将NC文件julian day转换为UT日期，用到datetime数据类型！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">%% nc中的时间-WVHT数据</span>
<span class="token comment">% 各维度递增方向的确定，明确浮标点的索引需不需要变换</span>
nc_WVHT <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'hs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 69x41x245 double</span>
                             <span class="token comment">% Dimensions: longitude (维度递增方向↑or↓),latitude (维度递增方向← or →),time (维度递增方向↓), </span>
temp <span class="token operator">=</span> <span class="token function">nc_WVHT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">% 观察数据样子，与ncview()对比，可以得到：longitude (维度递增方向↓),latitude (维度递增方向→)</span>
                             <span class="token comment">%                                         longitude 索引不需要变换；</span>
                             <span class="token comment">%                                         latitude索引不需要变换；</span>
                                 
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token number">5</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token comment">%1:1:size(ndbc_station_download,1)</span>
    nc_time_WVHT <span class="token operator">=</span> table<span class="token punctuation">;</span>
    nc_time_WVHT<span class="token punctuation">.</span>YY_MM_DD_hh_mm_ss <span class="token operator">=</span> UTtime<span class="token punctuation">;</span>
    temp <span class="token operator">=</span> <span class="token function">nc_WVHT</span><span class="token punctuation">(</span>ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nc_time_WVHT<span class="token punctuation">.</span>WVHT <span class="token operator">=</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>nc_time_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> nc_time_WVHT<span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已提取nc中各浮标的时间-WVHT数据！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% save</span>
<span class="token comment">% ndbc_station_download_NC = ndbc_station_download;</span>
<span class="token comment">% save ndbc_station_download_NC ndbc_station_download_NC</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>ndbc_station_download_NC</code>：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220216000840.png"></p>
<h4 id="问题：matlab-如何将nc文件的朱利安（julian-day，也称儒略日）天数时间转换成世界时（UT）"><a href="#问题：matlab-如何将nc文件的朱利安（julian-day，也称儒略日）天数时间转换成世界时（UT）" class="headerlink" title="问题：matlab 如何将nc文件的朱利安（julian day，也称儒略日）天数时间转换成世界时（UT）"></a>问题：matlab 如何将nc文件的朱利安（julian day，也称儒略日）天数时间转换成世界时（UT）</h4><p><code>ncdisp(ncid,'time')</code>：</p>
<pre class="line-numbers language-none"><code class="language-none">ncdisp(ncid,'time')
Source:
           D:\ndbc\ww3.2011.nc
Format:
           classic
Dimensions:
           time = 245   (UNLIMITED)
Variables:
    time
           Size:       245x1
           Dimensions: time
           Datatype:   double
           Attributes:
                       long_name     = 'julian day (UT)'
                       standard_name = 'time'
                       calendar      = 'standard'
                       units         = 'days since 1990-01-01 00:00:00'
                       conventions   = 'relative julian days with decimal part (as parts of the day )'
                       axis          = 'T'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>nctime = ncread(ncid,'time')</code>：</p>
<pre class="line-numbers language-none"><code class="language-none">7912.83333333333
7912.87500000000
7912.91666666667
7912.95833333333
...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220215163052.png"></p>
<blockquote>
<p>解决方法：<code>datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+1.5</code></p>
</blockquote>
<h4 id="问题：如何实现nc读取某一经纬度下有效波高的时间序列"><a href="#问题：如何实现nc读取某一经纬度下有效波高的时间序列" class="headerlink" title="问题：如何实现nc读取某一经纬度下有效波高的时间序列"></a>问题：如何实现nc读取某一经纬度下有效波高的时间序列</h4><p><strong>核心</strong>：确定<strong>三个维度的递增方向</strong>，明确浮标点的索引需不需要变换</p>
<p>example：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">nc_WVHT <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'hs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 69x41x245 double</span>
                             <span class="token comment">% Dimensions: longitude (维度递增方向↑or↓),latitude (维度递增方向← or →),time (维度递增方向↓), </span>
temp <span class="token operator">=</span> <span class="token function">nc_WVHT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">% 观察数据样子，与ncview()对比，可以得到：longitude (维度递增方向↓),latitude (维度递增方向→)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>特征1</strong>对应：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220215234709.png"></p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220215234812.png"></p>
<p>特征2：…</p>
<p>特征3：…</p>
<h4 id="second-ndbc-station-download-NC-analyse"><a href="#second-ndbc-station-download-NC-analyse" class="headerlink" title="second, ndbc_station_download_NC_analyse"></a>second, ndbc_station_download_NC_analyse</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-15 first verison. </span>
<span class="token comment">%    2022-02-18 second, ndbc_station_download_NC_analyse</span>
%
<span class="token comment">% reference</span>
<span class="token comment">%    Matlab在一组数据中查找最接近某个数据的值：https://www.ilovematlab.cn/thread-102665-1-1.html</span>
<span class="token comment">%    matlab 计算N天前（后）的日期：https://blog.csdn.net/weixin_41649786/article/details/84581351</span>
<span class="token comment">%    matlab中一个日期怎么一次加一个月或者一年：https://zhidao.baidu.com/question/2271028597414842268.html</span>
<span class="token comment">%    </span>

clc<span class="token punctuation">,</span> clear all
<span class="token comment">%load ndbc_station_download.mat</span>
load ndbc_station_download_NC_analyse<span class="token punctuation">.</span>mat<span class="token punctuation">;</span> ndbc_station_download <span class="token operator">=</span> ndbc_station_download_NC_analyse<span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_download.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ndbc_station_download_NC0 <span class="token operator">=</span> table<span class="token punctuation">;</span> <span class="token comment">%后面重新命名为ndbc_station_download_NC即可。</span>

<span class="token comment">%% 了解 nc 文件；</span>
ncid <span class="token operator">=</span> <span class="token string">'ww3.2011.nc'</span><span class="token punctuation">;</span>
<span class="token comment">%ncdisp(ncid);</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'了解 nc 文件！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 查找每个浮标对应NC文件的最近网格点经纬度（索引）</span>
nclat <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%查看纬度显示正常</span>
nclon <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%查看经度显示正常</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_download<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">% lat 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">nclat</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span>ndbc_station_download<span class="token punctuation">.</span><span class="token function">lat</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">nclat</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">%索引位置</span>
    <span class="token comment">% lon 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">nclon</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span>ndbc_station_download<span class="token punctuation">.</span><span class="token function">lon</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% </span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">nclon</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">%索引位置</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已添加每个浮标对应NC文件的最近网格点经纬度、索引！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% NC文件julian day转换为UT日期，datetime数据类型</span>
<span class="token comment">%ncdisp(ncid,'time');</span>
nctime <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% julian day (UT),'days since 1990-01-01 00:00:00'</span>

<span class="token comment">% help datetime</span>
<span class="token comment">% help datestr</span>
<span class="token comment">% help caldays</span>
<span class="token comment">% help calendarDuration</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+1.5</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+nctime(2) %成功，与ncview()中的时间对上了。</span>
<span class="token comment">% caldays(1.1)</span>
<span class="token comment">% caldays(1)</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+caldays(1)</span>

UTtime <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token string">'1990-01-01 00:00:00'</span><span class="token punctuation">,</span><span class="token string">'InputFormat'</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span><span class="token operator">+</span>nctime<span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将NC文件julian day转换为UT日期，用到datetime数据类型！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">%% nc中的时间-WVHT数据</span>
<span class="token comment">% 各维度递增方向的确定，明确浮标点的索引需不需要变换</span>
nc_WVHT <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'hs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 69x41x245 double</span>
                             <span class="token comment">% Dimensions: longitude (维度递增方向↑or↓),latitude (维度递增方向← or →),time (维度递增方向↓), </span>
temp <span class="token operator">=</span> <span class="token function">nc_WVHT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">% 观察数据样子，与ncview()对比，可以得到：longitude (维度递增方向↓),latitude (维度递增方向→)</span>
                             <span class="token comment">%                                         longitude 索引不需要变换；</span>
                             <span class="token comment">%                                         latitude索引不需要变换；</span>
                                 
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token comment">%1:1:size(ndbc_station_download,1)</span>
    nc_time_WVHT <span class="token operator">=</span> table<span class="token punctuation">;</span>
    nc_time_WVHT<span class="token punctuation">.</span>YY_MM_DD_hh_mm_ss <span class="token operator">=</span> UTtime<span class="token punctuation">;</span>
    temp <span class="token operator">=</span> <span class="token function">nc_WVHT</span><span class="token punctuation">(</span>ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nc_time_WVHT<span class="token punctuation">.</span>WVHT <span class="token operator">=</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>nc_time_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> nc_time_WVHT<span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已提取nc中各浮标的时间-WVHT数据！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% save</span>
<span class="token comment">% ndbc_station_download_NC = ndbc_station_download;</span>
<span class="token comment">% save ndbc_station_download_NC ndbc_station_download_NC</span>

<span class="token comment">%%</span>
<span class="token comment">%ndbc_station_download_NC_analyse = ndbc_station_download;</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="third-function-path-save"><a href="#third-function-path-save" class="headerlink" title="third, function, path_save"></a>third, function, path_save</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>ndbc_station_download<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download_NC</span><span class="token punctuation">(</span>ndbc_station_download<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>ncid<span class="token punctuation">,</span>nclat<span class="token punctuation">,</span>nclon<span class="token punctuation">,</span>nctime<span class="token punctuation">,</span>nc_WVHT<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span>
<span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-15 first verison. </span>
<span class="token comment">%    2022-02-18 second, ndbc_station_download_NC_analyse</span>
<span class="token comment">%    2022-02-19 third, function, path_save.</span>
%
<span class="token comment">% reference</span>
<span class="token comment">%    Matlab在一组数据中查找最接近某个数据的值：https://www.ilovematlab.cn/thread-102665-1-1.html</span>
<span class="token comment">%    matlab 计算N天前（后）的日期：https://blog.csdn.net/weixin_41649786/article/details/84581351</span>
<span class="token comment">%    matlab中一个日期怎么一次加一个月或者一年：https://zhidao.baidu.com/question/2271028597414842268.html</span>
<span class="token comment">%    </span>

<span class="token comment">%clc, clear all</span>
<span class="token comment">%load ndbc_station_download.mat</span>
<span class="token comment">%load ndbc_station_download_NC_analyse.mat; ndbc_station_download = ndbc_station_download_NC_analyse;</span>
<span class="token comment">%disp('已加载ndbc_station_download.mat！'); pause(1);</span>
<span class="token comment">%ndbc_station_download_NC0 = table; %后面重新命名为ndbc_station_download_NC即可。</span>

<span class="token comment">%%</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'-----------------------ndbc_station_download_NC'</span><span class="token punctuation">)</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>

<span class="token comment">%% 了解 nc 文件；</span>
<span class="token comment">%ncid = 'ww3.2011.nc';</span>
<span class="token comment">%ncdisp(ncid);</span>
<span class="token comment">%disp('了解 nc 文件！'); pause(1);</span>

<span class="token comment">%% 查找每个浮标对应NC文件的最近网格点经纬度（索引）</span>
<span class="token comment">%nclat = ncread(ncid,'latitude'); %查看纬度显示正常</span>
<span class="token comment">%nclon = ncread(ncid,'longitude'); %查看经度显示正常</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>ndbc_station_download<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">% lat 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">nclat</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span>ndbc_station_download<span class="token punctuation">.</span><span class="token function">lat</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">nclat</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">%索引位置</span>
    <span class="token comment">% lon 最近网格点经纬度</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">nclon</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">-</span>ndbc_station_download<span class="token punctuation">.</span><span class="token function">lon</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% </span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">nclon</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">%索引位置</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已添加每个浮标对应NC文件的最近网格点经纬度、索引！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% NC文件julian day转换为UT日期，datetime数据类型</span>
<span class="token comment">%ncdisp(ncid,'time');</span>
<span class="token comment">%nctime = ncread(ncid,'time'); % julian day (UT),'days since 1990-01-01 00:00:00'</span>

<span class="token comment">% help datetime</span>
<span class="token comment">% help datestr</span>
<span class="token comment">% help caldays</span>
<span class="token comment">% help calendarDuration</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+1.5</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+nctime(2) %成功，与ncview()中的时间对上了。</span>
<span class="token comment">% caldays(1.1)</span>
<span class="token comment">% caldays(1)</span>
<span class="token comment">% datetime('1990-01-01 00:00:00','InputFormat','yyyy-MM-dd HH:mm:ss')+caldays(1)</span>

UTtime <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span><span class="token string">'1990-01-01 00:00:00'</span><span class="token punctuation">,</span><span class="token string">'InputFormat'</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span><span class="token operator">+</span>nctime<span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已将NC文件julian day转换为UT日期，用到datetime数据类型！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">%% nc中的时间-WVHT数据</span>
<span class="token comment">% 各维度递增方向的确定，明确浮标点的索引需不需要变换</span>
<span class="token comment">%nc_WVHT = ncread(ncid,'hs'); % 69x41x245 double</span>
                             <span class="token comment">% Dimensions: longitude (维度递增方向↑or↓),latitude (维度递增方向← or →),time (维度递增方向↓), </span>
temp <span class="token operator">=</span> <span class="token function">nc_WVHT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">% 观察数据样子，与ncview()对比，可以得到：longitude (维度递增方向↓),latitude (维度递增方向→)</span>
                             <span class="token comment">%                                         longitude 索引不需要变换；</span>
                             <span class="token comment">%                                         latitude索引不需要变换；</span>
                                 
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span>station_tf_download<span class="token comment">%1:1:size(ndbc_station_download,1)</span>
    nc_time_WVHT <span class="token operator">=</span> table<span class="token punctuation">;</span>
    nc_time_WVHT<span class="token punctuation">.</span>YY_MM_DD_hh_mm_ss <span class="token operator">=</span> UTtime<span class="token punctuation">;</span>
    temp <span class="token operator">=</span> <span class="token function">nc_WVHT</span><span class="token punctuation">(</span>ndbc_station_download<span class="token punctuation">.</span>matchNC_lon<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>ndbc_station_download<span class="token punctuation">.</span>matchNC_lat<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nc_time_WVHT<span class="token punctuation">.</span>WVHT <span class="token operator">=</span> <span class="token function">temp</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_station_download<span class="token punctuation">.</span>nc_time_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> nc_time_WVHT<span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已提取nc中各浮标的时间-WVHT数据！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% save</span>
<span class="token comment">% ndbc_station_download_NC = ndbc_station_download;</span>
<span class="token comment">% save ndbc_station_download_NC ndbc_station_download_NC</span>

<span class="token comment">%%</span>
<span class="token comment">%ndbc_station_download_NC_analyse = ndbc_station_download;</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="ndbc-station-download-NC-analyse-m"><a href="#ndbc-station-download-NC-analyse-m" class="headerlink" title="ndbc_station_download_NC_analyse.m"></a>ndbc_station_download_NC_analyse.m</h3><p>加载<code>ndbc_station_download_NC.mat</code>，在分析某一变量数据时，首先去除ndbc数据<code>table</code>和nc文件相关<code>table</code>中的<code>无效数据</code>所在行，再将ndbc数据<code>table</code>中的时间与nc文件相关<code>table</code>的时间进行匹配，得到二者的时序图、RMSE、Bias、R、SI、QQ图、散点图，将所有结果放在<code>ndbc_station_download_NC_analyse</code>变量，最终生成<code>ndbc_station_download_NC_analyse.mat</code>。</p>
<blockquote>
<p>一般Bias为负，表明模式数据低估真实数据；</p>
</blockquote>
<p><code>ndbc_station_download_NC_analyse.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-18 first verison.</span>
%

clc<span class="token punctuation">,</span> clear all
load ndbc_station_download_NC<span class="token punctuation">.</span>mat
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_download_NC.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">%% 时间-WVHT数据，一个小时一个数据</span>
<span class="token comment">%-----------------------------</span>
<span class="token comment">%参数</span>
path_fig <span class="token operator">=</span> <span class="token string">'.\fig\'</span><span class="token punctuation">;</span> <span class="token comment">%%https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop</span>
<span class="token comment">%-----------------------------</span>

<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token comment">%1:1:size(ndbc_station_download_NC,1)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'时间-WVHT数据分析，一个小时一个数据：'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% 去除ndbc数据table无效数据所在行</span>
    ndbc_table <span class="token operator">=</span> ndbc_station_download_NC<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">%table</span>
    ndbc_WVHT1 <span class="token operator">=</span> <span class="token function">cell2mat</span><span class="token punctuation">(</span>ndbc_table<span class="token punctuation">.</span><span class="token function">WVHT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%double</span>
    ndbc_time1 <span class="token operator">=</span> ndbc_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm<span class="token punctuation">;</span> <span class="token comment">% datetime</span>
    tf1 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_WVHT1<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_WVHT1<span class="token operator">&lt;</span><span class="token number">99</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    ndbc_time2 <span class="token operator">=</span> <span class="token function">ndbc_time1</span><span class="token punctuation">(</span>tf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_WVHT2 <span class="token operator">=</span> <span class="token function">ndbc_WVHT1</span><span class="token punctuation">(</span>tf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已去除ndbc数据table无效数据所在行；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% ndbc数据，一个小时一个数据</span>
    <span class="token comment">% 超过30分钟，进一个小时</span>
    tf2 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&gt;</span><span class="token number">30</span> <span class="token operator">&amp;</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&lt;</span><span class="token number">60</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% case1, 秒数都是0，因为ndbc不包含秒数信息；</span>
    temp <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf2<span class="token punctuation">)</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Hour <span class="token operator">=</span> temp<span class="token punctuation">.</span>Hour<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf2<span class="token punctuation">)</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token comment">% 少于30分钟，小时不变</span>
    tf3 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&lt;</span><span class="token number">30</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% case2；</span>
    temp <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf3<span class="token punctuation">)</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf3<span class="token punctuation">)</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token comment">% 年、月、日、时相等的datetime处理：</span>
    count <span class="token operator">=</span> <span class="token function">tabulate</span><span class="token punctuation">(</span>ndbc_time2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 统计数列中每个元素出现的次数</span>
    tf4 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">cell2mat</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 元素次数超过1次</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>tf4<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">%元素次数超过1次的元素进行平均化处理</span>
        temp <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span>count<span class="token punctuation">{</span><span class="token function">tf4</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tf5 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>ndbc_time2<span class="token operator">==</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span><span class="token function">tf5</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span>tf5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%平均化处理</span>
        <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span><span class="token function">tf5</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span> <span class="token comment">%无效数据</span>
        <span class="token comment">% ndbc_WVHT2(tf5)</span>
    <span class="token keyword">end</span>
    tf6 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_WVHT2<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_WVHT2<span class="token operator">&lt;</span><span class="token number">99</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_time3 <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf6<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% unique(ndbc_time3); %通过维数不变，发现每一个元素都是唯一的;</span>
    ndbc_WVHT3 <span class="token operator">=</span> <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span>tf6<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已实现ndbc数据，一个小时一个数据，（通过了unique(ndbc_time3)的检验）；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% nc 数据，一个小时一个数据；</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已确定nc数据，一个小时一个数据；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% ndbc 和 nc 小时数据匹配；</span>
    <span class="token comment">% 组合ndbc和nc的数据</span>
    temp <span class="token operator">=</span> ndbc_station_download_NC<span class="token punctuation">.</span>nc_time_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    ndbc_nc_time <span class="token operator">=</span> <span class="token punctuation">[</span>ndbc_time3<span class="token punctuation">;</span>temp<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%ndbc 和 nc的datetime数据组合</span>
    ndbc_nc_WVHT <span class="token operator">=</span> <span class="token punctuation">[</span>ndbc_WVHT3<span class="token punctuation">;</span>temp<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%ndbc 和 nc的WVHT数据组合</span>
    <span class="token comment">% 匹配</span>
    ndbc_nc_match_WVHT <span class="token operator">=</span> table<span class="token punctuation">;</span>
    count <span class="token operator">=</span> <span class="token function">tabulate</span><span class="token punctuation">(</span>ndbc_nc_time<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%匹配的时间元素，会出现2次，而且不可能超过两次；</span>
    tf7 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">cell2mat</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 元素次数超过1次</span>
    temp1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储时间</span>
    temp2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储ndbc数据</span>
    temp3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储nc数据</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>tf7<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        temp <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span>count<span class="token punctuation">{</span><span class="token function">tf7</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tf8 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>ndbc_nc_time<span class="token operator">==</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp1 <span class="token operator">=</span> <span class="token punctuation">[</span>temp1<span class="token punctuation">;</span>temp<span class="token punctuation">]</span><span class="token punctuation">;</span>
        temp2 <span class="token operator">=</span> <span class="token punctuation">[</span>temp2<span class="token punctuation">;</span><span class="token function">ndbc_nc_WVHT</span><span class="token punctuation">(</span><span class="token function">tf8</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        temp3 <span class="token operator">=</span> <span class="token punctuation">[</span>temp3<span class="token punctuation">;</span><span class="token function">ndbc_nc_WVHT</span><span class="token punctuation">(</span><span class="token function">tf8</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>time <span class="token operator">=</span> temp1<span class="token punctuation">;</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc <span class="token operator">=</span> temp2<span class="token punctuation">;</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc <span class="token operator">=</span> temp3<span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已对 ndbc 和 nc 小时数据匹配；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% 匹配数据分析</span>
    <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>tf7<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">3</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      发现'</span><span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'匹配的数据不足3个'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ndbc_station_download_NC<span class="token punctuation">.</span>ndbc_nc_match_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      发现'</span><span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'匹配的数据不足3个'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token comment">% 时序图</span>
        f <span class="token operator">=</span> <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">plot</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>time<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        hold on<span class="token punctuation">;</span> <span class="token function">plot</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>time<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">%close(f1)</span>
        <span class="token function">savefig</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-时序图'</span><span class="token punctuation">,</span><span class="token string">'.fig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>TimeSeriesChart<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'openfig("'</span><span class="token punctuation">,</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-时序图'</span><span class="token punctuation">,</span><span class="token string">'.fig")'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token comment">%openfig('1.fig');</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已简单画出时序图，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">% rmse, bias, R, SI, PE</span>
        error <span class="token operator">=</span> ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token operator">-</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">;</span>
        rmse <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span>error<span class="token operator">.*</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bias <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">,</span> ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        PE <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token operator">./</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">;</span>
        SI <span class="token operator">=</span> rmse<span class="token operator">/</span><span class="token function">mean</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>rmse<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> rmse<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>bias<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> bias<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>r<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>PE<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> PE<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>SI<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> SI<span class="token punctuation">;</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已计算RMSE, BIAS, R, SI, PE，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        
        
        <span class="token comment">% 散点图</span>
        <span class="token punctuation">[</span>f<span class="token punctuation">,</span>de<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">DensScat</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">colormap</span><span class="token punctuation">(</span><span class="token string">'Jet'</span><span class="token punctuation">)</span>
        hc <span class="token operator">=</span> colorbar<span class="token punctuation">;</span>
        <span class="token function">savefig</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-散点图'</span><span class="token punctuation">,</span><span class="token string">'.fig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>ScatterChart<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'openfig("'</span><span class="token punctuation">,</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-散点图'</span><span class="token punctuation">,</span><span class="token string">'.fig")'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已简单画出散点图，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">% 保存到总的table</span>
        ndbc_station_download_NC<span class="token punctuation">.</span>ndbc_nc_match_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> ndbc_nc_match_WVHT<span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    
    
<span class="token keyword">end</span>

<span class="token comment">%%</span>
<span class="token comment">%ndbc_station_download_NC_analyse = ndbc_station_download_NC;</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行后的<code>ndbc_station_download_NC_analyse</code>变量：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218195310.png"></p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218195422.png"></p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218211949.png" alt=" " style="zoom:67%;">

<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218212042.png" style="zoom:67%;">



<h4 id="如何画datetime的时序图"><a href="#如何画datetime的时序图" class="headerlink" title="如何画datetime的时序图"></a>如何画datetime的时序图</h4><h4 id="如何保存图形（figure）到mat（table-cell）"><a href="#如何保存图形（figure）到mat（table-cell）" class="headerlink" title="如何保存图形（figure）到mat（table, cell）"></a>如何保存图形（figure）到mat（table, cell）</h4><pre class="line-numbers language-QQ" data-language="QQ"><code class="language-QQ">【小学】MyLifeStyle(3079779149)  17:15:08
请问，matlab中在某个figure上画了图形，关闭figure后，如何再次调出图形？想达到的目的是，像显示变量一样的显示图形~~谢谢~~

【管理员】新疆+源代码+奋斗(535512013)  17:16:00
关闭哪个就在命令框中输入figure几

【小学】MyLifeStyle(3079779149)  17:21:07
关闭后打不开，显示句柄已经删除了，不知道什么意思~~

【管理员】新疆+源代码+奋斗(535512013)  17:23:32
删除和关闭不一样

【管理员】新疆+源代码+奋斗(535512013)  17:27:32
不能重新画吗

【小学】MyLifeStyle(3079779149)  17:29:24
额，是批量画图，一个对象有2个图，总共有200个对象，在分析时才具体看图形~~

【小学】MyLifeStyle(3079779149)  17:30:04
相像保存和调用数据那样，实现图形的保存和调用~

【管理员】新疆+源代码+奋斗(535512013)  17:31:01
只能重新画，把删除命令去掉

【管理员】新疆+源代码+奋斗(535512013)  17:31:13
不然画好了也给你删除了

【小学】MyLifeStyle(3079779149)  17:31:35
好的~~

【管理员】晨雾(914836396)  17:33:39
@MyLifeStyle 你可以直接把fig存下来

【管理员】新疆+源代码+奋斗(535512013)  17:34:56
@MyLifeStyle 大佬来了，他会@晨雾 
【管理员】新疆+源代码+奋斗(535512013)  17:36:39
我就一弟中弟，

【管理员】新疆+源代码+奋斗(535512013)  17:36:49
看见大佬赶紧让路

【小学】MyLifeStyle(3079779149)  17:37:39
看到大佬们都这么谦虚，我又充满了动力
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop">https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop</a></p>
<h4 id="南海论文的时序图"><a href="#南海论文的时序图" class="headerlink" title="南海论文的时序图"></a>南海论文的时序图</h4><p><code>Step1_Hs_NPJ.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">tic
clear all
<span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'Step1_Hs_NPJ'</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token number">1958</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2019</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> NPJ<span class="token punctuation">;</span>

<span class="token comment">%% The line of best fit</span>
<span class="token punctuation">[</span>k1<span class="token punctuation">,</span>b1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Trend_ZuiJiaXianNiHe</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% Thei-Sen and MannKendall </span>
alpha <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>k2<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>k3<span class="token punctuation">,</span>b3<span class="token punctuation">,</span>k4<span class="token punctuation">,</span>b4<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Trend_TheiSenNiHe</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>CL<span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Trend_MannKendallTest</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%置信水平</span>

<span class="token comment">%% plot</span>
close all
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'NumberTitle'</span><span class="token punctuation">,</span> <span class="token string">'off'</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
hold on
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token function">polyval</span><span class="token punctuation">(</span><span class="token punctuation">[</span>k1<span class="token punctuation">,</span>b1<span class="token punctuation">]</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token function">polyval</span><span class="token punctuation">(</span><span class="token punctuation">[</span>k2<span class="token punctuation">,</span>b2<span class="token punctuation">]</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token function">polyval</span><span class="token punctuation">(</span><span class="token punctuation">[</span>k3<span class="token punctuation">,</span>b3<span class="token punctuation">]</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'--k'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token function">polyval</span><span class="token punctuation">(</span><span class="token punctuation">[</span>k4<span class="token punctuation">,</span>b4<span class="token punctuation">]</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'--k'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span>"mean <span class="token function">SWH</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span>"<span class="token punctuation">,</span><span class="token string">'FontName'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span>

<span class="token function">xlim</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1957</span> <span class="token number">2020</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">% ：：坐标轴设置</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> <span class="token function">xlim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y <span class="token operator">=</span> <span class="token function">ylim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">axis</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%设置坐标轴axis取值范围</span>
    <span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'Tickdir'</span><span class="token punctuation">,</span><span class="token string">'out'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%设置刻度外翻</span>
    <span class="token comment">% ：：图形框右边和上边设置</span>
    <span class="token function">plot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">plot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">% ：：图形下边和左边</span>
    <span class="token function">plot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">plot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
        <span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">% ：：去掉右上角刻度</span>
    <span class="token comment">% get(gca)</span>
    
    %
    <span class="token keyword">break</span>
<span class="token keyword">end</span>
%
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'T'</span><span class="token punctuation">,</span><span class="token string">'T±CL'</span><span class="token punctuation">,</span><span class="token string">'Location'</span><span class="token punctuation">,</span><span class="token string">'NorthWest'</span><span class="token punctuation">)</span>

toc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218163449.png" style="zoom:67%;">

<h4 id="南海论文的散点图"><a href="#南海论文的散点图" class="headerlink" title="南海论文的散点图"></a>南海论文的散点图</h4><p><code>SWH_buoy_era5_dat.mat</code>:</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218161523.png" style="zoom:67%;">

<blockquote>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Oio3VAkl6-KcW8hWQpr51w">https://pan.baidu.com/s/1Oio3VAkl6-KcW8hWQpr51w</a><br>提取码：4mib<br>–来自百度网盘超级会员V5的分享</p>
</blockquote>
<p><code>plot_era5_py301_jieguo.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">clear all
close all
clc
<span class="token comment">% data=load('ERA5_PY301_match.dat');</span>
<span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'SWH_buoy_era5_dat.mat'</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> obs_all<span class="token punctuation">;</span>
b <span class="token operator">=</span> reana_all<span class="token punctuation">;</span>
<span class="token comment">%load('SWH_buoy_era5_dat_2011')</span>
<span class="token comment">%c = obs_all;</span>
<span class="token comment">%d = reana_all;</span>
<span class="token comment">%clear obs_all</span>
<span class="token comment">%clear reana_all</span>
ndbc_swh <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span>
era5_swh <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>d<span class="token punctuation">,</span>de<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">DensScat</span><span class="token punctuation">(</span>ndbc_swh<span class="token punctuation">,</span>era5_swh<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%1</span>
<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'xlim'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'ylim'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span>
<span class="token function">colormap</span><span class="token punctuation">(</span><span class="token string">'Jet'</span><span class="token punctuation">)</span>
hc <span class="token operator">=</span> colorbar<span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>hc<span class="token punctuation">,</span><span class="token string">'ticks'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">10</span> <span class="token number">40</span> <span class="token number">80</span> <span class="token number">120</span> <span class="token number">160</span> <span class="token number">200</span> <span class="token number">240</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'ticklabels'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">'10'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token string">'40'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token string">'80'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token string">'120'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token string">'160'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token string">'200'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">{</span><span class="token string">'240'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'TickLabelInterpreter'</span><span class="token punctuation">,</span><span class="token string">'tex'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
    <span class="token string">'visible'</span><span class="token punctuation">,</span><span class="token string">'on'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>hc<span class="token punctuation">.</span>Label<span class="token punctuation">,</span><span class="token string">'String'</span><span class="token punctuation">,</span><span class="token string">'Number of points'</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'times new roman'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%hc.Label.String = 'Number of points';</span>
hold on
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0.01</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0.01</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'k-'</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Buoy SWH (m)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'ERA5 SWH (m)'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span>

N<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>ndbc_swh<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%[bias,rms,corr]=cal_index(N,ndbc_swh,era5_swh); %2</span>
error <span class="token operator">=</span> ndbc_swh<span class="token operator">-</span>era5_swh<span class="token punctuation">;</span>
rmse <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span>error<span class="token operator">.*</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">%N</span>
maxBouySWH <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>ndbc_swh<span class="token punctuation">)</span>
rmse_max <span class="token operator">=</span> rmse<span class="token operator">/</span>maxBouySWH
bias <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>error<span class="token punctuation">)</span>
r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>ndbc_swh<span class="token punctuation">,</span> era5_swh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


hold on
<span class="token function">text</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6.8</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'Bias = -0.07 m'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span>
hold on
<span class="token function">text</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7.5</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'RMSE = 0.35 m (5.06%)'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span>
hold on
<span class="token function">text</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6.1</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'R = 0.95'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'fontname'</span><span class="token punctuation">,</span><span class="token string">'Times New Roman'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>DensScat.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>fh<span class="token punctuation">,</span>density<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">DensScat</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span> varargin<span class="token punctuation">)</span>
<span class="token comment">% USAGE:</span>
<span class="token comment">%  fh = DensScat(x, y) makes a density scatter plot using the vectors x &amp; y</span>
%
<span class="token comment">% INPUTS:</span>
<span class="token comment">% * x &amp; y are two numeric vectors describing the x-axis &amp; y-axis</span>
<span class="token comment">% location for each point in the scatter plot</span>
%
<span class="token comment">% OUTPUTS:</span>
<span class="token comment">% * fh: figure handle to for the scatter plot</span>
%
<span class="token comment">% OTHER PARAMETERS passed as parameter-value pairs, defaults in []</span>
<span class="token comment">% 'MarkerType': Marker type '.od&lt;&gt;^vs+*xph' ['.']</span>
<span class="token comment">% 'mSize': Integer for Marker size [50 for '.' otherwise 12]</span>
<span class="token comment">% 'ColorMap': Colormap to be used name eg 'jet' or N*3 matrix [TurboMap]</span>
<span class="token comment">% 'logDensity': true/false for taking the log10 of the density [true]</span>
<span class="token comment">% 'AxisSquare': true/false for making axis square [true]</span>
<span class="token comment">% 'SmoothDensity': true/false for density smoothing [true]</span>
<span class="token comment">% 'lambda':  Integer for the degree of smoothing [30]</span>
<span class="token comment">% 'nBin_x': Integer for number of bins along the x-axis [200]</span>
<span class="token comment">% 'nBin_y': Integer for number of bins along the y-axis [200]</span>
<span class="token comment">% 'RemovePoints': true/false only plot points that that are unique based</span>
<span class="token comment">%                 on a 1000*1000 grid [true]</span>
<span class="token comment">% 'TargetAxes': Axes handle to existing axes that will be used [false]</span>
<span class="token comment">% 'ColorBar': true/false creates a color bar for the density [true]</span>
<span class="token comment">% 'MaxDens': double for thresholding density D(D&gt;MaxDens) = MaxDens [inf]</span>
<span class="token comment">% 'PointsToExclude': Nx2 matrix describing points to be exluded for example</span>
<span class="token comment">% [0 0] may be useful for RNAseq data [ [] ]</span>
%
<span class="token comment">% The smoothing is based on the following reference:</span>
<span class="token comment">% Paul H. C. Eilers and Jelle J. Goeman</span>
<span class="token comment">% Enhancing scatterplots with smoothed densities</span>
<span class="token comment">% Bioinformatics, Mar 2004; 20: 623 - 628.</span>
%
<span class="token comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="token comment">%%% by Anders Berglund, 2020 aebergl@gmail.com                            %</span>
<span class="token comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="token comment">% Check number of input parameters</span>
<span class="token keyword">if</span> nargin <span class="token operator">&lt;</span> <span class="token number">2</span>
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'DensScat requires at least two input vectors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Check that they are numeric</span>
<span class="token keyword">if</span> <span class="token operator">~</span><span class="token function">ismatrix</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">~</span><span class="token function">isnumeric</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">~</span><span class="token function">ismatrix</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">~</span><span class="token function">isnumeric</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'x &amp; y need to be numeric vectors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Check that they are all vectors</span>
<span class="token keyword">if</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token number">1</span>
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'x &amp; y must be vectors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Check that x and Y are of equal length</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'x &amp; y must all have equal length'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Make sure that x &amp; y are all column vectors and not row vectors</span>
<span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
    x <span class="token operator">=</span> x<span class="token operator">'</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
    y <span class="token operator">=</span> y<span class="token operator">'</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">%Parse input and set default values</span>
p <span class="token operator">=</span> <span class="token function">parseArguments</span><span class="token punctuation">(</span>varargin<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fh <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">% Remove Missing values</span>
indx <span class="token operator">=</span> <span class="token function">isnan</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">isnan</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span>indx<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">y</span><span class="token punctuation">(</span>indx<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token operator">~</span><span class="token function">isempty</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>PointsToExclude<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>PointsToExclude<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        indx <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> p<span class="token punctuation">.</span><span class="token function">PointsToExclude</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>y <span class="token operator">==</span> p<span class="token punctuation">.</span><span class="token function">PointsToExclude</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">x</span><span class="token punctuation">(</span>indx<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">y</span><span class="token punctuation">(</span>indx<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">% get ranges</span>
min_x <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
max_x <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
min_y <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
max_y <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">% Define edges</span>
edges_x <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span>min_x<span class="token punctuation">,</span> max_x<span class="token punctuation">,</span> p<span class="token punctuation">.</span>nBin_x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">edges_x</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">1</span> <span class="token keyword">end</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span>Inf <span class="token operator">+</span>Inf<span class="token punctuation">]</span><span class="token punctuation">;</span>
edges_y <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span>min_y<span class="token punctuation">,</span> max_y<span class="token punctuation">,</span> p<span class="token punctuation">.</span>nBin_y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">edges_y</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">1</span> <span class="token keyword">end</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span>Inf <span class="token operator">+</span>Inf<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">% Get number of counts</span>
<span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">,</span><span class="token function">bin</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">bin</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">histcounts2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>edges_x<span class="token punctuation">,</span>edges_y<span class="token punctuation">)</span><span class="token punctuation">;</span>

H <span class="token operator">=</span> <span class="token function">accumarray</span><span class="token punctuation">(</span>bin<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">[</span>p<span class="token punctuation">.</span>nBin_y p<span class="token punctuation">.</span>nBin_x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% Smoothing</span>
<span class="token keyword">if</span> p<span class="token punctuation">.</span>SmoothDensity
    H <span class="token operator">=</span> <span class="token function">smooth1D</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span>p<span class="token punctuation">.</span>nBin_y<span class="token operator">/</span>p<span class="token punctuation">.</span>lambda<span class="token punctuation">)</span><span class="token punctuation">;</span>
    H <span class="token operator">=</span> <span class="token function">smooth1D</span><span class="token punctuation">(</span>H<span class="token operator">'</span><span class="token punctuation">,</span>p<span class="token punctuation">.</span>nBin_x<span class="token operator">/</span>p<span class="token punctuation">.</span>lambda<span class="token punctuation">)</span><span class="token operator">'</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% Get density for each point</span>
ind <span class="token operator">=</span> <span class="token function">sub2ind</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">bin</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">bin</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
density <span class="token operator">=</span> <span class="token function">H</span><span class="token punctuation">(</span>ind<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> p<span class="token punctuation">.</span>logDensity
    density <span class="token operator">=</span> <span class="token function">log10</span><span class="token punctuation">(</span>density<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token keyword">if</span> p<span class="token punctuation">.</span>MaxDens
    <span class="token function">density</span><span class="token punctuation">(</span>density <span class="token operator">&gt;</span> p<span class="token punctuation">.</span>MaxDens<span class="token punctuation">)</span> <span class="token operator">=</span> p<span class="token punctuation">.</span>MaxDens<span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">% make sure that high density points are plotted last</span>
<span class="token punctuation">[</span>density<span class="token punctuation">,</span>sort_indx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sort</span><span class="token punctuation">(</span>density<span class="token punctuation">,</span><span class="token string">'Ascend'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token function">x</span><span class="token punctuation">(</span>sort_indx<span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token function">y</span><span class="token punctuation">(</span>sort_indx<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> p<span class="token punctuation">.</span>RemovePoints
    x <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Significant'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Significant'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>indx<span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'rows'</span><span class="token punctuation">,</span><span class="token string">'stable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    x <span class="token operator">=</span> <span class="token function">x</span><span class="token punctuation">(</span>indx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    y <span class="token operator">=</span> <span class="token function">y</span><span class="token punctuation">(</span>indx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    density <span class="token operator">=</span> <span class="token function">density</span><span class="token punctuation">(</span>indx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token keyword">if</span> <span class="token function">isgraphics</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>TargetAxes<span class="token punctuation">,</span><span class="token string">'axes'</span><span class="token punctuation">)</span>
    ah <span class="token operator">=</span> p<span class="token punctuation">.</span>TargetAxes<span class="token punctuation">;</span>
<span class="token keyword">else</span>
    <span class="token comment">% Create figure handle</span>
    fh <span class="token operator">=</span> <span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'Name'</span><span class="token punctuation">,</span><span class="token string">'Density Scatter Plot'</span><span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span><span class="token string">'Tag'</span><span class="token punctuation">,</span><span class="token string">'Density Scatter Plot'</span><span class="token punctuation">,</span><span class="token string">'GraphicsSmoothing'</span><span class="token punctuation">,</span><span class="token string">'off'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">% Create figure handle</span>
    ah <span class="token operator">=</span> <span class="token function">axes</span><span class="token punctuation">(</span>fh<span class="token punctuation">,</span><span class="token string">'NextPlot'</span><span class="token punctuation">,</span><span class="token string">'add'</span><span class="token punctuation">,</span><span class="token string">'tag'</span><span class="token punctuation">,</span><span class="token string">'Scatter Plot'</span><span class="token punctuation">,</span><span class="token string">'Box'</span><span class="token punctuation">,</span><span class="token string">'on'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token string">'Linewidth'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token keyword">if</span> <span class="token function">ismatrix</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>ColorMap<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isnumeric</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>ColorMap<span class="token punctuation">)</span>
    cMap <span class="token operator">=</span> p<span class="token punctuation">.</span>ColorMap<span class="token punctuation">;</span>
<span class="token keyword">elseif</span> <span class="token function">strcmpi</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>ColorMap<span class="token punctuation">,</span><span class="token string">'TurboMap'</span><span class="token punctuation">)</span>
    cMap <span class="token operator">=</span> TurboMap<span class="token punctuation">;</span>
<span class="token keyword">else</span>
    cMap<span class="token operator">=</span><span class="token function">colormap</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>ColorMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token function">colormap</span><span class="token punctuation">(</span>cMap<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">scatter</span><span class="token punctuation">(</span>ah<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>p<span class="token punctuation">.</span>mSize<span class="token punctuation">,</span>density<span class="token punctuation">,</span>p<span class="token punctuation">.</span>MarkerType<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> p<span class="token punctuation">.</span>AxisSquare
    axis square
<span class="token keyword">end</span>

<span class="token keyword">if</span> p<span class="token punctuation">.</span>ColorBar
    hc <span class="token operator">=</span> <span class="token function">colorbar</span><span class="token punctuation">(</span>ah<span class="token punctuation">)</span><span class="token punctuation">;</span>
    hc<span class="token punctuation">.</span>Label<span class="token punctuation">.</span>String <span class="token operator">=</span> <span class="token string">'Density'</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>


<span class="token keyword">end</span>

<span class="token keyword">function</span> p <span class="token operator">=</span> <span class="token function">parseArguments</span><span class="token punctuation">(</span>varargin<span class="token punctuation">)</span>
p <span class="token operator">=</span> inputParser<span class="token punctuation">;</span>

expectedMarkerType <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'.od&lt;&gt;^vs+*xph'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'MarkerType'</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">~</span><span class="token function">isempty</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strfind</span><span class="token punctuation">(</span>expectedMarkerType<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'mSize'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">isnumeric</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isscalar</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'ColorMap'</span><span class="token punctuation">,</span> <span class="token string">'TurboMap'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'logDensity'</span><span class="token punctuation">,</span> false<span class="token punctuation">,</span> <span class="token operator">@</span>islogical<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'AxisSquare'</span><span class="token punctuation">,</span> false<span class="token punctuation">,</span> <span class="token operator">@</span>islogical<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'SmoothDensity'</span><span class="token punctuation">,</span> true<span class="token punctuation">,</span> <span class="token operator">@</span>islogical<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'lambda'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">isnumeric</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isscalar</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'nBin_x'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">isnumeric</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isscalar</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'nBin_y'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">isnumeric</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isscalar</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'RemovePoints'</span><span class="token punctuation">,</span> true<span class="token punctuation">,</span> <span class="token operator">@</span>islogical<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'TargetAxes'</span><span class="token punctuation">,</span> false<span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">isgraphics</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token string">'axes'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'ColorBar'</span><span class="token punctuation">,</span> false<span class="token punctuation">,</span> <span class="token operator">@</span>islogical<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'MaxDens'</span><span class="token punctuation">,</span> <span class="token keyword">inf</span><span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">isnumeric</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isscalar</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addParameter</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token string">'PointsToExclude'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">isnumeric</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token function">parse</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>varargin<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p <span class="token operator">=</span> p<span class="token punctuation">.</span>Results<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token operator">~</span>p<span class="token punctuation">.</span>MarkerType <span class="token operator">==</span> <span class="token string">'.'</span>
    p<span class="token punctuation">.</span>mSize <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> Z <span class="token operator">=</span> <span class="token function">smooth1D</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>lambda<span class="token punctuation">)</span>
<span class="token comment">% The smoothing is based on the following reference:</span>
<span class="token comment">% Paul H. C. Eilers and Jelle J. Goeman</span>
<span class="token comment">% Enhancing scatterplots with smoothed densities</span>
<span class="token comment">% Bioinformatics, Mar 2004; 20: 623 - 628.</span>

<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
E <span class="token operator">=</span> <span class="token function">eye</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
D1 <span class="token operator">=</span> <span class="token function">diff</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
D2 <span class="token operator">=</span> <span class="token function">diff</span><span class="token punctuation">(</span>D1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
P <span class="token operator">=</span> lambda<span class="token operator">.^</span><span class="token number">2</span> <span class="token operator">.*</span> D2<span class="token operator">'</span><span class="token operator">*</span>D2 <span class="token operator">+</span> <span class="token number">2.</span><span class="token operator">*</span>lambda <span class="token operator">.*</span> D1<span class="token operator">'</span><span class="token operator">*</span>D1<span class="token punctuation">;</span>
Z <span class="token operator">=</span> <span class="token punctuation">(</span>E <span class="token operator">+</span> P<span class="token punctuation">)</span> <span class="token operator">\</span> X<span class="token punctuation">;</span>

<span class="token keyword">end</span>

<span class="token keyword">function</span> CMap <span class="token operator">=</span> TurboMap
<span class="token comment">% https://ai.googleblog.com/2019/08/turbo-improved-rainbow-colormap-for.html</span>

CMap <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0.18995</span>      <span class="token number">0.07176</span>      <span class="token number">0.23217</span>
    <span class="token number">0.19483</span>      <span class="token number">0.08339</span>      <span class="token number">0.26149</span>
    <span class="token number">0.19956</span>      <span class="token number">0.09498</span>      <span class="token number">0.29024</span>
    <span class="token number">0.20415</span>      <span class="token number">0.10652</span>      <span class="token number">0.31844</span>
    <span class="token number">0.2086</span>      <span class="token number">0.11802</span>      <span class="token number">0.34607</span>
    <span class="token number">0.21291</span>      <span class="token number">0.12947</span>      <span class="token number">0.37314</span>
    <span class="token number">0.21708</span>      <span class="token number">0.14087</span>      <span class="token number">0.39964</span>
    <span class="token number">0.22111</span>      <span class="token number">0.15223</span>      <span class="token number">0.42558</span>
    <span class="token number">0.225</span>      <span class="token number">0.16354</span>      <span class="token number">0.45096</span>
    <span class="token number">0.22875</span>      <span class="token number">0.17481</span>      <span class="token number">0.47578</span>
    <span class="token number">0.23236</span>      <span class="token number">0.18603</span>      <span class="token number">0.50004</span>
    <span class="token number">0.23582</span>       <span class="token number">0.1972</span>      <span class="token number">0.52373</span>
    <span class="token number">0.23915</span>      <span class="token number">0.20833</span>      <span class="token number">0.54686</span>
    <span class="token number">0.24234</span>      <span class="token number">0.21941</span>      <span class="token number">0.56942</span>
    <span class="token number">0.24539</span>      <span class="token number">0.23044</span>      <span class="token number">0.59142</span>
    <span class="token number">0.2483</span>      <span class="token number">0.24143</span>      <span class="token number">0.61286</span>
    <span class="token number">0.25107</span>      <span class="token number">0.25237</span>      <span class="token number">0.63374</span>
    <span class="token number">0.25369</span>      <span class="token number">0.26327</span>      <span class="token number">0.65406</span>
    <span class="token number">0.25618</span>      <span class="token number">0.27412</span>      <span class="token number">0.67381</span>
    <span class="token number">0.25853</span>      <span class="token number">0.28492</span>        <span class="token number">0.693</span>
    <span class="token number">0.26074</span>      <span class="token number">0.29568</span>      <span class="token number">0.71162</span>
    <span class="token number">0.2628</span>      <span class="token number">0.30639</span>      <span class="token number">0.72968</span>
    <span class="token number">0.26473</span>      <span class="token number">0.31706</span>      <span class="token number">0.74718</span>
    <span class="token number">0.26652</span>      <span class="token number">0.32768</span>      <span class="token number">0.76412</span>
    <span class="token number">0.26816</span>      <span class="token number">0.33825</span>       <span class="token number">0.7805</span>
    <span class="token number">0.26967</span>      <span class="token number">0.34878</span>      <span class="token number">0.79631</span>
    <span class="token number">0.27103</span>      <span class="token number">0.35926</span>      <span class="token number">0.81156</span>
    <span class="token number">0.27226</span>       <span class="token number">0.3697</span>      <span class="token number">0.82624</span>
    <span class="token number">0.27334</span>      <span class="token number">0.38008</span>      <span class="token number">0.84037</span>
    <span class="token number">0.27429</span>      <span class="token number">0.39043</span>      <span class="token number">0.85393</span>
    <span class="token number">0.27509</span>      <span class="token number">0.40072</span>      <span class="token number">0.86692</span>
    <span class="token number">0.27576</span>      <span class="token number">0.41097</span>      <span class="token number">0.87936</span>
    <span class="token number">0.27628</span>      <span class="token number">0.42118</span>      <span class="token number">0.89123</span>
    <span class="token number">0.27667</span>      <span class="token number">0.43134</span>      <span class="token number">0.90254</span>
    <span class="token number">0.27691</span>      <span class="token number">0.44145</span>      <span class="token number">0.91328</span>
    <span class="token number">0.27701</span>      <span class="token number">0.45152</span>      <span class="token number">0.92347</span>
    <span class="token number">0.27698</span>      <span class="token number">0.46153</span>      <span class="token number">0.93309</span>
    <span class="token number">0.2768</span>      <span class="token number">0.47151</span>      <span class="token number">0.94214</span>
    <span class="token number">0.27648</span>      <span class="token number">0.48144</span>      <span class="token number">0.95064</span>
    <span class="token number">0.27603</span>      <span class="token number">0.49132</span>      <span class="token number">0.95857</span>
    <span class="token number">0.27543</span>      <span class="token number">0.50115</span>      <span class="token number">0.96594</span>
    <span class="token number">0.27469</span>      <span class="token number">0.51094</span>      <span class="token number">0.97275</span>
    <span class="token number">0.27381</span>      <span class="token number">0.52069</span>      <span class="token number">0.97899</span>
    <span class="token number">0.27273</span>       <span class="token number">0.5304</span>      <span class="token number">0.98461</span>
    <span class="token number">0.27106</span>      <span class="token number">0.54015</span>       <span class="token number">0.9893</span>
    <span class="token number">0.26878</span>      <span class="token number">0.54995</span>      <span class="token number">0.99303</span>
    <span class="token number">0.26592</span>      <span class="token number">0.55979</span>      <span class="token number">0.99583</span>
    <span class="token number">0.26252</span>      <span class="token number">0.56967</span>      <span class="token number">0.99773</span>
    <span class="token number">0.25862</span>      <span class="token number">0.57958</span>      <span class="token number">0.99876</span>
    <span class="token number">0.25425</span>       <span class="token number">0.5895</span>      <span class="token number">0.99896</span>
    <span class="token number">0.24946</span>      <span class="token number">0.59943</span>      <span class="token number">0.99835</span>
    <span class="token number">0.24427</span>      <span class="token number">0.60937</span>      <span class="token number">0.99697</span>
    <span class="token number">0.23874</span>      <span class="token number">0.61931</span>      <span class="token number">0.99485</span>
    <span class="token number">0.23288</span>      <span class="token number">0.62923</span>      <span class="token number">0.99202</span>
    <span class="token number">0.22676</span>      <span class="token number">0.63913</span>      <span class="token number">0.98851</span>
    <span class="token number">0.22039</span>      <span class="token number">0.64901</span>      <span class="token number">0.98436</span>
    <span class="token number">0.21382</span>      <span class="token number">0.65886</span>      <span class="token number">0.97959</span>
    <span class="token number">0.20708</span>      <span class="token number">0.66866</span>      <span class="token number">0.97423</span>
    <span class="token number">0.20021</span>      <span class="token number">0.67842</span>      <span class="token number">0.96833</span>
    <span class="token number">0.19326</span>      <span class="token number">0.68812</span>       <span class="token number">0.9619</span>
    <span class="token number">0.18625</span>      <span class="token number">0.69775</span>      <span class="token number">0.95498</span>
    <span class="token number">0.17923</span>      <span class="token number">0.70732</span>      <span class="token number">0.94761</span>
    <span class="token number">0.17223</span>       <span class="token number">0.7168</span>      <span class="token number">0.93981</span>
    <span class="token number">0.16529</span>       <span class="token number">0.7262</span>      <span class="token number">0.93161</span>
    <span class="token number">0.15844</span>      <span class="token number">0.73551</span>      <span class="token number">0.92305</span>
    <span class="token number">0.15173</span>      <span class="token number">0.74472</span>      <span class="token number">0.91416</span>
    <span class="token number">0.14519</span>      <span class="token number">0.75381</span>      <span class="token number">0.90496</span>
    <span class="token number">0.13886</span>      <span class="token number">0.76279</span>       <span class="token number">0.8955</span>
    <span class="token number">0.13278</span>      <span class="token number">0.77165</span>       <span class="token number">0.8858</span>
    <span class="token number">0.12698</span>      <span class="token number">0.78037</span>       <span class="token number">0.8759</span>
    <span class="token number">0.12151</span>      <span class="token number">0.78896</span>      <span class="token number">0.86581</span>
    <span class="token number">0.11639</span>       <span class="token number">0.7974</span>      <span class="token number">0.85559</span>
    <span class="token number">0.11167</span>      <span class="token number">0.80569</span>      <span class="token number">0.84525</span>
    <span class="token number">0.10738</span>      <span class="token number">0.81381</span>      <span class="token number">0.83484</span>
    <span class="token number">0.10357</span>      <span class="token number">0.82177</span>      <span class="token number">0.82437</span>
    <span class="token number">0.10026</span>      <span class="token number">0.82955</span>      <span class="token number">0.81389</span>
    <span class="token number">0.0975</span>      <span class="token number">0.83714</span>      <span class="token number">0.80342</span>
    <span class="token number">0.09532</span>      <span class="token number">0.84455</span>      <span class="token number">0.79299</span>
    <span class="token number">0.09377</span>      <span class="token number">0.85175</span>      <span class="token number">0.78264</span>
    <span class="token number">0.09287</span>      <span class="token number">0.85875</span>       <span class="token number">0.7724</span>
    <span class="token number">0.09267</span>      <span class="token number">0.86554</span>       <span class="token number">0.7623</span>
    <span class="token number">0.0932</span>      <span class="token number">0.87211</span>      <span class="token number">0.75237</span>
    <span class="token number">0.09451</span>      <span class="token number">0.87844</span>      <span class="token number">0.74265</span>
    <span class="token number">0.09662</span>      <span class="token number">0.88454</span>      <span class="token number">0.73316</span>
    <span class="token number">0.09958</span>       <span class="token number">0.8904</span>      <span class="token number">0.72393</span>
    <span class="token number">0.10342</span>        <span class="token number">0.896</span>        <span class="token number">0.715</span>
    <span class="token number">0.10815</span>      <span class="token number">0.90142</span>      <span class="token number">0.70599</span>
    <span class="token number">0.11374</span>      <span class="token number">0.90673</span>      <span class="token number">0.69651</span>
    <span class="token number">0.12014</span>      <span class="token number">0.91193</span>       <span class="token number">0.6866</span>
    <span class="token number">0.12733</span>      <span class="token number">0.91701</span>      <span class="token number">0.67627</span>
    <span class="token number">0.13526</span>      <span class="token number">0.92197</span>      <span class="token number">0.66556</span>
    <span class="token number">0.14391</span>       <span class="token number">0.9268</span>      <span class="token number">0.65448</span>
    <span class="token number">0.15323</span>      <span class="token number">0.93151</span>      <span class="token number">0.64308</span>
    <span class="token number">0.16319</span>      <span class="token number">0.93609</span>      <span class="token number">0.63137</span>
    <span class="token number">0.17377</span>      <span class="token number">0.94053</span>      <span class="token number">0.61938</span>
    <span class="token number">0.18491</span>      <span class="token number">0.94484</span>      <span class="token number">0.60713</span>
    <span class="token number">0.19659</span>      <span class="token number">0.94901</span>      <span class="token number">0.59466</span>
    <span class="token number">0.20877</span>      <span class="token number">0.95304</span>      <span class="token number">0.58199</span>
    <span class="token number">0.22142</span>      <span class="token number">0.95692</span>      <span class="token number">0.56914</span>
    <span class="token number">0.23449</span>      <span class="token number">0.96065</span>      <span class="token number">0.55614</span>
    <span class="token number">0.24797</span>      <span class="token number">0.96423</span>      <span class="token number">0.54303</span>
    <span class="token number">0.2618</span>      <span class="token number">0.96765</span>      <span class="token number">0.52981</span>
    <span class="token number">0.27597</span>      <span class="token number">0.97092</span>      <span class="token number">0.51653</span>
    <span class="token number">0.29042</span>      <span class="token number">0.97403</span>      <span class="token number">0.50321</span>
    <span class="token number">0.30513</span>      <span class="token number">0.97697</span>      <span class="token number">0.48987</span>
    <span class="token number">0.32006</span>      <span class="token number">0.97974</span>      <span class="token number">0.47654</span>
    <span class="token number">0.33517</span>      <span class="token number">0.98234</span>      <span class="token number">0.46325</span>
    <span class="token number">0.35043</span>      <span class="token number">0.98477</span>      <span class="token number">0.45002</span>
    <span class="token number">0.36581</span>      <span class="token number">0.98702</span>      <span class="token number">0.43688</span>
    <span class="token number">0.38127</span>      <span class="token number">0.98909</span>      <span class="token number">0.42386</span>
    <span class="token number">0.39678</span>      <span class="token number">0.99098</span>      <span class="token number">0.41098</span>
    <span class="token number">0.41229</span>      <span class="token number">0.99268</span>      <span class="token number">0.39826</span>
    <span class="token number">0.42778</span>      <span class="token number">0.99419</span>      <span class="token number">0.38575</span>
    <span class="token number">0.44321</span>      <span class="token number">0.99551</span>      <span class="token number">0.37345</span>
    <span class="token number">0.45854</span>      <span class="token number">0.99663</span>       <span class="token number">0.3614</span>
    <span class="token number">0.47375</span>      <span class="token number">0.99755</span>      <span class="token number">0.34963</span>
    <span class="token number">0.48879</span>      <span class="token number">0.99828</span>      <span class="token number">0.33816</span>
    <span class="token number">0.50362</span>      <span class="token number">0.99879</span>      <span class="token number">0.32701</span>
    <span class="token number">0.51822</span>       <span class="token number">0.9991</span>      <span class="token number">0.31622</span>
    <span class="token number">0.53255</span>      <span class="token number">0.99919</span>      <span class="token number">0.30581</span>
    <span class="token number">0.54658</span>      <span class="token number">0.99907</span>      <span class="token number">0.29581</span>
    <span class="token number">0.56026</span>      <span class="token number">0.99873</span>      <span class="token number">0.28623</span>
    <span class="token number">0.57357</span>      <span class="token number">0.99817</span>      <span class="token number">0.27712</span>
    <span class="token number">0.58646</span>      <span class="token number">0.99739</span>      <span class="token number">0.26849</span>
    <span class="token number">0.59891</span>      <span class="token number">0.99638</span>      <span class="token number">0.26038</span>
    <span class="token number">0.61088</span>      <span class="token number">0.99514</span>       <span class="token number">0.2528</span>
    <span class="token number">0.62233</span>      <span class="token number">0.99366</span>      <span class="token number">0.24579</span>
    <span class="token number">0.63323</span>      <span class="token number">0.99195</span>      <span class="token number">0.23937</span>
    <span class="token number">0.64362</span>      <span class="token number">0.98999</span>      <span class="token number">0.23356</span>
    <span class="token number">0.65394</span>      <span class="token number">0.98775</span>      <span class="token number">0.22835</span>
    <span class="token number">0.66428</span>      <span class="token number">0.98524</span>       <span class="token number">0.2237</span>
    <span class="token number">0.67462</span>      <span class="token number">0.98246</span>       <span class="token number">0.2196</span>
    <span class="token number">0.68494</span>      <span class="token number">0.97941</span>      <span class="token number">0.21602</span>
    <span class="token number">0.69525</span>       <span class="token number">0.9761</span>      <span class="token number">0.21294</span>
    <span class="token number">0.70553</span>      <span class="token number">0.97255</span>      <span class="token number">0.21032</span>
    <span class="token number">0.71577</span>      <span class="token number">0.96875</span>      <span class="token number">0.20815</span>
    <span class="token number">0.72596</span>       <span class="token number">0.9647</span>       <span class="token number">0.2064</span>
    <span class="token number">0.7361</span>      <span class="token number">0.96043</span>      <span class="token number">0.20504</span>
    <span class="token number">0.74617</span>      <span class="token number">0.95593</span>      <span class="token number">0.20406</span>
    <span class="token number">0.75617</span>      <span class="token number">0.95121</span>      <span class="token number">0.20343</span>
    <span class="token number">0.76608</span>      <span class="token number">0.94627</span>      <span class="token number">0.20311</span>
    <span class="token number">0.77591</span>      <span class="token number">0.94113</span>       <span class="token number">0.2031</span>
    <span class="token number">0.78563</span>      <span class="token number">0.93579</span>      <span class="token number">0.20336</span>
    <span class="token number">0.79524</span>      <span class="token number">0.93025</span>      <span class="token number">0.20386</span>
    <span class="token number">0.80473</span>      <span class="token number">0.92452</span>      <span class="token number">0.20459</span>
    <span class="token number">0.8141</span>      <span class="token number">0.91861</span>      <span class="token number">0.20552</span>
    <span class="token number">0.82333</span>      <span class="token number">0.91253</span>      <span class="token number">0.20663</span>
    <span class="token number">0.83241</span>      <span class="token number">0.90627</span>      <span class="token number">0.20788</span>
    <span class="token number">0.84133</span>      <span class="token number">0.89986</span>      <span class="token number">0.20926</span>
    <span class="token number">0.8501</span>      <span class="token number">0.89328</span>      <span class="token number">0.21074</span>
    <span class="token number">0.85868</span>      <span class="token number">0.88655</span>       <span class="token number">0.2123</span>
    <span class="token number">0.86709</span>      <span class="token number">0.87968</span>      <span class="token number">0.21391</span>
    <span class="token number">0.8753</span>      <span class="token number">0.87267</span>      <span class="token number">0.21555</span>
    <span class="token number">0.88331</span>      <span class="token number">0.86553</span>      <span class="token number">0.21719</span>
    <span class="token number">0.89112</span>      <span class="token number">0.85826</span>       <span class="token number">0.2188</span>
    <span class="token number">0.8987</span>      <span class="token number">0.85087</span>      <span class="token number">0.22038</span>
    <span class="token number">0.90605</span>      <span class="token number">0.84337</span>      <span class="token number">0.22188</span>
    <span class="token number">0.91317</span>      <span class="token number">0.83576</span>      <span class="token number">0.22328</span>
    <span class="token number">0.92004</span>      <span class="token number">0.82806</span>      <span class="token number">0.22456</span>
    <span class="token number">0.92666</span>      <span class="token number">0.82025</span>       <span class="token number">0.2257</span>
    <span class="token number">0.93301</span>      <span class="token number">0.81236</span>      <span class="token number">0.22667</span>
    <span class="token number">0.93909</span>      <span class="token number">0.80439</span>      <span class="token number">0.22744</span>
    <span class="token number">0.94489</span>      <span class="token number">0.79634</span>        <span class="token number">0.228</span>
    <span class="token number">0.95039</span>      <span class="token number">0.78823</span>      <span class="token number">0.22831</span>
    <span class="token number">0.9556</span>      <span class="token number">0.78005</span>      <span class="token number">0.22836</span>
    <span class="token number">0.96049</span>      <span class="token number">0.77181</span>      <span class="token number">0.22811</span>
    <span class="token number">0.96507</span>      <span class="token number">0.76352</span>      <span class="token number">0.22754</span>
    <span class="token number">0.96931</span>      <span class="token number">0.75519</span>      <span class="token number">0.22663</span>
    <span class="token number">0.97323</span>      <span class="token number">0.74682</span>      <span class="token number">0.22536</span>
    <span class="token number">0.97679</span>      <span class="token number">0.73842</span>      <span class="token number">0.22369</span>
    <span class="token number">0.98</span>         <span class="token number">0.73</span>      <span class="token number">0.22161</span>
    <span class="token number">0.98289</span>       <span class="token number">0.7214</span>      <span class="token number">0.21918</span>
    <span class="token number">0.98549</span>       <span class="token number">0.7125</span>       <span class="token number">0.2165</span>
    <span class="token number">0.98781</span>       <span class="token number">0.7033</span>      <span class="token number">0.21358</span>
    <span class="token number">0.98986</span>      <span class="token number">0.69382</span>      <span class="token number">0.21043</span>
    <span class="token number">0.99163</span>      <span class="token number">0.68408</span>      <span class="token number">0.20706</span>
    <span class="token number">0.99314</span>      <span class="token number">0.67408</span>      <span class="token number">0.20348</span>
    <span class="token number">0.99438</span>      <span class="token number">0.66386</span>      <span class="token number">0.19971</span>
    <span class="token number">0.99535</span>      <span class="token number">0.65341</span>      <span class="token number">0.19577</span>
    <span class="token number">0.99607</span>      <span class="token number">0.64277</span>      <span class="token number">0.19165</span>
    <span class="token number">0.99654</span>      <span class="token number">0.63193</span>      <span class="token number">0.18738</span>
    <span class="token number">0.99675</span>      <span class="token number">0.62093</span>      <span class="token number">0.18297</span>
    <span class="token number">0.99672</span>      <span class="token number">0.60977</span>      <span class="token number">0.17842</span>
    <span class="token number">0.99644</span>      <span class="token number">0.59846</span>      <span class="token number">0.17376</span>
    <span class="token number">0.99593</span>      <span class="token number">0.58703</span>      <span class="token number">0.16899</span>
    <span class="token number">0.99517</span>      <span class="token number">0.57549</span>      <span class="token number">0.16412</span>
    <span class="token number">0.99419</span>      <span class="token number">0.56386</span>      <span class="token number">0.15918</span>
    <span class="token number">0.99297</span>      <span class="token number">0.55214</span>      <span class="token number">0.15417</span>
    <span class="token number">0.99153</span>      <span class="token number">0.54036</span>       <span class="token number">0.1491</span>
    <span class="token number">0.98987</span>      <span class="token number">0.52854</span>      <span class="token number">0.14398</span>
    <span class="token number">0.98799</span>      <span class="token number">0.51667</span>      <span class="token number">0.13883</span>
    <span class="token number">0.9859</span>      <span class="token number">0.50479</span>      <span class="token number">0.13367</span>
    <span class="token number">0.9836</span>      <span class="token number">0.49291</span>      <span class="token number">0.12849</span>
    <span class="token number">0.98108</span>      <span class="token number">0.48104</span>      <span class="token number">0.12332</span>
    <span class="token number">0.97837</span>       <span class="token number">0.4692</span>      <span class="token number">0.11817</span>
    <span class="token number">0.97545</span>       <span class="token number">0.4574</span>      <span class="token number">0.11305</span>
    <span class="token number">0.97234</span>      <span class="token number">0.44565</span>      <span class="token number">0.10797</span>
    <span class="token number">0.96904</span>      <span class="token number">0.43399</span>      <span class="token number">0.10294</span>
    <span class="token number">0.96555</span>      <span class="token number">0.42241</span>      <span class="token number">0.09798</span>
    <span class="token number">0.96187</span>      <span class="token number">0.41093</span>       <span class="token number">0.0931</span>
    <span class="token number">0.95801</span>      <span class="token number">0.39958</span>      <span class="token number">0.08831</span>
    <span class="token number">0.95398</span>      <span class="token number">0.38836</span>      <span class="token number">0.08362</span>
    <span class="token number">0.94977</span>      <span class="token number">0.37729</span>      <span class="token number">0.07905</span>
    <span class="token number">0.94538</span>      <span class="token number">0.36638</span>      <span class="token number">0.07461</span>
    <span class="token number">0.94084</span>      <span class="token number">0.35566</span>      <span class="token number">0.07031</span>
    <span class="token number">0.93612</span>      <span class="token number">0.34513</span>      <span class="token number">0.06616</span>
    <span class="token number">0.93125</span>      <span class="token number">0.33482</span>      <span class="token number">0.06218</span>
    <span class="token number">0.92623</span>      <span class="token number">0.32473</span>      <span class="token number">0.05837</span>
    <span class="token number">0.92105</span>      <span class="token number">0.31489</span>      <span class="token number">0.05475</span>
    <span class="token number">0.91572</span>       <span class="token number">0.3053</span>      <span class="token number">0.05134</span>
    <span class="token number">0.91024</span>      <span class="token number">0.29599</span>      <span class="token number">0.04814</span>
    <span class="token number">0.90463</span>      <span class="token number">0.28696</span>      <span class="token number">0.04516</span>
    <span class="token number">0.89888</span>      <span class="token number">0.27824</span>      <span class="token number">0.04243</span>
    <span class="token number">0.89298</span>      <span class="token number">0.26981</span>      <span class="token number">0.03993</span>
    <span class="token number">0.88691</span>      <span class="token number">0.26152</span>      <span class="token number">0.03753</span>
    <span class="token number">0.88066</span>      <span class="token number">0.25334</span>      <span class="token number">0.03521</span>
    <span class="token number">0.87422</span>      <span class="token number">0.24526</span>      <span class="token number">0.03297</span>
    <span class="token number">0.8676</span>       <span class="token number">0.2373</span>      <span class="token number">0.03082</span>
    <span class="token number">0.86079</span>      <span class="token number">0.22945</span>      <span class="token number">0.02875</span>
    <span class="token number">0.8538</span>       <span class="token number">0.2217</span>      <span class="token number">0.02677</span>
    <span class="token number">0.84662</span>      <span class="token number">0.21407</span>      <span class="token number">0.02487</span>
    <span class="token number">0.83926</span>      <span class="token number">0.20654</span>      <span class="token number">0.02305</span>
    <span class="token number">0.83172</span>      <span class="token number">0.19912</span>      <span class="token number">0.02131</span>
    <span class="token number">0.82399</span>      <span class="token number">0.19182</span>      <span class="token number">0.01966</span>
    <span class="token number">0.81608</span>      <span class="token number">0.18462</span>      <span class="token number">0.01809</span>
    <span class="token number">0.80799</span>      <span class="token number">0.17753</span>       <span class="token number">0.0166</span>
    <span class="token number">0.79971</span>      <span class="token number">0.17055</span>       <span class="token number">0.0152</span>
    <span class="token number">0.79125</span>      <span class="token number">0.16368</span>      <span class="token number">0.01387</span>
    <span class="token number">0.7826</span>      <span class="token number">0.15693</span>      <span class="token number">0.01264</span>
    <span class="token number">0.77377</span>      <span class="token number">0.15028</span>      <span class="token number">0.01148</span>
    <span class="token number">0.76476</span>      <span class="token number">0.14374</span>      <span class="token number">0.01041</span>
    <span class="token number">0.75556</span>      <span class="token number">0.13731</span>      <span class="token number">0.00942</span>
    <span class="token number">0.74617</span>      <span class="token number">0.13098</span>      <span class="token number">0.00851</span>
    <span class="token number">0.73661</span>      <span class="token number">0.12477</span>      <span class="token number">0.00769</span>
    <span class="token number">0.72686</span>      <span class="token number">0.11867</span>      <span class="token number">0.00695</span>
    <span class="token number">0.71692</span>      <span class="token number">0.11268</span>      <span class="token number">0.00629</span>
    <span class="token number">0.7068</span>       <span class="token number">0.1068</span>      <span class="token number">0.00571</span>
    <span class="token number">0.6965</span>      <span class="token number">0.10102</span>      <span class="token number">0.00522</span>
    <span class="token number">0.68602</span>      <span class="token number">0.09536</span>      <span class="token number">0.00481</span>
    <span class="token number">0.67535</span>       <span class="token number">0.0898</span>      <span class="token number">0.00449</span>
    <span class="token number">0.66449</span>      <span class="token number">0.08436</span>      <span class="token number">0.00424</span>
    <span class="token number">0.65345</span>      <span class="token number">0.07902</span>      <span class="token number">0.00408</span>
    <span class="token number">0.64223</span>       <span class="token number">0.0738</span>      <span class="token number">0.00401</span>
    <span class="token number">0.63082</span>      <span class="token number">0.06868</span>      <span class="token number">0.00401</span>
    <span class="token number">0.61923</span>      <span class="token number">0.06367</span>       <span class="token number">0.0041</span>
    <span class="token number">0.60746</span>      <span class="token number">0.05878</span>      <span class="token number">0.00427</span>
    <span class="token number">0.5955</span>      <span class="token number">0.05399</span>      <span class="token number">0.00453</span>
    <span class="token number">0.58336</span>      <span class="token number">0.04931</span>      <span class="token number">0.00486</span>
    <span class="token number">0.57103</span>      <span class="token number">0.04474</span>      <span class="token number">0.00529</span>
    <span class="token number">0.55852</span>      <span class="token number">0.04028</span>      <span class="token number">0.00579</span>
    <span class="token number">0.54583</span>      <span class="token number">0.03593</span>      <span class="token number">0.00638</span>
    <span class="token number">0.53295</span>      <span class="token number">0.03169</span>      <span class="token number">0.00705</span>
    <span class="token number">0.51989</span>      <span class="token number">0.02756</span>       <span class="token number">0.0078</span>
    <span class="token number">0.50664</span>      <span class="token number">0.02354</span>      <span class="token number">0.00863</span>
    <span class="token number">0.49321</span>      <span class="token number">0.01963</span>      <span class="token number">0.00955</span>
    <span class="token number">0.4796</span>      <span class="token number">0.01583</span>      <span class="token number">0.01055</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>运行结果：</p>
</blockquote>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218161855.png" style="zoom:67%;">

<h4 id="second-ndbc-station-download-NC-analyse-1"><a href="#second-ndbc-station-download-NC-analyse-1" class="headerlink" title="second, ndbc_station_download_NC_analyse"></a>second, ndbc_station_download_NC_analyse</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-18 first verison.</span>
<span class="token comment">%    2022-02-18 second, ndbc_station_download_NC_analyse</span>

clc<span class="token punctuation">,</span> clear all
<span class="token comment">%load ndbc_station_download_NC.mat</span>
load ndbc_station_download_NC_analyse<span class="token punctuation">;</span> ndbc_station_download_NC <span class="token operator">=</span> ndbc_station_download_NC_analyse<span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'已加载ndbc_station_download_NC.mat！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">%% 时间-WVHT数据，一个小时一个数据</span>
<span class="token comment">%-----------------------------</span>
<span class="token comment">%参数</span>
path_fig <span class="token operator">=</span> <span class="token string">'.\fig\'</span><span class="token punctuation">;</span> <span class="token comment">%%https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop</span>
<span class="token comment">%-----------------------------</span>

<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token comment">%1:1:size(ndbc_station_download_NC,1)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'时间-WVHT数据分析，一个小时一个数据：'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% 去除ndbc数据table无效数据所在行</span>
    ndbc_table <span class="token operator">=</span> ndbc_station_download_NC<span class="token punctuation">.</span>station_historyData_SM<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">%table</span>
    ndbc_WVHT1 <span class="token operator">=</span> <span class="token function">cell2mat</span><span class="token punctuation">(</span>ndbc_table<span class="token punctuation">.</span><span class="token function">WVHT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%double</span>
    ndbc_time1 <span class="token operator">=</span> ndbc_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm<span class="token punctuation">;</span> <span class="token comment">% datetime</span>
    tf1 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_WVHT1<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_WVHT1<span class="token operator">&lt;</span><span class="token number">99</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    ndbc_time2 <span class="token operator">=</span> <span class="token function">ndbc_time1</span><span class="token punctuation">(</span>tf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_WVHT2 <span class="token operator">=</span> <span class="token function">ndbc_WVHT1</span><span class="token punctuation">(</span>tf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已去除ndbc数据table无效数据所在行；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% ndbc数据，一个小时一个数据</span>
    <span class="token comment">% 超过30分钟，进一个小时</span>
    tf2 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&gt;</span><span class="token number">30</span> <span class="token operator">&amp;</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&lt;</span><span class="token number">60</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% case1, 秒数都是0，因为ndbc不包含秒数信息；</span>
    temp <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf2<span class="token punctuation">)</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Hour <span class="token operator">=</span> temp<span class="token punctuation">.</span>Hour<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf2<span class="token punctuation">)</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token comment">% 少于30分钟，小时不变</span>
    tf3 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&lt;</span><span class="token number">30</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% case2；</span>
    temp <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf3<span class="token punctuation">)</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf3<span class="token punctuation">)</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token comment">% 年、月、日、时相等的datetime处理：</span>
    count <span class="token operator">=</span> <span class="token function">tabulate</span><span class="token punctuation">(</span>ndbc_time2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 统计数列中每个元素出现的次数</span>
    tf4 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">cell2mat</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 元素次数超过1次</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>tf4<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">%元素次数超过1次的元素进行平均化处理</span>
        temp <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span>count<span class="token punctuation">{</span><span class="token function">tf4</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tf5 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>ndbc_time2<span class="token operator">==</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span><span class="token function">tf5</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span>tf5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%平均化处理</span>
        <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span><span class="token function">tf5</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span> <span class="token comment">%无效数据</span>
        <span class="token comment">% ndbc_WVHT2(tf5)</span>
    <span class="token keyword">end</span>
    tf6 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_WVHT2<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_WVHT2<span class="token operator">&lt;</span><span class="token number">99</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_time3 <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf6<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% unique(ndbc_time3); %通过维数不变，发现每一个元素都是唯一的;</span>
    ndbc_WVHT3 <span class="token operator">=</span> <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span>tf6<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已实现ndbc数据，一个小时一个数据，（通过了unique(ndbc_time3)的检验）；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% nc 数据，一个小时一个数据；</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已确定nc数据，一个小时一个数据；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% ndbc 和 nc 小时数据匹配；</span>
    <span class="token comment">% 组合ndbc和nc的数据</span>
    temp <span class="token operator">=</span> ndbc_station_download_NC<span class="token punctuation">.</span>nc_time_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    ndbc_nc_time <span class="token operator">=</span> <span class="token punctuation">[</span>ndbc_time3<span class="token punctuation">;</span>temp<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%ndbc 和 nc的datetime数据组合</span>
    ndbc_nc_WVHT <span class="token operator">=</span> <span class="token punctuation">[</span>ndbc_WVHT3<span class="token punctuation">;</span>temp<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%ndbc 和 nc的WVHT数据组合</span>
    <span class="token comment">% 匹配</span>
    ndbc_nc_match_WVHT <span class="token operator">=</span> table<span class="token punctuation">;</span>
    count <span class="token operator">=</span> <span class="token function">tabulate</span><span class="token punctuation">(</span>ndbc_nc_time<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%匹配的时间元素，会出现2次，而且不可能超过两次；</span>
    tf7 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">cell2mat</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 元素次数超过1次</span>
    temp1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储时间</span>
    temp2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储ndbc数据</span>
    temp3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储nc数据</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>tf7<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        temp <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span>count<span class="token punctuation">{</span><span class="token function">tf7</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tf8 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>ndbc_nc_time<span class="token operator">==</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp1 <span class="token operator">=</span> <span class="token punctuation">[</span>temp1<span class="token punctuation">;</span>temp<span class="token punctuation">]</span><span class="token punctuation">;</span>
        temp2 <span class="token operator">=</span> <span class="token punctuation">[</span>temp2<span class="token punctuation">;</span><span class="token function">ndbc_nc_WVHT</span><span class="token punctuation">(</span><span class="token function">tf8</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        temp3 <span class="token operator">=</span> <span class="token punctuation">[</span>temp3<span class="token punctuation">;</span><span class="token function">ndbc_nc_WVHT</span><span class="token punctuation">(</span><span class="token function">tf8</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>time <span class="token operator">=</span> temp1<span class="token punctuation">;</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc <span class="token operator">=</span> temp2<span class="token punctuation">;</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc <span class="token operator">=</span> temp3<span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已对 ndbc 和 nc 小时数据匹配；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% 匹配数据分析</span>
    <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>tf7<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">3</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      发现'</span><span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'匹配的数据不足3个'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ndbc_station_download_NC<span class="token punctuation">.</span>ndbc_nc_match_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      发现'</span><span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'匹配的数据不足3个'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token comment">% 时序图</span>
        f <span class="token operator">=</span> <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">plot</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>time<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        hold on<span class="token punctuation">;</span> <span class="token function">plot</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>time<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">%close(f1)</span>
        <span class="token function">savefig</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-时序图'</span><span class="token punctuation">,</span><span class="token string">'.fig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>TimeSeriesChart<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'openfig("'</span><span class="token punctuation">,</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-时序图'</span><span class="token punctuation">,</span><span class="token string">'.fig")'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token comment">%openfig('1.fig');</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已简单画出时序图，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">% rmse, bias, R, SI, PE</span>
        error <span class="token operator">=</span> ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token operator">-</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">;</span>
        rmse <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span>error<span class="token operator">.*</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bias <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">,</span> ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        PE <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token operator">./</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">;</span>
        SI <span class="token operator">=</span> rmse<span class="token operator">/</span><span class="token function">mean</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>rmse<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> rmse<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>bias<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> bias<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>r<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>PE<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> PE<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>SI<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> SI<span class="token punctuation">;</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已计算RMSE, BIAS, R, SI, PE，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        
        
        <span class="token comment">% 散点图</span>
        <span class="token punctuation">[</span>f<span class="token punctuation">,</span>de<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">DensScat</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">colormap</span><span class="token punctuation">(</span><span class="token string">'Jet'</span><span class="token punctuation">)</span>
        hc <span class="token operator">=</span> colorbar<span class="token punctuation">;</span>
        <span class="token function">savefig</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-散点图'</span><span class="token punctuation">,</span><span class="token string">'.fig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>ScatterChart<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'openfig("'</span><span class="token punctuation">,</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-散点图'</span><span class="token punctuation">,</span><span class="token string">'.fig")'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已简单画出散点图，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">% 保存到总的table</span>
        ndbc_station_download_NC<span class="token punctuation">.</span>ndbc_nc_match_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> ndbc_nc_match_WVHT<span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    
    
<span class="token keyword">end</span>

<span class="token comment">%%</span>
<span class="token comment">%ndbc_station_download_NC_analyse = ndbc_station_download_NC;</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="third-function-path-save-图床思想"><a href="#third-function-path-save-图床思想" class="headerlink" title="third, function, path_save, 图床思想"></a>third, function, path_save, 图床思想</h4><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> <span class="token punctuation">[</span>ndbc_station_download_NC<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download_NC_analyse</span><span class="token punctuation">(</span>ndbc_station_download_NC<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span>
<span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-18 first verison.</span>
<span class="token comment">%    2022-02-18 second, ndbc_station_download_NC_analyse</span>
<span class="token comment">%    2022-02-19 third, function, path_save.</span>
<span class="token comment">%    2022-02-19        图床思想</span>

<span class="token comment">%clc, clear all</span>
<span class="token comment">%load ndbc_station_download_NC.mat</span>
<span class="token comment">%load ndbc_station_download_NC_analyse; ndbc_station_download_NC = ndbc_station_download_NC_analyse;</span>
<span class="token comment">%disp('已加载ndbc_station_download_NC.mat！'); pause(1);</span>

<span class="token comment">%%</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'-----------------------ndbc_station_download_NC_analyse'</span><span class="token punctuation">)</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>


<span class="token comment">%% 时间-WVHT数据，一个小时一个数据</span>
<span class="token comment">%-----------------------------</span>
<span class="token comment">%参数</span>
path_fig <span class="token operator">=</span> <span class="token string">'.\fig\'</span><span class="token punctuation">;</span> <span class="token comment">%%https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop</span>
<span class="token comment">%-----------------------------</span>

<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span>station_tf_download<span class="token comment">%1:1:size(ndbc_station_download_NC,1)</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'时间-WVHT数据分析，一个小时一个数据：'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% 去除ndbc数据table无效数据所在行</span>
    temp <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span>path_save<span class="token punctuation">,</span><span class="token string">'station_historyData_SM\'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'.mat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">load</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% temp 中仅有 buoy_table_All 变量；</span>
    <span class="token comment">%ndbc_table = ndbc_station_download_NC.station_historyData_SM{i,1}; %table</span>
    ndbc_table <span class="token operator">=</span> buoy_table_All<span class="token punctuation">;</span>
    ndbc_WVHT1 <span class="token operator">=</span> <span class="token function">cell2mat</span><span class="token punctuation">(</span>ndbc_table<span class="token punctuation">.</span><span class="token function">WVHT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%double</span>
    ndbc_time1 <span class="token operator">=</span> ndbc_table<span class="token punctuation">.</span>YY_MM_DD_hh_mm<span class="token punctuation">;</span> <span class="token comment">% datetime</span>
    tf1 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_WVHT1<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_WVHT1<span class="token operator">&lt;</span><span class="token number">99</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    ndbc_time2 <span class="token operator">=</span> <span class="token function">ndbc_time1</span><span class="token punctuation">(</span>tf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_WVHT2 <span class="token operator">=</span> <span class="token function">ndbc_WVHT1</span><span class="token punctuation">(</span>tf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已去除ndbc数据table无效数据所在行；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% ndbc数据，一个小时一个数据</span>
    <span class="token comment">% 超过30分钟，进一个小时</span>
    tf2 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&gt;</span><span class="token number">30</span> <span class="token operator">&amp;</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&lt;</span><span class="token number">60</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% case1, 秒数都是0，因为ndbc不包含秒数信息；</span>
    temp <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf2<span class="token punctuation">)</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Hour <span class="token operator">=</span> temp<span class="token punctuation">.</span>Hour<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf2<span class="token punctuation">)</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token comment">% 少于30分钟，小时不变</span>
    tf3 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_time2<span class="token punctuation">.</span>Minute<span class="token operator">&lt;</span><span class="token number">30</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% case2；</span>
    temp <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf3<span class="token punctuation">)</span><span class="token punctuation">;</span> temp<span class="token punctuation">.</span>Minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf3<span class="token punctuation">)</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
    <span class="token comment">% 年、月、日、时相等的datetime处理：</span>
    count <span class="token operator">=</span> <span class="token function">tabulate</span><span class="token punctuation">(</span>ndbc_time2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 统计数列中每个元素出现的次数</span>
    tf4 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">cell2mat</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 元素次数超过1次</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>tf4<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">%元素次数超过1次的元素进行平均化处理</span>
        temp <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span>count<span class="token punctuation">{</span><span class="token function">tf4</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tf5 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>ndbc_time2<span class="token operator">==</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span><span class="token function">tf5</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span>tf5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%平均化处理</span>
        <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span><span class="token function">tf5</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span> <span class="token comment">%无效数据</span>
        <span class="token comment">% ndbc_WVHT2(tf5)</span>
    <span class="token keyword">end</span>
    tf6 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span> ndbc_WVHT2<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;</span> ndbc_WVHT2<span class="token operator">&lt;</span><span class="token number">99</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    ndbc_time3 <span class="token operator">=</span> <span class="token function">ndbc_time2</span><span class="token punctuation">(</span>tf6<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% unique(ndbc_time3); %通过维数不变，发现每一个元素都是唯一的;</span>
    ndbc_WVHT3 <span class="token operator">=</span> <span class="token function">ndbc_WVHT2</span><span class="token punctuation">(</span>tf6<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已实现ndbc数据，一个小时一个数据，（通过了unique(ndbc_time3)的检验）；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% nc 数据，一个小时一个数据；</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已确定nc数据，一个小时一个数据；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% ndbc 和 nc 小时数据匹配；</span>
    <span class="token comment">% 组合ndbc和nc的数据</span>
    temp <span class="token operator">=</span> ndbc_station_download_NC<span class="token punctuation">.</span>nc_time_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    ndbc_nc_time <span class="token operator">=</span> <span class="token punctuation">[</span>ndbc_time3<span class="token punctuation">;</span>temp<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%ndbc 和 nc的datetime数据组合</span>
    ndbc_nc_WVHT <span class="token operator">=</span> <span class="token punctuation">[</span>ndbc_WVHT3<span class="token punctuation">;</span>temp<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%ndbc 和 nc的WVHT数据组合</span>
    <span class="token comment">% 匹配</span>
    ndbc_nc_match_WVHT <span class="token operator">=</span> table<span class="token punctuation">;</span>
    count <span class="token operator">=</span> <span class="token function">tabulate</span><span class="token punctuation">(</span>ndbc_nc_time<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%匹配的时间元素，会出现2次，而且不可能超过两次；</span>
    tf7 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">cell2mat</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 元素次数超过1次</span>
    temp1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储时间</span>
    temp2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储ndbc数据</span>
    temp3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%存储nc数据</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>tf7<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        temp <span class="token operator">=</span> <span class="token function">datetime</span><span class="token punctuation">(</span>count<span class="token punctuation">{</span><span class="token function">tf7</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tf8 <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>ndbc_nc_time<span class="token operator">==</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp1 <span class="token operator">=</span> <span class="token punctuation">[</span>temp1<span class="token punctuation">;</span>temp<span class="token punctuation">]</span><span class="token punctuation">;</span>
        temp2 <span class="token operator">=</span> <span class="token punctuation">[</span>temp2<span class="token punctuation">;</span><span class="token function">ndbc_nc_WVHT</span><span class="token punctuation">(</span><span class="token function">tf8</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        temp3 <span class="token operator">=</span> <span class="token punctuation">[</span>temp3<span class="token punctuation">;</span><span class="token function">ndbc_nc_WVHT</span><span class="token punctuation">(</span><span class="token function">tf8</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>time <span class="token operator">=</span> temp1<span class="token punctuation">;</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc <span class="token operator">=</span> temp2<span class="token punctuation">;</span>
    ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc <span class="token operator">=</span> temp3<span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已对 ndbc 和 nc 小时数据匹配；'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%% 匹配数据分析</span>
    <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>tf7<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">3</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      发现'</span><span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'匹配的数据不足3个'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">pause</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ndbc_station_download_NC<span class="token punctuation">.</span>ndbc_nc_match_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      发现'</span><span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'匹配的数据不足3个'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token comment">% 时序图</span>
        f <span class="token operator">=</span> <span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">plot</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>time<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        hold on<span class="token punctuation">;</span> <span class="token function">plot</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>time<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">%close(f1)</span>
        <span class="token function">savefig</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-时序图'</span><span class="token punctuation">,</span><span class="token string">'.fig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%https://ww2.mathworks.cn/help/matlab/ref/savefig.html?s_tid=gn_loc_drop</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>TimeSeriesChart<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'openfig("'</span><span class="token punctuation">,</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-时序图'</span><span class="token punctuation">,</span><span class="token string">'.fig")'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token comment">%openfig('1.fig');</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已简单画出时序图，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">% rmse, bias, R, SI, PE</span>
        error <span class="token operator">=</span> ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token operator">-</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">;</span>
        rmse <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span>error<span class="token operator">.*</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bias <span class="token operator">=</span> <span class="token function">mean</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">,</span> ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        PE <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token operator">./</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">;</span>
        SI <span class="token operator">=</span> rmse<span class="token operator">/</span><span class="token function">mean</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>rmse<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> rmse<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>bias<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> bias<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>r<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>PE<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> PE<span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>SI<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> SI<span class="token punctuation">;</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已计算RMSE, BIAS, R, SI, PE，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        
        
        <span class="token comment">% 散点图</span>
        <span class="token punctuation">[</span>f<span class="token punctuation">,</span>de<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">DensScat</span><span class="token punctuation">(</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>ndbc<span class="token punctuation">,</span>ndbc_nc_match_WVHT<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">colormap</span><span class="token punctuation">(</span><span class="token string">'Jet'</span><span class="token punctuation">)</span>
        hc <span class="token operator">=</span> colorbar<span class="token punctuation">;</span>
        <span class="token function">savefig</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token function">strcat</span><span class="token punctuation">(</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-散点图'</span><span class="token punctuation">,</span><span class="token string">'.fig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ndbc_nc_match_WVHT<span class="token punctuation">.</span>ScatterChart<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'openfig("'</span><span class="token punctuation">,</span>path_fig<span class="token punctuation">,</span>ndbc_station_download_NC<span class="token punctuation">.</span>station_ID<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'一小时时间-WVHT数据-散点图'</span><span class="token punctuation">,</span><span class="token string">'.fig")'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'      已简单画出散点图，并保存;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">% 保存到总的table</span>
        ndbc_station_download_NC<span class="token punctuation">.</span>ndbc_nc_match_WVHT<span class="token punctuation">{</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> ndbc_nc_match_WVHT<span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    
    
<span class="token keyword">end</span>

<span class="token comment">%%</span>
<span class="token comment">%ndbc_station_download_NC_analyse = ndbc_station_download_NC;</span>
<span class="token comment">%save ndbc_station_download_NC_analyse ndbc_station_download_NC_analyse</span>

<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="对更多的浮标进行整套分析"><a href="#对更多的浮标进行整套分析" class="headerlink" title="对更多的浮标进行整套分析"></a>对更多的浮标进行整套分析</h3><p>加载<code>ndbc_station_download_NC_analyse.mat</code>，可以看到还有很多浮标没有进行整套分析，下面添加的内容都是在<code>ndbc_station_download_NC_analyse</code>变量基础上实现的。</p>
<h4 id="添加之前画的浮标plot"><a href="#添加之前画的浮标plot" class="headerlink" title="添加之前画的浮标plot"></a>添加之前画的浮标plot</h4><p>ndbc_station_info_needed_plot.m：加载ndbc_station_download_NC_analyse.mat，保存fig，在table中添加打开fig的代码字符串，保存ndbc_station_download_NC_analyse；</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218201531.png"></p>
<h4 id="对一个浮标添加整套分析"><a href="#对一个浮标添加整套分析" class="headerlink" title="对一个浮标添加整套分析"></a>对一个浮标添加整套分析</h4><p>ndbc网上查找，发现<code>MDRM1</code>浮标包含了nc文件的时间段，故用此浮标；（但全是无效的有效波高~~┭┮﹏┭┮）</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218202657.png"></p>
<p>整套分析如下：</p>
<ol>
<li><p>首先是创建一个ndbc_station_download_NC_analyse.mat的副本，以防意外发生时数据缺失；</p>
</li>
<li><p>下载浮标数据；</p>
<p><strong>ndbc_station_download.m</strong>：退出clash，重启matlab，加载ndbc_station_download_NC_analyse.mat，更改浮标对应的<strong>i索引</strong>，运行后保存ndbc_station_download_NC_analyse.mat；</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218211125.png"></p>
</li>
<li><p>此浮标对应的nc数据；</p>
<p><strong>ndbc_station_download_NC.m</strong>：加载ndbc_station_download_NC_analyse.mat，更改浮标对应的<strong>i索引</strong>，运行后保存ndbc_station_download_NC_analyse.mat；</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218211237.png"></p>
</li>
<li><p>浮标数据和nc数据匹配+匹配后分析；</p>
<p><strong>ndbc_station_download_NC_analyse.m</strong>：加载ndbc_station_download_NC_analyse.mat，更改浮标对应的<strong>i索引</strong>，运行后保存ndbc_station_download_NC_analyse.mat；</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218211304.png"></p>
</li>
</ol>
<hr>
<p>换一个有效浮标<code>44013</code>，索引9，进行上面的操作；</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218212146.png" style="zoom:67%;">

<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220218212225.png" alt=" " style="zoom:67%;">

<p>将其余的浮标都进行以上操作，**索引…**；</p>
<p>所以，往后记住，<strong>一切的核心数据都在ndbc_station_download_NC_analyse.mat</strong>，千万要记住，对其进行操作时，需要备份！！！</p>
<h2 id="NDBC包"><a href="#NDBC包" class="headerlink" title="NDBC包"></a>NDBC包</h2><p>NDBC包以文件夹形式存在，文件夹命名为<code>ndbc</code>；</p>
<blockquote>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1zWesXbLyUi9_l0Udj9EFYA">https://pan.baidu.com/s/1zWesXbLyUi9_l0Udj9EFYA</a><br>提取码：vupa<br>–来自百度网盘超级会员V5的分享</p>
<p>2022-02-19</p>
</blockquote>
<h3 id="m-map文件夹"><a href="#m-map文件夹" class="headerlink" title="m_map文件夹"></a>m_map文件夹</h3><p>用于进行地图的绘制，需要<strong>将此文件夹添加到matlab环境</strong>中；</p>
<h3 id="source文件夹"><a href="#source文件夹" class="headerlink" title="source文件夹"></a>source文件夹</h3><p>将需要用到的函数放进<code>source</code>文件夹，<strong>将文件夹添加到matlab环境中</strong>；</p>
<p><strong>函数要求</strong>：</p>
<ul>
<li>执行程序时，除了ndbc_station_info_needed_plot函数，其它函数不需要进去专门修改参数，参数的修改在work.m文件中实现；</li>
<li>可以实现<code>work.m</code>既可以在ndbc文件夹下运行，又可以在work文件夹下运行；（解决方法：参数传递添加path_save）</li>
</ul>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220219110046.png" alt=" " style="zoom:67%;">

<h4 id="2022-03-03-gantt-year-py-（未实现）"><a href="#2022-03-03-gantt-year-py-（未实现）" class="headerlink" title="2022-03-03 gantt_year.py （未实现）"></a>2022-03-03 gantt_year.py （未实现）</h4><p>在 <code>source</code> 文件夹新添的 <code>gantt_year.py</code> 是为了画出 <code>work_table.mat</code> 中已有浮标关于年份的甘特图。</p>
<blockquote>
<p>关于浮标的某一参数有效数据的甘特图，需要打开对应浮标详细的数据，这可能需要时间较久，后面在用另一个函数画这个图吧。</p>
</blockquote>
<blockquote>
<p>如何使用Python Pandas绘制<strong>堆叠事件持续时间（甘特图）</strong>？ <a target="_blank" rel="noopener" href="https://www.cnpython.com/qa/51089">https://www.cnpython.com/qa/51089</a></p>
<ul>
<li>使用<strong>Bokeh（一个python库）</strong>来制作甘特图，它非常漂亮。 这是我从<strong>twiiter复制</strong>的代码。</li>
<li>No module named ‘bokeh.charts’</li>
</ul>
<p>What to use instead of bokeh.charts <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/48170086/what-to-use-instead-of-bokeh-charts">https://stackoverflow.com/questions/48170086/what-to-use-instead-of-bokeh-charts</a></p>
<ul>
<li><p>bokeh<strong>库官方</strong>-处理分类数据部分：<a target="_blank" rel="noopener" href="https://docs.bokeh.org/en/latest/docs/user_guide/categorical.html">https://docs.bokeh.org/en/latest/docs/user_guide/categorical.html</a></p>
<p><strong>宝藏库呀</strong>~~</p>
</li>
</ul>
</blockquote>
<blockquote>
<p><strong>时间进度堆叠图</strong>；</p>
</blockquote>
<p>加载 <code>work_table.mat</code> ，</p>
<p>++++++++++++++++++++++++++++++++</p>
<p>供参考的时间stack图</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> bokeh<span class="token punctuation">.</span>plotting <span class="token keyword">import</span> figure<span class="token punctuation">,</span> show<span class="token punctuation">,</span> output_notebook<span class="token punctuation">,</span> output_file
<span class="token keyword">from</span> bokeh<span class="token punctuation">.</span>models <span class="token keyword">import</span> ColumnDataSource<span class="token punctuation">,</span> Range1d
<span class="token keyword">from</span> bokeh<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tools <span class="token keyword">import</span> HoverTool
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token comment">#from bokeh.charts import Bar</span>
<span class="token comment">#output_notebook()</span>
output_file<span class="token punctuation">(</span><span class="token string">'GanntChart.html'</span><span class="token punctuation">)</span> <span class="token comment">#use this to create a standalone html file to send to others</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> ps

DF<span class="token operator">=</span>ps<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Item'</span><span class="token punctuation">,</span><span class="token string">'Start'</span><span class="token punctuation">,</span><span class="token string">'End'</span><span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Items<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'Contract Review &amp; Award'</span><span class="token punctuation">,</span><span class="token string">'2015-7-22'</span><span class="token punctuation">,</span><span class="token string">'2015-8-7'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Submit SOW'</span><span class="token punctuation">,</span><span class="token string">'2015-8-10'</span><span class="token punctuation">,</span><span class="token string">'2015-8-14'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Initial Field Study'</span><span class="token punctuation">,</span><span class="token string">'2015-8-17'</span><span class="token punctuation">,</span><span class="token string">'2015-8-21'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Topographic Procesing'</span><span class="token punctuation">,</span><span class="token string">'2015-9-1'</span><span class="token punctuation">,</span><span class="token string">'2016-6-1'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Init. Hydrodynamic Modeling'</span><span class="token punctuation">,</span><span class="token string">'2016-1-2'</span><span class="token punctuation">,</span><span class="token string">'2016-3-15'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Prepare Suitability Curves'</span><span class="token punctuation">,</span><span class="token string">'2016-2-1'</span><span class="token punctuation">,</span><span class="token string">'2016-3-1'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Improvement Conceptual Designs'</span><span class="token punctuation">,</span><span class="token string">'2016-5-1'</span><span class="token punctuation">,</span><span class="token string">'2016-6-1'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Retrieve Water Level Data'</span><span class="token punctuation">,</span><span class="token string">'2016-8-15'</span><span class="token punctuation">,</span><span class="token string">'2016-9-15'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Finalize Hydrodynamic Models'</span><span class="token punctuation">,</span><span class="token string">'2016-9-15'</span><span class="token punctuation">,</span><span class="token string">'2016-10-15'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Determine Passability'</span><span class="token punctuation">,</span><span class="token string">'2016-9-15'</span><span class="token punctuation">,</span><span class="token string">'2016-10-1'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Finalize Improvement Concepts'</span><span class="token punctuation">,</span><span class="token string">'2016-10-1'</span><span class="token punctuation">,</span><span class="token string">'2016-10-31'</span><span class="token punctuation">,</span><span class="token string">'gray'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Stakeholder Meeting'</span><span class="token punctuation">,</span><span class="token string">'2016-10-20'</span><span class="token punctuation">,</span><span class="token string">'2016-10-21'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Completion of Project'</span><span class="token punctuation">,</span><span class="token string">'2016-11-1'</span><span class="token punctuation">,</span><span class="token string">'2016-11-30'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span> <span class="token comment">#first items on bottom</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span>Dat <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Items<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    DF<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>Dat

<span class="token comment">#convert strings to datetime fields:</span>
DF<span class="token punctuation">[</span><span class="token string">'Start_dt'</span><span class="token punctuation">]</span><span class="token operator">=</span>ps<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>DF<span class="token punctuation">.</span>Start<span class="token punctuation">)</span>
DF<span class="token punctuation">[</span><span class="token string">'End_dt'</span><span class="token punctuation">]</span><span class="token operator">=</span>ps<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>DF<span class="token punctuation">.</span>End<span class="token punctuation">)</span>


G<span class="token operator">=</span>figure<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'Project Schedule'</span><span class="token punctuation">,</span>x_axis_type<span class="token operator">=</span><span class="token string">'datetime'</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span>y_range<span class="token operator">=</span>DF<span class="token punctuation">.</span>Item<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        x_range<span class="token operator">=</span>Range1d<span class="token punctuation">(</span>DF<span class="token punctuation">.</span>Start_dt<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>DF<span class="token punctuation">.</span>End_dt<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tools<span class="token operator">=</span><span class="token string">'save'</span><span class="token punctuation">)</span>

hover<span class="token operator">=</span>HoverTool<span class="token punctuation">(</span>tooltips<span class="token operator">=</span>"Task<span class="token punctuation">:</span> @Item<span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>\
Start<span class="token punctuation">:</span> @Start<span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>\
End<span class="token punctuation">:</span> @End"<span class="token punctuation">)</span>
G<span class="token punctuation">.</span>add_tools<span class="token punctuation">(</span>hover<span class="token punctuation">)</span>

DF<span class="token punctuation">[</span><span class="token string">'ID'</span><span class="token punctuation">]</span><span class="token operator">=</span>DF<span class="token punctuation">.</span>index<span class="token operator">+</span><span class="token number">0.8</span>
DF<span class="token punctuation">[</span><span class="token string">'ID1'</span><span class="token punctuation">]</span><span class="token operator">=</span>DF<span class="token punctuation">.</span>index<span class="token operator">+</span><span class="token number">1.2</span>
CDS<span class="token operator">=</span>ColumnDataSource<span class="token punctuation">(</span>DF<span class="token punctuation">)</span>
G<span class="token punctuation">.</span>quad<span class="token punctuation">(</span>left<span class="token operator">=</span><span class="token string">'Start_dt'</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token string">'End_dt'</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token string">'ID'</span><span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token string">'ID1'</span><span class="token punctuation">,</span>source<span class="token operator">=</span>CDS<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">"Color"</span><span class="token punctuation">)</span>
<span class="token comment">#G.rect(,"Item",source=CDS)</span>
show<span class="token punctuation">(</span>G<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220303211650.png"></p>
<h3 id="bokeh库官方-处理分类数据部分"><a href="#bokeh库官方-处理分类数据部分" class="headerlink" title="bokeh库官方-处理分类数据部分"></a>bokeh<strong>库官方</strong>-处理分类数据部分</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://docs.bokeh.org/en/latest/docs/user_guide/categorical.html">https://docs.bokeh.org/en/latest/docs/user_guide/categorical.html</a></p>
</blockquote>
<h3 id="使用NDBC包方法：work-文件夹"><a href="#使用NDBC包方法：work-文件夹" class="headerlink" title="使用NDBC包方法：work 文件夹"></a>使用NDBC包方法：work 文件夹</h3><p>一个work文件夹对应一个工作空间；</p>
<p>下面是如何使用NDBC包的内容，用的是本次寒假的例子：</p>
<ol>
<li><p>至少 matlab 2020a 版本；</p>
</li>
<li><p>将m_map和source文件夹添加到matlab环境；</p>
</li>
<li><p>在ndbc文件夹下新建<code>work_eastUSA</code>文件夹，再在<code>work_eastUSA</code>文件夹下新建<code>work_eastUSA.m</code>，导入所需要的<code>nc</code>文件；</p>
<p><code>work_eastUSA.m</code>：</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token comment">% author:</span>
<span class="token comment">%    liu jin can, UPC</span>
%
<span class="token comment">% revison history</span>
<span class="token comment">%    2022-02-19 first verison.</span>
%
<span class="token comment">% reference:</span>
<span class="token comment">%    https://blog.csdn.net/qq_35166974/article/details/96007377:警告: 未保存变量 'work_table'。对于大于 2GB 的变量，请使用 MAT 文件版本 7.3 或更高版本。 </span>

clc<span class="token punctuation">,</span>clear all<span class="token punctuation">;</span>
<span class="token comment">%%</span>
path_save <span class="token operator">=</span> <span class="token string">'D:\ndbc\work_eastUSA\'</span><span class="token punctuation">;</span> <span class="token comment">%work工作目录路径，最后必须是'\'</span>
<span class="token function">cd</span><span class="token punctuation">(</span>path_save<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token function">exist</span><span class="token punctuation">(</span><span class="token string">'work_table.mat'</span><span class="token punctuation">)</span>
    load work_table<span class="token punctuation">.</span>mat
    <span class="token comment">%%</span>
    station_tf_download <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span> <span class="token number">5</span> <span class="token number">7</span> <span class="token number">9</span> <span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%要下载的浮标在work_table的索引</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%运行需要时间比较久；第一次是必须运行的；</span>
    <span class="token comment">%%</span>
    ncid <span class="token operator">=</span> <span class="token string">'ww3.2011.nc'</span><span class="token punctuation">;</span>
    nclat <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%查看纬度显示正常</span>
    nclon <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nctime <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nc_WVHT <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'hs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download_NC</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>ncid<span class="token punctuation">,</span>nclat<span class="token punctuation">,</span>nclon<span class="token punctuation">,</span>nctime<span class="token punctuation">,</span>nc_WVHT<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download_NC_analyse</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    save work_table work_table <span class="token comment">% ~16 -- 16:16 --</span>
<span class="token keyword">else</span>
    work_table <span class="token operator">=</span> table<span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    <span class="token comment">%[work_table] = ndbc_station_info('',path_save); %运行需要时间比较久；</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%调用之前已保存的ndbc_station_info.mat数据；</span>
    <span class="token comment">%%</span>
    lat_max <span class="token operator">=</span> <span class="token number">46</span><span class="token punctuation">;</span>  <span class="token comment">% 纬度为负数，表示南纬</span>
    lat_min <span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span>
    lon_max <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">58</span><span class="token punctuation">;</span> <span class="token comment">% 经度为负数，表示西经</span>
    lon_min <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">75</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>lat_max<span class="token punctuation">,</span>lat_min<span class="token punctuation">,</span>lon_max<span class="token punctuation">,</span>lon_min<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed_plot</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>lat_max<span class="token punctuation">,</span>lat_min<span class="token punctuation">,</span>lon_max<span class="token punctuation">,</span>lon_min<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_info_needed_etopo1</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    station_tf_download <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token comment">%2 5 7 9 29]; %要下载的浮标在work_table的索引</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%运行需要时间比较久；第一次是必须运行的；</span>
    <span class="token comment">%%</span>
    ncid <span class="token operator">=</span> <span class="token string">'ww3.2011.nc'</span><span class="token punctuation">;</span>
    nclat <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%查看纬度显示正常</span>
    nclon <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'longitude'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nctime <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    nc_WVHT <span class="token operator">=</span> <span class="token function">ncread</span><span class="token punctuation">(</span>ncid<span class="token punctuation">,</span><span class="token string">'hs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download_NC</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>ncid<span class="token punctuation">,</span>nclat<span class="token punctuation">,</span>nclon<span class="token punctuation">,</span>nctime<span class="token punctuation">,</span>nc_WVHT<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    <span class="token punctuation">[</span>work_table<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ndbc_station_download_NC_analyse</span><span class="token punctuation">(</span>work_table<span class="token punctuation">,</span>station_tf_download<span class="token punctuation">,</span>path_save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%%</span>
    save work_table work_table
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>第一次运行会生成包含第一个浮标所有内容的<code>work_table.mat</code>；</p>
<p>以后的运行，根据修改参数，在已生成的<code>work_table.mat</code>基础上添加数据；</p>
</li>
</ol>
<h3 id="info-txt"><a href="#info-txt" class="headerlink" title="info.txt"></a>info.txt</h3><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">work_table.mat 包含所有数据~~<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="QT：save-mat-大小变化很大问题"><a href="#QT：save-mat-大小变化很大问题" class="headerlink" title="QT：save mat 大小变化很大问题"></a>QT：save mat 大小变化很大问题</h3><p>遇到了一个保存变量时存储大小变化很大的问题。</p>
<p>之前保存的mat文件大小不足100M，里面只有ndbc_station_download_NC_analyse这一个变量：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220219173819.png"></p>
<p>今天打开matlab，加载这个mat文件后，再保存这个变量（不对变量进行任何操作），报错如下：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220219174118.png"></p>
<p>【小学】MyLifeStyle(3079779149) 17:44:26<br>求助，怎么解决上面这个问题呀，很懵，谢谢~~</p>
<p>【管理员】晨雾(914836396) 17:49:33<br>设置里有吧</p>
<p>【小学】MyLifeStyle(3079779149) 17:50:43<br><strong>我奇怪的点是，不同时间保存同一个数据，怎么所占空间差距这么大</strong>~~</p>
<p>【小学】MyLifeStyle(3079779149) 17:52:13<br>是需要额外对save()进行设置吗？</p>
<p>【管理员】晨雾(914836396) 18:04:52<br>还真是。。</p>
<p>【管理员】新疆+源代码+奋斗(535512013) 18:06:41<br>temp变了呗</p>
<p>【小学】MyLifeStyle(3079779149) 18:10:48<br>temp 是啥呀…</p>
<p>【管理员】新疆+源代码+奋斗(535512013) 18:16:31<br>缓存</p>
<p>【小学】MyLifeStyle(3079779149) 18:21:38<br>好的，等等回去清清缓存<img src="file:///C:\Users\Liujincan2\AppData\Roaming\Tencent\QQTempSys\0RF[5[EVQJ4GABFHX344QTN.gif" alt="img">，希望文件能小点。</p>
<p>【管理员】新疆+源代码+奋斗(535512013) 18:32:42<br>不是，是matlab计算量大了以后自己相关的temp文件变大了</p>
<p>【管理员】新疆+源代码+奋斗(535512013) 18:32:57<br>也是需要清理缓存的</p>
<hr>
<p><a target="_blank" rel="noopener" href="https://www.ilovematlab.cn/thread-485960-1-1.html%EF%BC%9A**MATLAB%E8%AF%BB%E5%8F%96%E7%9A%84mat%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9%E5%90%8E%E5%AD%98%E5%82%A8%EF%BC%8C%E7%A9%BA%E9%97%B4%E5%8D%A0%E7%94%A8%E5%A4%A7%E5%A2%9E%EF%BC%8C%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F">https://www.ilovematlab.cn/thread-485960-1-1.html：**MATLAB读取的mat文件修改后存储，空间占用大增，怎么办？</a>**</p>
<hr>
<p>【小学】MyLifeStyle(3079779149) 21:09:20<br>晨雾   版本问题？<br>@晨雾<br>1、2020a出现内存变大问题，2017b没出现这个问题；<br>2、我对2020a生成的文件再一次在2020a保存，内存大小也没变；<br>3、我对2020a生成的文件在2017b下保存，内存大小变小了；<br>（我感觉不太像是版本的问题，之前2020a是正常的，而是有些设置被更改了，准备将2020a全部恢复<code>出厂设置</code>，看看能不能变回来）</p>
<hr>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token function">save</span><span class="token punctuation">(</span><span class="token string">'13'</span><span class="token punctuation">,</span><span class="token string">'ndbc_station_info'</span><span class="token punctuation">,</span><span class="token string">'-v7.3'</span><span class="token punctuation">)</span> <span class="token comment">%v7.3，压缩程度不行，内存是v7的50倍</span>
<span class="token function">save</span><span class="token punctuation">(</span><span class="token string">'14'</span><span class="token punctuation">,</span><span class="token string">'ndbc_station_info'</span><span class="token punctuation">,</span><span class="token string">'-v7.3'</span><span class="token punctuation">,</span><span class="token string">'-nocompression'</span><span class="token punctuation">)</span> <span class="token comment">%不压缩，内存更大</span>
<span class="token function">save</span><span class="token punctuation">(</span><span class="token string">'14'</span><span class="token punctuation">,</span><span class="token string">'ndbc_station_info'</span><span class="token punctuation">,</span><span class="token string">'-v7'</span><span class="token punctuation">)</span> <span class="token comment">%v7，压缩程度最大，但是限制2GB，如何解开限制？</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<p><a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/matlab/import_export/mat-file-versions.html%EF%BC%9AMAT%E6%96%87%E4%BB%B6%E7%89%88%E6%9C%AC">https://ww2.mathworks.cn/help/matlab/import_export/mat-file-versions.html：MAT文件版本</a><br><strong>注意</strong></p>
<p>7.3 版本的 MAT 文件使用基于 HDF5 的格式，该格式要求使用一些存储空间开销来描述文件内容。对于元胞数组、结构体数组或可以存储异构数据类型的其他容器，<strong>7.3 版本的 MAT 文件有时比版本 7 的 MAT 文件要大</strong>。</p>
<p>在某些情况下，<strong>加载压缩数据实际上可能比加载未压缩数据<em>更快</em></strong>。</p>
<hr>
<p><strong>图床的思想</strong>：存储大数据的文件夹~~</p>
<h3 id="Matlab大数据存储-matfile"><a href="#Matlab大数据存储-matfile" class="headerlink" title="Matlab大数据存储-matfile"></a>Matlab大数据存储-matfile</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/128553225">https://zhuanlan.zhihu.com/p/128553225</a></p>
</blockquote>
<h2 id="————————————–"><a href="#————————————–" class="headerlink" title="————————————–"></a>————————————–</h2><h2 id="参考资料-5"><a href="#参考资料-5" class="headerlink" title="参考资料"></a>参考资料</h2><p><code>gridgen</code>教程；</p>
<p><a href="https://liu-jincan.github.io/2021/12/28/hai-lang-shu-zhi-mo-shi/wavewatch3/06-gridgen-tutorial-wang-ge-sheng-cheng/">https://liu-jincan.github.io/2021/12/28/hai-lang-shu-zhi-mo-shi/wavewatch3/06-gridgen-tutorial-wang-ge-sheng-cheng/</a></p>
<blockquote>
<p>以下的程序，是基于<code>gridgen</code>教程创建的工作目录文件夹<code>work-griden</code>，从而执行的。</p>
<p>其实执行程序是在<code>Tutorial_GRIDGEN</code>中，只需要下载这个即可。</p>
</blockquote>
<h2 id="gridgen生成矩形网格"><a href="#gridgen生成矩形网格" class="headerlink" title="gridgen生成矩形网格"></a>gridgen生成矩形网格</h2><blockquote>
<p>记住在<code>matlab</code>中添加<code>$Tutorial_GRIDGEN/bin</code>环境变量，允许在其它目录运行其中的函数。</p>
</blockquote>
<h3 id="create-grid"><a href="#create-grid" class="headerlink" title="create_grid()"></a>create_grid()</h3><ol>
<li><p>在<code>$namelist</code>文件夹下创建，目标网格对应的<code>gridgen.east-USA_P25.nml</code>：</p>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">$ a. Path to directories and file names-----------------------------------$

$ BIN_DIR : location of matlab scripts
$
$ REF_DIR : location of reference data
$
$ DATA_DIR : input/output grid directory
$
$ FNAME_POLY （？？？）:
$ File with switches for using user-defined polygons.
$ An example file has been provided with the reference data
$ for an existing user-defined polygon database.
$ 0: ignores the polygon | 1: accounts for the polygon.
$ 带有使用用户定义的多边形的开关（switch）的文件。
$ 已经提供了一个示例文件，其中包含现有用户定义的多边形数据库的参考数据。
$ 0：忽略多边形|1：核算多边形。
$
$ FNAME : File name prefix: the routine will create output files
$ fname.bot, fname.mask_rank1, etc.
$
$ FNAMEB : Name of base grid for modmask (if needed)
$
$ BOUND_SELECT（Ⅳ） : Boundary selection :
$ 0 -&gt; manually on the plot
$ 1 -&gt; automatically around the borders
$ 2 -&gt; from a .poly file

&amp;GRID_INIT
BIN_DIR = '../bin'
REF_DIR = '../reference'
DATA_DIR = '../data'
FNAME_POLY = 'user_polygons.flag'      %不知道干什么用的
FNAME = 'east-USA_P25'
FNAMEB = 'east-USA_P25_2'
BOUND_SELECT = 1
/



$ b. Information on bathymetry file--------------------------------------$

$ Grid Definition

$ Gridgen is designed to work with curvilinear and/or rectilinear grids. In
$ both cases it expects a 2D array defining the Longitudes (x values) and
$ Latitudes (y values). For curvilinear grids, the user will have to use
$ alternative software to determine these arrays. For rectilinear grids
$ these are determined by the grid domain and desired resolution as shown
$ below
$Gridgen被设计用于处理曲线型和/或直线型网格。
$在这两种情况下，它都希望有一个定义经度（x值）和纬度（y值）的二维数组。
$对于曲线型网格，用户将不得不使用其他软件来确定这些数组(???)。
$对于直线型网格，这些阵列由网格域和所需的分辨率决定，如下图所示。

$ REF_GRID : reference grid source = name of the bathy source file
$ (without '.nc' extension)
$ ref_grid = 'etopo1' -&gt; Etopo1 grid
$ ref_grid = 'etopo2' -&gt; Etopo2 grid
$ ref_grid = 'xyz' -&gt; ASCII .log grid
$ ref_grid = ??? -&gt; user-defined bathymetry file (must match etopo format)
$
$ LONFROM : origin of longitudes
$ lonfrom = -180 -&gt; longitudes from -180 to 180 (etopo2)
$ lonfrom = 0 -&gt; longitudes from 0 to 360 (etopo1)
$
$ XVAR : name of variable defining longitudes in bathy file
$ xvar = 'x' if etopo1
$ xvar = 'lon' if etopo2
$ YVAR : name of variable defining latitudes in bathy file
$ yvar = 'y' if etopo1
$ yvar = 'lat' if etopo2
$ ZVAR : name of variable defining depths in bathy file
$ zvar = 'z' for etopo1 &amp; etopo2 (can be other for user-defined file)

&amp;BATHY_FILE
REF_GRID = 'gebco'
XVAR = 'lon'
YVAR = 'lat'
ZVAR = 'elevation'
LONFROM = -180
/


$ c. Required grid resolution and boundaries---------------------------------$

$ TYPE : rectangular grid 'rect' or curvilinear grid 'curv'
$ DX : resolution in longitudes (°)
$ DY : resolution in latitudes (°)
$ LON_WEST : western boundary
$ LON_EAST : eastern boundary
$
$ if lonfrom = 0 : lon_west &amp; lon_east in [0 ; 360]
$ with possibly lon_west &gt; lon_east
$ if the Greenwich meridian is crossed
$ if lonfrom = -180 : lon_west &amp; lon_east in [-180 ; 180]
$
$ LAT_SOUTH : southern boundary
$ LAT_NORTH : northern boundary
$ lon_south &amp; lon_north in [-90 ; 90]
$
$ IS_GLOBAL（Ⅱ（6）） : set to 1 if the grid is global, else 0
$
$ IS_GLOBALB（Ⅳ）: set to 1 if the base grid is global, else 0
$

&amp;OUTGRID
TYPE = 'rect'
DX = 0.25
DY = 0.25
LON_WEST = -75
LON_EAST = -58
LAT_SOUTH = 36
LAT_NORTH = 46
IS_GLOBAL = 0
IS_GLOBALB = 0
/



$ d. Boundary options-------------------------------------------------------$

$ BOUNDARY : Option to determine which GSHHS
$ .mat file to load:
$ full = full resolution
$ high = 0.2 km
$ inter = 1 km
$ low = 5 km
$ coarse = 25 km
$
$ READ_BOUNDARY（？？？） : [0|1] flag to determine if input boundary information
$ needs to be read; boundary data files can be
$ significantly large and need to be read only the first
$ time. So when making multiple grids, the flag can be set
$ to 0 for subsequent grids.
$ (Note : If the workspace is cleared, the boundary data
$ will have to be read again)
$
$ OPT_POLY : [0|1] flag for reading the optional user-defined
$ polygons. Set to 0 if you do not wish to use this option
$
$ MIN_DIST（Ⅱ（3））??? : Used in compute_boundary and in split_boudnary;
$ threshold defining the minimum distance (in °) between
$ the edge of a polygon and the inside/outside boundary.
$ A low value reduces computation time but can raise
$ errors if the grid is too coarse. If the script crashes,
$ consider increasing the value.
$ (Default value in function used to be min_dist = 4)

&amp;GRID_BOUND
BOUNDARY = 'full'    
READ_BOUNDARY = 1
OPT_POLY = 0
MIN_DIST = 4
/



$ e. Parameter values used in the software-------------------------------------$

$ DRY_VAL : Depth value set for dry cells (can change as desired)
$ Used in 'generate_grid' and in the making of initial mask
$
$ CUT_OFF : Cut-off depth to distinguish between dry and wet cells.
$ All depths below the cut_off depth are marked wet
$ Used in 'generate_grid'
$ NOTE : If you have accurate boundary polygons, then it is
$ better to have a low value for CUT_OFF, which will make the
$ target bathymetry cell wet even when there are only few wet
$ cells in the base bathymetry. This will then be cleaned up
$ by the polygons in the 'mask cleanup' section. If, on the
$ other, hand you do not intend to use the polygons to define
$ the coastal domains, then you are better off with CUT_OFF = 0.5
$注意：如果你有精确的边界多边形，那么最好将CUT_OFF的值调低，
$这样会使目标测深单元变湿，即使在基本测深中只有少数湿单元。
$然后，这将被 "掩膜清理 "部分中的多边形清理掉。
$另一方面，如果你不打算用多边形来定义沿岸域，那么你最好使用 CUT_OFF = 0.5(???)。
$
$ LIM_BATHY(Ⅱ（2）)（？？？） : Proportion of base bathymetry cells that need to be wet for
$ the target cell to be considered wet.
$需要湿润的基础水深单元的比例，以使目标单元被认为是湿润的。
$
$ LIM_VAL（Ⅱ（5））（？？？） : Fraction of cell that has to be inside a polygon for the
$ cell to be marked dry
$
$ SPLIT_LIM（Ⅱ（4））（？？？） : Limit for splitting the polygons; used in split_boundary
$ Rule of thumbs: from 5 to 10 times max(dx,dy)
$
$
$ OFFSET : Additional buffer around the boundary to check if cell is
$ crossing boundary. Should be set to largest grid resolution
$ ie OFFSET = max([dx dy])
$ Used in 'clean_mask'
$
$ LAKE_TOL : Tolerance value that determines if all the wet cells
$ corresponding to a particular wet body should be flagged
$ dry or not.
$ Used in 'remove_lake'
$ if LAKE_TOL &gt; 0 : all water bodies having less than this
$ value of total wet cells will be flagged 
$ dry    $例如，如果为100，则弱湖泊（小水体）的单元输为60，则被认为是陆地，即dry
$ if LAKE_TOL = 0 : the output and input masks are unchanged.
$ if LAKE_TOL &lt; 0 : all but the largest water body is flagged
$ dry
$
$ OBSTR_OFFSET : Flag to determine if neighbours should be considered.
$ (0/1 = no/yes)
$ Used in 'create_obstr'

&amp;GRID_PARAM
DRY_VAL = 999999
CUT_OFF = 0
LIM_BATHY = 0.4                  
LIM_VAL = 0.5
SPLIT_LIM = 1.25                 %from 5 to 10 times max(dx,dy)
OFFSET = 0.25                    %OFFSET = max([dx dy])
LAKE_TOL = 100
OBSTR_OFFSET = 1
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<ul>
<li><p>大致的目标区域：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118133559.png"></p>
</li>
<li><p>生成的海陆掩码（部分水体消失了，如果网格分辨率从0.25到0.125，会识别出右上角的水体）：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118133714.png"></p>
</li>
</ul>
</blockquote>
</li>
<li><p>在<code>$area</code>文件夹下创建<code>east_USA.m</code>，添加</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token function">create_grid</span><span class="token punctuation">(</span><span class="token string">'$namelist/gridgen.east-USA_P25.nml'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>运行后会在<code>$data</code>输出：</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118134003.png" style="zoom:80%;"></li>
<li><p>为了在海陆掩码上增加<code>活动边界</code>，还需创建一个基础网格。在<code>$namelist</code>文件夹下创建，基础网格对应的<code>gridgen.east-USA_P25_2.nml</code>：</p>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">$ a. Path to directories and file names-----------------------------------$

$ BIN_DIR : location of matlab scripts
$
$ REF_DIR : location of reference data
$
$ DATA_DIR : input/output grid directory
$
$ FNAME_POLY （？？？）:
$ File with switches for using user-defined polygons.
$ An example file has been provided with the reference data
$ for an existing user-defined polygon database.
$ 0: ignores the polygon | 1: accounts for the polygon.
$ 带有使用用户定义的多边形的开关（switch）的文件。
$ 已经提供了一个示例文件，其中包含现有用户定义的多边形数据库的参考数据。
$ 0：忽略多边形|1：核算多边形。
$
$ FNAME : File name prefix: the routine will create output files
$ fname.bot, fname.mask_rank1, etc.
$
$ FNAMEB : Name of base grid for modmask (if needed)
$
$ BOUND_SELECT（Ⅳ） : Boundary selection :
$ 0 -&gt; manually on the plot
$ 1 -&gt; automatically around the borders
$ 2 -&gt; from a .poly file

&amp;GRID_INIT
BIN_DIR = '../bin'
REF_DIR = '../reference'
DATA_DIR = '../data'
FNAME_POLY = 'user_polygons.flag'      %不知道干什么用的
FNAME = 'east-USA_P25_2'
FNAMEB = 'none'                        
BOUND_SELECT = 1
/



$ b. Information on bathymetry file--------------------------------------$

$ Grid Definition

$ Gridgen is designed to work with curvilinear and/or rectilinear grids. In
$ both cases it expects a 2D array defining the Longitudes (x values) and
$ Latitudes (y values). For curvilinear grids, the user will have to use
$ alternative software to determine these arrays. For rectilinear grids
$ these are determined by the grid domain and desired resolution as shown
$ below
$Gridgen被设计用于处理曲线型和/或直线型网格。
$在这两种情况下，它都希望有一个定义经度（x值）和纬度（y值）的二维数组。
$对于曲线型网格，用户将不得不使用其他软件来确定这些数组(???)。
$对于直线型网格，这些阵列由网格域和所需的分辨率决定，如下图所示。

$ REF_GRID : reference grid source = name of the bathy source file
$ (without '.nc' extension)
$ ref_grid = 'etopo1' -&gt; Etopo1 grid
$ ref_grid = 'etopo2' -&gt; Etopo2 grid
$ ref_grid = 'xyz' -&gt; ASCII .log grid
$ ref_grid = ??? -&gt; user-defined bathymetry file (must match etopo format)
$
$ LONFROM : origin of longitudes
$ lonfrom = -180 -&gt; longitudes from -180 to 180 (etopo2)
$ lonfrom = 0 -&gt; longitudes from 0 to 360 (etopo1)
$
$ XVAR : name of variable defining longitudes in bathy file
$ xvar = 'x' if etopo1
$ xvar = 'lon' if etopo2
$ YVAR : name of variable defining latitudes in bathy file
$ yvar = 'y' if etopo1
$ yvar = 'lat' if etopo2
$ ZVAR : name of variable defining depths in bathy file
$ zvar = 'z' for etopo1 &amp; etopo2 (can be other for user-defined file)

&amp;BATHY_FILE
REF_GRID = 'gebco'
XVAR = 'lon'
YVAR = 'lat'
ZVAR = 'elevation'
LONFROM = -180
/


$ c. Required grid resolution and boundaries---------------------------------$

$ TYPE : rectangular grid 'rect' or curvilinear grid 'curv'
$ DX : resolution in longitudes (°)
$ DY : resolution in latitudes (°)
$ LON_WEST : western boundary
$ LON_EAST : eastern boundary
$
$ if lonfrom = 0 : lon_west &amp; lon_east in [0 ; 360]
$ with possibly lon_west &gt; lon_east
$ if the Greenwich meridian is crossed
$ if lonfrom = -180 : lon_west &amp; lon_east in [-180 ; 180]
$
$ LAT_SOUTH : southern boundary
$ LAT_NORTH : northern boundary
$ lon_south &amp; lon_north in [-90 ; 90]
$
$ IS_GLOBAL（Ⅱ（6）） : set to 1 if the grid is global, else 0
$
$ IS_GLOBALB（Ⅳ）: set to 1 if the base grid is global, else 0
$

&amp;OUTGRID
TYPE = 'rect'
DX = 0.25
DY = 0.25
LON_WEST = -80
LON_EAST = -50
LAT_SOUTH = 33
LAT_NORTH = 50
IS_GLOBAL = 0
IS_GLOBALB = 0
/



$ d. Boundary options-------------------------------------------------------$

$ BOUNDARY : Option to determine which GSHHS
$ .mat file to load:
$ full = full resolution
$ high = 0.2 km
$ inter = 1 km
$ low = 5 km
$ coarse = 25 km
$
$ READ_BOUNDARY（？？？） : [0|1] flag to determine if input boundary information
$ needs to be read; boundary data files can be
$ significantly large and need to be read only the first
$ time. So when making multiple grids, the flag can be set
$ to 0 for subsequent grids.
$ (Note : If the workspace is cleared, the boundary data
$ will have to be read again)
$
$ OPT_POLY : [0|1] flag for reading the optional user-defined
$ polygons. Set to 0 if you do not wish to use this option
$
$ MIN_DIST（Ⅱ（3））??? : Used in compute_boundary and in split_boudnary;
$ threshold defining the minimum distance (in °) between
$ the edge of a polygon and the inside/outside boundary.
$ A low value reduces computation time but can raise
$ errors if the grid is too coarse. If the script crashes,
$ consider increasing the value.
$ (Default value in function used to be min_dist = 4)

&amp;GRID_BOUND
BOUNDARY = 'full'    
READ_BOUNDARY = 1
OPT_POLY = 0
MIN_DIST = 4
/



$ e. Parameter values used in the software-------------------------------------$

$ DRY_VAL : Depth value set for dry cells (can change as desired)
$ Used in 'generate_grid' and in the making of initial mask
$
$ CUT_OFF : Cut-off depth to distinguish between dry and wet cells.
$ All depths below the cut_off depth are marked wet
$ Used in 'generate_grid'
$ NOTE : If you have accurate boundary polygons, then it is
$ better to have a low value for CUT_OFF, which will make the
$ target bathymetry cell wet even when there are only few wet
$ cells in the base bathymetry. This will then be cleaned up
$ by the polygons in the 'mask cleanup' section. If, on the
$ other, hand you do not intend to use the polygons to define
$ the coastal domains, then you are better off with CUT_OFF = 0.5
$注意：如果你有精确的边界多边形，那么最好将CUT_OFF的值调低，
$这样会使目标测深单元变湿，即使在基本测深中只有少数湿单元。
$然后，这将被 "掩膜清理 "部分中的多边形清理掉。
$另一方面，如果你不打算用多边形来定义沿岸域，那么你最好使用 CUT_OFF = 0.5(???)。
$
$ LIM_BATHY(Ⅱ（2）)（？？？） : Proportion of base bathymetry cells that need to be wet for
$ the target cell to be considered wet.
$需要湿润的基础水深单元的比例，以使目标单元被认为是湿润的。
$
$ LIM_VAL（Ⅱ（5））（？？？） : Fraction of cell that has to be inside a polygon for the
$ cell to be marked dry
$
$ SPLIT_LIM（Ⅱ（4））（？？？） : Limit for splitting the polygons; used in split_boundary
$ Rule of thumbs: from 5 to 10 times max(dx,dy)
$
$
$ OFFSET : Additional buffer around the boundary to check if cell is
$ crossing boundary. Should be set to largest grid resolution
$ ie OFFSET = max([dx dy])
$ Used in 'clean_mask'
$
$ LAKE_TOL : Tolerance value that determines if all the wet cells
$ corresponding to a particular wet body should be flagged
$ dry or not.
$ Used in 'remove_lake'
$ if LAKE_TOL &gt; 0 : all water bodies having less than this
$ value of total wet cells will be flagged 
$ dry    $例如，如果为100，则弱湖泊（小水体）的单元输为60，则被认为是陆地，即dry
$ if LAKE_TOL = 0 : the output and input masks are unchanged.
$ if LAKE_TOL &lt; 0 : all but the largest water body is flagged
$ dry
$
$ OBSTR_OFFSET : Flag to determine if neighbours should be considered.
$ (0/1 = no/yes)
$ Used in 'create_obstr'

&amp;GRID_PARAM
DRY_VAL = 999999
CUT_OFF = 0
LIM_BATHY = 0.4                  
LIM_VAL = 0.5
SPLIT_LIM = 1.25                 %from 5 to 10 times max(dx,dy)
OFFSET = 0.25                    %OFFSET = max([dx dy])
LAKE_TOL = 100
OBSTR_OFFSET = 1
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<ul>
<li><p>生成的海陆掩码：</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118135436.png" style="zoom:67%;"></li>
</ul>
</blockquote>
</li>
<li><p>在<code>$area</code>文件夹下的<code>east_USA.m</code>，添加</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token function">create_grid</span><span class="token punctuation">(</span><span class="token string">'$namelist/gridgen.east-USA_P25_2.nml'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>运行后会在<code>$data</code>输出类似内容。</p>
</li>
</ol>
<h3 id="create-boundary"><a href="#create-boundary" class="headerlink" title="create_boundary()"></a>create_boundary()</h3><p>在<code>$area</code>文件夹下的<code>east_USA.m</code>，添加</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token function">create_boundary</span><span class="token punctuation">(</span><span class="token string">'$namelist/gridgen.east-USA_P25.nml'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>运行后会在<code>$data</code>输出：</p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118140511.png" style="zoom:80%;">

<blockquote>
<ul>
<li><p>生成的海陆掩码：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118140645.png"></p>
</li>
</ul>
</blockquote>
<h3 id="（可不看）一个更精细的目标网格：gridgen-east-USA-P125-nml"><a href="#（可不看）一个更精细的目标网格：gridgen-east-USA-P125-nml" class="headerlink" title="（可不看）一个更精细的目标网格：gridgen.east-USA_P125.nml"></a>（可不看）一个更精细的目标网格：gridgen.east-USA_P125.nml</h3><ol>
<li><p>在<code>$namelist</code>文件夹下创建，更精细的目标网格对应的<code>gridgen.east-USA_P125.nml</code>：（基础网格不变）</p>
<pre class="line-numbers language-none"><code class="language-none">$ a. Path to directories and file names-----------------------------------$

$ BIN_DIR : location of matlab scripts
$
$ REF_DIR : location of reference data
$
$ DATA_DIR : input/output grid directory
$
$ FNAME_POLY （？？？）:
$ File with switches for using user-defined polygons.
$ An example file has been provided with the reference data
$ for an existing user-defined polygon database.
$ 0: ignores the polygon | 1: accounts for the polygon.
$ 带有使用用户定义的多边形的开关（switch）的文件。
$ 已经提供了一个示例文件，其中包含现有用户定义的多边形数据库的参考数据。
$ 0：忽略多边形|1：核算多边形。
$
$ FNAME : File name prefix: the routine will create output files
$ fname.bot, fname.mask_rank1, etc.
$
$ FNAMEB : Name of base grid for modmask (if needed)
$
$ BOUND_SELECT（Ⅳ） : Boundary selection :
$ 0 -&gt; manually on the plot
$ 1 -&gt; automatically around the borders
$ 2 -&gt; from a .poly file

&amp;GRID_INIT
BIN_DIR = '../bin'
REF_DIR = '../reference'
DATA_DIR = '../data'
FNAME_POLY = 'user_polygons.flag'      %不知道干什么用的
FNAME = 'east-USA_P125'
FNAMEB = 'east-USA_P25_2'
BOUND_SELECT = 1
/



$ b. Information on bathymetry file--------------------------------------$

$ Grid Definition

$ Gridgen is designed to work with curvilinear and/or rectilinear grids. In
$ both cases it expects a 2D array defining the Longitudes (x values) and
$ Latitudes (y values). For curvilinear grids, the user will have to use
$ alternative software to determine these arrays. For rectilinear grids
$ these are determined by the grid domain and desired resolution as shown
$ below
$Gridgen被设计用于处理曲线型和/或直线型网格。
$在这两种情况下，它都希望有一个定义经度（x值）和纬度（y值）的二维数组。
$对于曲线型网格，用户将不得不使用其他软件来确定这些数组(???)。
$对于直线型网格，这些阵列由网格域和所需的分辨率决定，如下图所示。

$ REF_GRID : reference grid source = name of the bathy source file
$ (without '.nc' extension)
$ ref_grid = 'etopo1' -&gt; Etopo1 grid
$ ref_grid = 'etopo2' -&gt; Etopo2 grid
$ ref_grid = 'xyz' -&gt; ASCII .log grid
$ ref_grid = ??? -&gt; user-defined bathymetry file (must match etopo format)
$
$ LONFROM : origin of longitudes
$ lonfrom = -180 -&gt; longitudes from -180 to 180 (etopo2)
$ lonfrom = 0 -&gt; longitudes from 0 to 360 (etopo1)
$
$ XVAR : name of variable defining longitudes in bathy file
$ xvar = 'x' if etopo1
$ xvar = 'lon' if etopo2
$ YVAR : name of variable defining latitudes in bathy file
$ yvar = 'y' if etopo1
$ yvar = 'lat' if etopo2
$ ZVAR : name of variable defining depths in bathy file
$ zvar = 'z' for etopo1 &amp; etopo2 (can be other for user-defined file)

&amp;BATHY_FILE
REF_GRID = 'gebco'
XVAR = 'lon'
YVAR = 'lat'
ZVAR = 'elevation'
LONFROM = -180
/


$ c. Required grid resolution and boundaries---------------------------------$

$ TYPE : rectangular grid 'rect' or curvilinear grid 'curv'
$ DX : resolution in longitudes (°)
$ DY : resolution in latitudes (°)
$ LON_WEST : western boundary
$ LON_EAST : eastern boundary
$
$ if lonfrom = 0 : lon_west &amp; lon_east in [0 ; 360]
$ with possibly lon_west &gt; lon_east
$ if the Greenwich meridian is crossed
$ if lonfrom = -180 : lon_west &amp; lon_east in [-180 ; 180]
$
$ LAT_SOUTH : southern boundary
$ LAT_NORTH : northern boundary
$ lon_south &amp; lon_north in [-90 ; 90]
$
$ IS_GLOBAL（Ⅱ（6）） : set to 1 if the grid is global, else 0
$
$ IS_GLOBALB（Ⅳ）: set to 1 if the base grid is global, else 0
$

&amp;OUTGRID
TYPE = 'rect'
DX = 0.125
DY = 0.125
LON_WEST = -75
LON_EAST = -58
LAT_SOUTH = 36
LAT_NORTH = 46
IS_GLOBAL = 0
IS_GLOBALB = 0
/



$ d. Boundary options-------------------------------------------------------$

$ BOUNDARY : Option to determine which GSHHS
$ .mat file to load:
$ full = full resolution
$ high = 0.2 km
$ inter = 1 km
$ low = 5 km
$ coarse = 25 km
$
$ READ_BOUNDARY（？？？） : [0|1] flag to determine if input boundary information
$ needs to be read; boundary data files can be
$ significantly large and need to be read only the first
$ time. So when making multiple grids, the flag can be set
$ to 0 for subsequent grids.
$ (Note : If the workspace is cleared, the boundary data
$ will have to be read again)
$
$ OPT_POLY : [0|1] flag for reading the optional user-defined
$ polygons. Set to 0 if you do not wish to use this option
$
$ MIN_DIST（Ⅱ（3））??? : Used in compute_boundary and in split_boudnary;
$ threshold defining the minimum distance (in °) between
$ the edge of a polygon and the inside/outside boundary.
$ A low value reduces computation time but can raise
$ errors if the grid is too coarse. If the script crashes,
$ consider increasing the value.
$ (Default value in function used to be min_dist = 4)

&amp;GRID_BOUND
BOUNDARY = 'full'    
READ_BOUNDARY = 1
OPT_POLY = 0
MIN_DIST = 4
/



$ e. Parameter values used in the software-------------------------------------$

$ DRY_VAL : Depth value set for dry cells (can change as desired)
$ Used in 'generate_grid' and in the making of initial mask
$
$ CUT_OFF : Cut-off depth to distinguish between dry and wet cells.
$ All depths below the cut_off depth are marked wet
$ Used in 'generate_grid'
$ NOTE : If you have accurate boundary polygons, then it is
$ better to have a low value for CUT_OFF, which will make the
$ target bathymetry cell wet even when there are only few wet
$ cells in the base bathymetry. This will then be cleaned up
$ by the polygons in the 'mask cleanup' section. If, on the
$ other, hand you do not intend to use the polygons to define
$ the coastal domains, then you are better off with CUT_OFF = 0.5
$注意：如果你有精确的边界多边形，那么最好将CUT_OFF的值调低，
$这样会使目标测深单元变湿，即使在基本测深中只有少数湿单元。
$然后，这将被 "掩膜清理 "部分中的多边形清理掉。
$另一方面，如果你不打算用多边形来定义沿岸域，那么你最好使用 CUT_OFF = 0.5(???)。
$
$ LIM_BATHY(Ⅱ（2）)（？？？） : Proportion of base bathymetry cells that need to be wet for
$ the target cell to be considered wet.
$需要湿润的基础水深单元的比例，以使目标单元被认为是湿润的。
$
$ LIM_VAL（Ⅱ（5））（？？？） : Fraction of cell that has to be inside a polygon for the
$ cell to be marked dry
$
$ SPLIT_LIM（Ⅱ（4））（？？？） : Limit for splitting the polygons; used in split_boundary
$ Rule of thumbs: from 5 to 10 times max(dx,dy)
$
$
$ OFFSET : Additional buffer around the boundary to check if cell is
$ crossing boundary. Should be set to largest grid resolution
$ ie OFFSET = max([dx dy])
$ Used in 'clean_mask'
$
$ LAKE_TOL : Tolerance value that determines if all the wet cells
$ corresponding to a particular wet body should be flagged
$ dry or not.
$ Used in 'remove_lake'
$ if LAKE_TOL &gt; 0 : all water bodies having less than this
$ value of total wet cells will be flagged 
$ dry    $例如，如果为100，则弱湖泊（小水体）的单元输为60，则被认为是陆地，即dry
$ if LAKE_TOL = 0 : the output and input masks are unchanged.
$ if LAKE_TOL &lt; 0 : all but the largest water body is flagged
$ dry
$
$ OBSTR_OFFSET : Flag to determine if neighbours should be considered.
$ (0/1 = no/yes)
$ Used in 'create_obstr'

&amp;GRID_PARAM
DRY_VAL = 999999
CUT_OFF = 0
LIM_BATHY = 0.4                  
LIM_VAL = 0.5
SPLIT_LIM = 1.25                 %from 5 to 10 times max(dx,dy)
OFFSET = 0.125                    %OFFSET = max([dx dy])
LAKE_TOL = 100
OBSTR_OFFSET = 1
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>在<code>$area</code>文件夹下的<code>east_USA.m</code>，添加</p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token function">create_grid</span><span class="token punctuation">(</span><span class="token string">'$namelist/gridgen.east-USA_P125.nml'</span><span class="token punctuation">)</span>
<span class="token function">create_boundary</span><span class="token punctuation">(</span><span class="token string">'$namelist/gridgen.east-USA_P125.nml'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>运行。</p>
<blockquote>
<ul>
<li><p>生成的海陆掩码：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118142934.png"></p>
</li>
<li><p><code>$data</code>文件夹下生成的文件：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220118143206.png"></p>
</li>
</ul>
</blockquote>
</li>
</ol>
<h3 id="ww3-grid-nml创建（P25目标网格）"><a href="#ww3-grid-nml创建（P25目标网格）" class="headerlink" title="ww3_grid.nml创建（P25目标网格）"></a>ww3_grid.nml创建（P25目标网格）</h3><p>根据创建的目标网格，在<code>$data</code>创建<code>east-USA_P25_ww3_grid.nml</code>，文件内容：</p>
<blockquote>
<p>有部分内容是<code>.meta</code>文件的内容，记得路径修改成文件名称即可；</p>
</blockquote>
<blockquote>
<p>ww3需要用到的文件：</p>
<p><code>east-USA_P25_ww3_grid.nml</code></p>
<p><code>east-USA_P25.bot</code></p>
<p><code>east-USA_P25.mask</code></p>
<p><code>east-USA_P25.obst</code></p>
<p><code>namelists_east-USA_P25.nml</code></p>
<p>具体用到时，将这些文件放在<code>$inout</code>中。</p>
</blockquote>
<blockquote>
<p>问题：<font color="red">时间步长如何确定？（我算出来的很诡异），先使用600s的全局时间步长吧</font></p>
</blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">! -------------------------------------------------------------------- !
! Define the spectrum parameterization via SPECTRUM_NML namelist
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     SPECTRUM%XFR         = 0.            ! frequency increment
!     SPECTRUM%FREQ1       = 0.            ! first frequency (Hz)
!     SPECTRUM%NK          = 0             ! number of frequencies (wavenumbers)
!     SPECTRUM%NTH         = 0             ! number of direction bins
!     SPECTRUM%THOFF       = 0.            ! relative offset of first direction [-0.5,0.5]
! -------------------------------------------------------------------- !
&amp;SPECTRUM_NML
  SPECTRUM%XFR           =  1.1
  SPECTRUM%FREQ1         =  0.04118
  SPECTRUM%NK            =  32
  SPECTRUM%NTH           =  24
/



! -------------------------------------------------------------------- !
! Define the run parameterization via RUN_NML namelist
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     RUN%FLDRY            = F             ! dry run (I/O only, no calculation)
!     RUN%FLCX             = F             ! x-component of propagation
!     RUN%FLCY             = F             ! y-component of propagation
!     RUN%FLCTH            = F             ! direction shift
!     RUN%FLCK             = F             ! wavenumber shift
!     RUN%FLSOU            = F             ! source terms
! -------------------------------------------------------------------- !
&amp;RUN_NML
  RUN%FLCX            = T
  RUN%FLCY            = T
  RUN%FLCTH           = T
  RUN%FLSOU           = T
/



! -------------------------------------------------------------------- !
! Define the timesteps parameterization via TIMESTEPS_NML namelist
!
! * It is highly recommended to set up time steps which are multiple 
!   between them. 
!
! * The first time step to calculate is the maximum CFL time step
!   which depend on the lowest frequency FREQ1 previously set up and the
!   lowest spatial grid resolution in meters DXY.
!   reminder : 1 degree=60minutes // 1minute=1mile // 1mile=1.852km
!   The formula for the CFL time is :
!   Tcfl = DXY / (G / (FREQ1*4*Pi) ) with the constants Pi=3,14 and G=9.8m/s²;
!   DTXY  ~= 90% Tcfl
!   DTMAX ~= 3 * DTXY   (maximum global time step limit)
！  在这个例子中：
!   DXY=min(reslon * cosd(maxlat)*1852*60, reslon * cosd(minlat)*1852*60)
!      其中，reslon=0.25, maxlat=46, minlat=36
!      gridgen教程中附录算的是错的？？？
!   Tcfl ~= 1000
!   DTXY ~= 900
！
! * The refraction time step depends on how strong can be the current velocities
!   on your grid :
!   DTKTH ~= DTMAX / 2   ! in case of no or light current velocities
!   DTKTH ~= DTMAX / 10  ! in case of strong current velocities
!
! * The source terms time step is usually defined between 5s and 60s.
!   A common value is 10s.
!   DTMIN ~= 10
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     TIMESTEPS%DTMAX      = 0.         ! maximum global time step (s)
!     TIMESTEPS%DTXY       = 0.         ! maximum CFL time step for x-y (s)
!     TIMESTEPS%DTKTH      = 0.         ! maximum CFL time step for k-th (s)
!     TIMESTEPS%DTMIN      = 0.         ! minimum source term time step (s)
! -------------------------------------------------------------------- !
&amp;TIMESTEPS_NML
  TIMESTEPS%DTMAX         =   600.
  TIMESTEPS%DTXY          =   200.
  TIMESTEPS%DTKTH         =   300.
  TIMESTEPS%DTMIN         =   10.
/



! -------------------------------------------------------------------- !
! Define the grid to preprocess via GRID_NML namelist
!
! * the tunable parameters for source terms, propagation schemes, and 
!    numerics are read using namelists. 
! * Any namelist found in the folowing sections is temporarily written
!   to param.scratch, and read from there if necessary. 
! * The order of the namelists is immaterial.
! * Namelists not needed for the given switch settings will be skipped
!   automatically
!
! * grid type can be : 
!    'RECT' : rectilinear
!    'CURV' : curvilinear
!    'UNST' : unstructured (triangle-based)
!
! * coordinate system can be : 
!    'SPHE' : Spherical (degrees)
!    'CART' : Cartesian (meters)
!
! * grid closure can only be applied in spherical coordinates
!
! * grid closure can be : 
!    'NONE' : No closure is applied
!    'SMPL' : Simple grid closure. Grid is periodic in the
!           : i-index and wraps at i=NX+1. In other words,
!           : (NX+1,J) =&gt; (1,J). A grid with simple closure
!           : may be rectilinear or curvilinear.
!    'TRPL' : Tripole grid closure : Grid is periodic in the
!           : i-index and wraps at i=NX+1 and has closure at
!           : j=NY+1. In other words, (NX+1,J&lt;=NY) =&gt; (1,J)
!           : and (I,NY+1) =&gt; (NX-I+1,NY). Tripole
!           : grid closure requires that NX be even. A grid
!           : with tripole closure must be curvilinear.
!
! * The coastline limit depth is the value which distinguish the sea 
!   points to the land points. All the points with depth values (ZBIN)
!   greater than this limit (ZLIM) will be considered as excluded points
!   and will never be wet points, even if the water level grows over.
!   It can only overwrite the status of a sea point to a land point.
!   The value must have a negative value under the mean sea level
!
! * The minimum water depth allowed to compute the model is the absolute
!   depth value (DMIN) used in the model if the input depth is lower to 
!   avoid the model to blow up.
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     GRID%NAME             = 'unset'            ! grid name (30 char)
!     GRID%NML              = 'namelists.nml'    ! namelists filename
!     GRID%TYPE             = 'unset'            ! grid type
!     GRID%COORD            = 'unset'            ! coordinate system
!     GRID%CLOS             = 'unset'            ! grid closure
!
!     GRID%ZLIM             = 0.        ! coastline limit depth (m)
!     GRID%DMIN             = 0.        ! abs. minimum water depth (m)
!
!  下面所有项，在gridgen中生成.meta中有，全部复制过来。
! -------------------------------------------------------------------- !
&amp;GRID_NML
  GRID%NAME              =  'east-USA_P25'
  GRID%NML               =  'namelists_east-USA_P25.nml'
  GRID%TYPE              =  'RECT'
  GRID%COORD             =  'SPHE'
  GRID%CLOS              =  'NONE'
  GRID%ZLIM              =  -0.10
  GRID%DMIN              =   2.50
/


&amp;RECT_NML
  RECT%NX                =  69
  RECT%NY                =  41
!
  RECT%SX                =   0.250000000000
  RECT%SY                =   0.250000000000
  RECT%X0                =  -75.0000
  RECT%Y0                =   36.0000
/



! -------------------------------------------------------------------- !
! Define the depth to preprocess via DEPTH_NML namelist
! - for RECT and CURV grids -
!
! * if no obstruction subgrid, need to set &amp;MISC FLAGTR = 0
!
! * The depth value must have negative values under the mean sea level
!
! * value &lt;= value_read * scale_fac
!
! * IDLA : Layout indicator :
!                  1   : Read line-by-line bottom to top.  (default)
!                  2   : Like 1, single read statement.
!                  3   : Read line-by-line top to bottom.
!                  4   : Like 3, single read statement.
! * IDFM : format indicator :
!                  1   : Free format.  (default)
!                  2   : Fixed format.
!                  3   : Unformatted.
! * FORMAT : element format to read :
!               '(....)'  : auto detected  (default)
!               '(f10.6)' : float type
!
! * Example :
!      IDF  SF     IDLA  IDFM   FORMAT    FILENAME
!      50   0.001  1     1     '(....)'  'GLOB-30M.bot'
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     DEPTH%SF             = 1.       ! scale factor
!     DEPTH%FILENAME       = 'unset'  ! filename
!     DEPTH%IDF            = 50       ! file unit number
!     DEPTH%IDLA           = 1        ! layout indicator
!     DEPTH%IDFM           = 1        ! format indicator
!     DEPTH%FORMAT         = '(....)' ! formatted read format
! -------------------------------------------------------------------- !

&amp;DEPTH_NML
  DEPTH%SF             =  0.00
  DEPTH%FILENAME       = 'east-USA_P25.bot'
/

&amp;MASK_NML
  MASK%FILENAME         = 'east-USA_P25.mask'
/

&amp;OBST_NML
  OBST%SF              =  0.01
  OBST%FILENAME        = 'east-USA_P25.obst'
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="—————————————-1"><a href="#—————————————-1" class="headerlink" title="—————————————"></a>—————————————</h2><h2 id="参考资料-6"><a href="#参考资料-6" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://liu-jincan.github.io/2021/12/25/hai-lang-shu-zhi-mo-shi/wavewatch3/01-ww3-v6.07.1-xia-zai.w3-make/">https://liu-jincan.github.io/2021/12/25/hai-lang-shu-zhi-mo-shi/wavewatch3/01-ww3-v6.07.1-xia-zai.w3-make/</a></p>
<blockquote>
<p>WW3 v6.07.1：下载+./w3_make</p>
</blockquote>
<p><a href="https://liu-jincan.github.io/2022/01/02/hai-lang-shu-zhi-mo-shi/wavewatch3/06-tutorial-inout/#">https://liu-jincan.github.io/2022/01/02/hai-lang-shu-zhi-mo-shi/wavewatch3/06-tutorial-inout/#</a>!</p>
<blockquote>
<p><code>inout</code>教程；</p>
</blockquote>
<h2 id="w3-make测试生成-ww3文件"><a href="#w3-make测试生成-ww3文件" class="headerlink" title="./w3_make测试生成.ww3文件"></a>./w3_make测试生成.ww3文件</h2><p>下载WW3文件夹，按照参考资料的流程，能成功./w3_make。成功后，会生成<code>$model/exe</code>文件夹，其中包含了<code>.ww3</code>文件和配置文件<code>comp</code>, <code>link</code>, <code>switch</code>；</p>
<blockquote>
<p><code>$exe</code>文件夹可以更换名称，如<code>$exe_inout</code>表明在<code>inout</code>教程用到的<code>$exe</code>，换名后的<code>$exe</code>不会被<code>./w3_clean</code>和<code>./w3_new</code>清除，不换名，<code>$exe</code>会被更新；</p>
</blockquote>
<blockquote>
<p>这一步的主要作用是为了确定能生成<code>.ww3</code>文件，</p>
<p>如果不能成功./w3_make，接下来在<code>regtests</code>中，根据自己的需求配置<code>comp</code>、 <code>link</code>、<code>switch</code>，更加不可能实现；</p>
</blockquote>
<h2 id="—————————————-2"><a href="#—————————————-2" class="headerlink" title="—————————————"></a>—————————————</h2><h2 id="参考资料-7"><a href="#参考资料-7" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://liu-jincan.github.io/2021/12/25/hai-lang-shu-zhi-mo-shi/wavewatch3/03-regtests-wen-jian-jia-guan-fang-gei-de-ww3-yun-xing-li-zi/">https://liu-jincan.github.io/2021/12/25/hai-lang-shu-zhi-mo-shi/wavewatch3/03-regtests-wen-jian-jia-guan-fang-gei-de-ww3-yun-xing-li-zi/</a></p>
<blockquote>
<p>03-regtests文件夹（官方给的ww3运行例子）</p>
</blockquote>
<h2 id="在regtests的east-USA中，根据执行ww3-grid的run-test命令，配置相关文件并执行"><a href="#在regtests的east-USA中，根据执行ww3-grid的run-test命令，配置相关文件并执行" class="headerlink" title="在regtests的east-USA中，根据执行ww3_grid的run_test命令，配置相关文件并执行"></a>在regtests的east-USA中，根据执行ww3_grid的run_test命令，配置相关文件并执行</h2><ol>
<li><p>进入<code>$regtests</code>，新建<code>east-USA</code>文件夹；</p>
</li>
<li><p>在<code>east-USA</code>中，获取已经存在的 <code>run_test</code> 脚本；</p>
</li>
<li><p>了解运行<code>run_test</code>的重要参数：</p>
<ul>
<li><p><code>-i input</code> 表明，输入文件夹是，在<code>east-USA</code>下的<code>input</code>；</p>
<blockquote>
<p>可以更换<code>input</code>名称，例如<code>input2</code>；</p>
</blockquote>
</li>
<li><p><code>-s Ifremer1</code>表明，源项使用的是，在输入文件夹下的<code>switch_Ifremer1</code>；</p>
<blockquote>
<p>默认是输入文件夹下的<code>switch</code>；</p>
</blockquote>
<blockquote>
<p><code>switch_Ifremer1</code>文件来自于<code>$model/bin</code>；</p>
</blockquote>
</li>
<li><p><code>-N</code>表明，使用的是<code>.nml</code>，而不是<code>.inp</code>；</p>
</li>
<li><p><code>-g east-USA_P25</code>表明，ww3_grid名单列表文件名称<code>.</code>之前，是<code>ww3_grid_east-USA_P25</code>；</p>
<blockquote>
<p>默认是<code>ww3_grid</code>；</p>
</blockquote>
</li>
<li><p><code>-c Gnu</code>表明，编译使用的是，在<code>$model/bin</code>目录下的<code>comp.Gnu</code>和<code>link.Gnu</code>;</p>
<blockquote>
<p>终于不用创建什么<code>comp.comp.Gnu</code>这些奇怪的文件了；</p>
</blockquote>
<blockquote>
<p>我到目前为止（20220127），常用的是 Gnu；</p>
</blockquote>
<blockquote>
<p>默认的是在<code>$model/bin</code>目录下的<code>comp</code>和<code>link</code>;</p>
</blockquote>
</li>
<li><p><code>-w work</code>表明，输出（工作）文件夹是，在<code>east-USA</code>下的<code>work</code>;</p>
<blockquote>
<p>可以更换<code>work</code>名称，例如<code>work2</code>；</p>
</blockquote>
</li>
<li><p><code>-r ww3_grid</code>表明，程序仅仅执行<code>ww3_grid</code>过程；</p>
<blockquote>
<p><code>ww3_grid.ww3</code>会在程序运行的过程中，在<code>$model/exe</code>中创建；</p>
</blockquote>
<blockquote>
<p>在输出文件夹有，记录运行过程的文件<code>ww3_grid.out</code>；</p>
</blockquote>
<blockquote>
<p>类似的，<code>ww3_strt</code>，…</p>
</blockquote>
</li>
<li><p>…；</p>
</li>
</ul>
<p>执行ww3_grid的run_test命令为：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$regtests</span>
./east-USA/run_test -i input -c Gnu -s Ifremer1 -N -g east-USA_P25 -r ww3_grid -w work1 <span class="token punctuation">..</span>/model east-USA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>根据<code>执行ww3_grid的run_test命令</code>，配置相关文件（总共<strong>5+1=6</strong>个文件）：</p>
<ul>
<li><p>创建<code>input</code>输入文件夹；</p>
</li>
<li><p>确保<code>$model/bin</code>目录下有<code>comp.Gnu</code>和<code>link.Gnu</code>；</p>
</li>
<li><p>将源项<code>switch_Ifremer1</code>添加到输入文件夹；（<strong>1</strong>）</p>
<blockquote>
<p>与<code>-s Ifremer1</code>对应；</p>
</blockquote>
</li>
<li><p>将gridgen<code>$data</code>中的<code>east-USA_P25_ww3_grid.nml</code>、<code>east-USA_P25.bot</code>、<code>east-USA_P25.mask</code>、<code>east-USA_P25.obst</code>、<code>namelists_east-USA_P25.nml</code>复制粘贴到输入文件夹。（<strong>5</strong>）</p>
<blockquote>
<p><code>east-USA_P25_ww3_grid.nml</code>改成<code>ww3_grid_east-USA_P25.nml</code>，与<code>-g east-USA_P25</code>对应；</p>
</blockquote>
<blockquote>
<p><code>east-USA_P25.bot</code>、<code>east-USA_P25.mask</code>、<code>east-USA_P25.obst</code>、<code>namelists_east-USA_P25.nml</code>在run_test中有创建软连接的操作；（<strong>自己添加的这个操作</strong>）</p>
</blockquote>
</li>
</ul>
</li>
<li><p>执行，在输出文件夹得到结果；</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220127211027.png"></p>
</li>
</ol>
<h2 id="—————————————理想初始条件运行"><a href="#—————————————理想初始条件运行" class="headerlink" title="—————————————理想初始条件运行"></a>—————————————理想初始条件运行</h2><h2 id="参考资料-8"><a href="#参考资料-8" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://liu-jincan.github.io/2022/01/02/hai-lang-shu-zhi-mo-shi/wavewatch3/06-tutorial-inout/#">https://liu-jincan.github.io/2022/01/02/hai-lang-shu-zhi-mo-shi/wavewatch3/06-tutorial-inout/#</a>!</p>
<blockquote>
<p><code>inout</code>教程；</p>
</blockquote>
<h2 id="在regtests的east-USA中，根据执行ww3-strt的run-test命令，配置相关文件并执行"><a href="#在regtests的east-USA中，根据执行ww3-strt的run-test命令，配置相关文件并执行" class="headerlink" title="在regtests的east-USA中，根据执行ww3_strt的run_test命令，配置相关文件并执行"></a>在regtests的east-USA中，根据执行ww3_strt的run_test命令，配置相关文件并执行</h2><ol>
<li><p>执行ww3_strt的run_test命令为：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$regtests</span>
./east-USA/run_test -i input -c Gnu -s Ifremer1 -r ww3_strt -w work1 <span class="token punctuation">..</span>/model east-USA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>在输入文件夹中创建<code>ww3_strt.inp.1</code>，用此文件时<code>cp ww3_strt.inp.1 ww3_strt.inp</code>：</p>
<blockquote>
<p>在<code>$model/nml</code>中没有<code>ww3_strt.nml</code>，在<code>$model/inp</code>中有<code>ww3_strt.inp</code>；</p>
</blockquote>
<blockquote>
<p>inout教程中的ww3_strt.inp文件，与<code>$model/inp</code>中的一致，如下：</p>
<p><strong>不是很懂里面的设置</strong></p>
<pre class="line-numbers language-inp" data-language="inp"><code class="language-inp">$ -------------------------------------------------------------------- $
$ WAVEWATCH III Initial conditions input file                          $
$--------------------------------------------------------------------- $
$ type of initial field ITYPE .
$
 1
$
$ ITYPE = 1 ---------------------------------------------------------- $
$ Gaussian in frequency and space, cos type in direction.
$ - fp and spread (Hz), mean direction (degr., oceanographic
$    convention) and cosine power, Xm and spread (degr. or m) Ym and
$    spread (degr. or m), Hmax (m) (Example for lon-lat grid in degr.).
$
$   0.10  0.01  270. 2  1. 0.5 1. 0.5 2.5
 0.10  0.01  270. 2  0. 1000. 1. 1000. 2.5
$   0.10  0.01  270. 2  0. 1000. 1. 1000. 0.01
$   0.10  0.01  270. 2  0. 1000. 1. 1000. 0.
$
$ ITYPE = 2 ---------------------------------------------------------- $
$ JONSWAP spectrum with Hasselmann et al. (1980) direct. distribution.
$ - alfa, peak freq. (Hz), mean direction (degr., oceanographical
$   convention), gamma, sigA, sigB, Xm and spread (degr. or m) Ym and
$   spread (degr. or m)  (Example for lon-lat grid in degr.).
$   alfa, sigA, sigB give default values if less than or equal to 0.
$
$   0.0081  0.1  270.  1.0 0. 0. 1. 100. 1. 100.
$
$ ITYPE = 3 ---------------------------------------------------------- $
$ Fetch-limited JONSWAP
$ - No additional data, the local spectrum is calculated using the
$   local wind speed and direction, using the spatial grid size as
$   fetch, and assuring that the spectrum is within the discrete
$   frequency range.
$
$ ITYPE = 4 ---------------------------------------------------------- $
$ User-defined spectrum
$ - Scale factor., defaults to 1 if less than or equal 0.
$ - Spectrum F(f,theta) (single read statement)
$
$ -0.1
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 1 4 2 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 1 2 3 2 1 1 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 1 3 9 7 5 3 2 1 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 1 3 4 3 2 1 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
$
$ ITYPE = 5 ---------------------------------------------------------- $
$ Starting from calm conditions.
$ - No additional data.
$
$ -------------------------------------------------------------------- $
$ End of input file                                                    $
$ -------------------------------------------------------------------- $<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<p>先用<code>$model/inp</code>中的这个文件吧。</p>
</li>
<li><p>执行，在输出文件夹得到结果：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220128120046.png"></p>
</li>
</ol>
<h2 id="在regtests的east-USA中，根据执行ww3-shel的run-test命令，配置相关文件并执行"><a href="#在regtests的east-USA中，根据执行ww3-shel的run-test命令，配置相关文件并执行" class="headerlink" title="在regtests的east-USA中，根据执行ww3_shel的run_test命令，配置相关文件并执行"></a>在regtests的east-USA中，根据执行ww3_shel的run_test命令，配置相关文件并执行</h2><ol>
<li><p>执行ww3_shel的run_test命令为：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$regtests</span>
./east-USA/run_test -i input -c Gnu -s Ifremer1 -N -r ww3_shel -w work1 <span class="token punctuation">..</span>/model east-USA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>在输入文件夹中创建<code>ww3_shel.nml.strt</code>，用此文件时<code>cp ww3_shel.nml.strt ww3_shel.nml</code>：</p>
<blockquote>
<p>先采用inout教程中最初始的<code>ww3_shel.nml</code>;</p>
</blockquote>
<blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">! -------------------------------------------------------------------- !
! WAVEWATCH III ww3_shel.nml - single-grid model                       !
! -------------------------------------------------------------------- !


! -------------------------------------------------------------------- !
! Define top-level model parameters via DOMAIN_NML namelist
!
! * IOSTYP defines the output server mode for parallel implementation.
!             0 : No data server processes, direct access output from
!                 each process (requires true parallel file system).
!             1 : No data server process. All output for each type 
!                 performed by process that performs computations too.
!             2 : Last process is reserved for all output, and does no
!                 computing.
!             3 : Multiple dedicated output processes.
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     DOMAIN%IOSTYP =  1                 ! Output server type
!     DOMAIN%START  = '19680606 000000'  ! Start date for the entire model 
!     DOMAIN%STOP   = '19680607 000000'  ! Stop date for the entire model
! -------------------------------------------------------------------- !
&amp;DOMAIN_NML
  DOMAIN%START   = '20110902 000000'
  DOMAIN%STOP    = '20110902 060000'
/

! -------------------------------------------------------------------- !
! Define each forcing via the INPUT_NML namelist
!
! * The FORCING flag can be  : F for "no forcing"
!                              T for "external forcing file"
!                              H for "homogenous forcing input"
!                              C for "coupled forcing field"
!
! * homogeneous forcing is not available for ICE_CONC
!
! * The ASSIM flag can :  F for "no forcing"
!                         T for "external forcing file"
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     INPUT%FORCING%WATER_LEVELS  = F
!     INPUT%FORCING%CURRENTS      = F
!     INPUT%FORCING%WINDS         = F
!     INPUT%FORCING%ICE_CONC      = F
!     INPUT%FORCING%ICE_PARAM1    = F
!     INPUT%FORCING%ICE_PARAM2    = F
!     INPUT%FORCING%ICE_PARAM3    = F
!     INPUT%FORCING%ICE_PARAM4    = F
!     INPUT%FORCING%ICE_PARAM5    = F
!     INPUT%FORCING%MUD_DENSITY   = F
!     INPUT%FORCING%MUD_THICKNESS = F
!     INPUT%FORCING%MUD_VISCOSITY = F
!     INPUT%ASSIM%MEAN            = F
!     INPUT%ASSIM%SPEC1D          = F
!     INPUT%ASSIM%SPEC2D          = F
! -------------------------------------------------------------------- !
&amp;INPUT_NML
/

! -------------------------------------------------------------------- !
! Define the output types point parameters via OUTPUT_TYPE_NML namelist
!
! * the point file is a space separated values per line : lon lat 'name'
!
! * the full list of field names is : 
!  DPT CUR WND AST WLV ICE IBG D50 IC1 IC5 HS LM T02 T0M1 T01 FP DIR SPR
!  DP HIG EF TH1M STH1M TH2M STH2M WN PHS PTP PLP PDIR PSPR PWS TWS PNR
!  UST CHA CGE FAW TAW TWA WCC WCF WCH WCM SXY TWO BHD FOC TUS USS P2S
!  USF P2L TWI FIC ABR UBR BED FBB TBB MSS MSC DTD FC CFX CFD CFK U1 U2 
!
! * output track file formatted (T) or unformated (F)
!
! * coupling fields exchanged list is :
!   - Sent fields by ww3:
!       - Ocean model : T0M1 OCHA OHS DIR BHD TWO UBR FOC TAW TUS USS LM DRY
!       - Atmospheric model : ACHA AHS TP (or FP) FWS
!       - Ice model : IC5 TWI
!   - Received fields by ww3:
!       - Ocean model : SSH CUR
!       - Atmospheric model : WND
!       - Ice model : ICE IC1 IC5
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     TYPE%FIELD%LIST         =  'unset'
!     TYPE%POINT%FILE         =  'points.list'
!     TYPE%TRACK%FORMAT       =  T
!     TYPE%PARTITION%X0       =  0
!     TYPE%PARTITION%XN       =  0
!     TYPE%PARTITION%NX       =  0
!     TYPE%PARTITION%Y0       =  0
!     TYPE%PARTITION%YN       =  0
!     TYPE%PARTITION%NY       =  0
!     TYPE%PARTITION%FORMAT   =  T
!     TYPE%COUPLING%SENT      = 'unset'
!     TYPE%COUPLING%RECEIVED  = 'unset'
!
! -------------------------------------------------------------------- !
&amp;OUTPUT_TYPE_NML
  TYPE%FIELD%LIST          = 'HS FP DIR DP CHA UST DPT CUR WND'
/

! -------------------------------------------------------------------- !
! Define output dates via OUTPUT_DATE_NML namelist
!
! * start and stop times are with format 'yyyymmdd hhmmss'
! * if time stride is equal '0', then output is disabled
! * time stride is given in seconds
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     DATE%FIELD%START         =  '19680606 000000'
!     DATE%FIELD%STRIDE        =  '0'
!     DATE%FIELD%STOP          =  '19680607 000000'
!     DATE%POINT%START         =  '19680606 000000'
!     DATE%POINT%STRIDE        =  '0'
!     DATE%POINT%STOP          =  '19680607 000000'
!     DATE%TRACK%START         =  '19680606 000000'
!     DATE%TRACK%STRIDE        =  '0'
!     DATE%TRACK%STOP          =  '19680607 000000'
!     DATE%RESTART%START       =  '19680606 000000'
!     DATE%RESTART%STRIDE      =  '0'
!     DATE%RESTART%STOP        =  '19680607 000000'
!     DATE%BOUNDARY%START      =  '19680606 000000'
!     DATE%BOUNDARY%STRIDE     =  '0'
!     DATE%BOUNDARY%STOP       =  '19680607 000000'
!     DATE%PARTITION%START     =  '19680606 000000'
!     DATE%PARTITION%STRIDE    =  '0'
!     DATE%PARTITION%STOP      =  '19680607 000000'
!     DATE%COUPLING%START      =  '19680606 000000'
!     DATE%COUPLING%STRIDE     =  '0'
!     DATE%COUPLING%STOP       =  '19680607 000000'
!
!     DATE%RESTART             =  '19680606 000000' '0' '19680607 000000'
! -------------------------------------------------------------------- !
&amp;OUTPUT_DATE_NML
  DATE%FIELD          = '20110902 000000' '3600' '20110902 060000'
/

! -------------------------------------------------------------------- !
! Define homogeneous input via HOMOG_COUNT_NML and HOMOG_INPUT_NML namelist
!
! * the number of each homogeneous input is defined by HOMOG_COUNT
! * the total number of homogeneous input is automatically calculated
! * the homogeneous input must start from index 1 to N
! * if VALUE1 is equal 0, then the homogeneous input is desactivated
! * NAME can be IC1, IC2, IC3, IC4, IC5, MDN, MTH, MVS, LEV, CUR, WND, ICE, MOV
! * each homogeneous input is defined over a maximum of 3 values detailled below :
!     - IC1 is defined by thickness
!     - IC2 is defined by viscosity
!     - IC3 is defined by density
!     - IC4 is defined by modulus
!     - IC5 is defined by floe diameter
!     - MDN is defined by density
!     - MTH is defined by thickness
!     - MVS is defined by viscosity
!     - LEV is defined by height
!     - CUR is defined by speed and direction
!     - WND is defined by speed, direction and airseatemp
!     - ICE is defined by concentration
!     - MOV is defined by speed and direction
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     HOMOG_COUNT%N_IC1            =  0
!     HOMOG_COUNT%N_IC2            =  0
!     HOMOG_COUNT%N_IC3            =  0
!     HOMOG_COUNT%N_IC4            =  0
!     HOMOG_COUNT%N_IC5            =  0
!     HOMOG_COUNT%N_MDN            =  0
!     HOMOG_COUNT%N_MTH            =  0
!     HOMOG_COUNT%N_MVS            =  0
!     HOMOG_COUNT%N_LEV            =  0
!     HOMOG_COUNT%N_CUR            =  0
!     HOMOG_COUNT%N_WND            =  0
!     HOMOG_COUNT%N_ICE            =  0
!     HOMOG_COUNT%N_MOV            =  0
!
!     HOMOG_INPUT(I)%NAME           =  'unset'
!     HOMOG_INPUT(I)%DATE           =  '19680606 000000'
!     HOMOG_INPUT(I)%VALUE1         =  0
!     HOMOG_INPUT(I)%VALUE2         =  0
!     HOMOG_INPUT(I)%VALUE3         =  0
! -------------------------------------------------------------------- !
&amp;HOMOG_COUNT_NML
/

&amp;HOMOG_INPUT_NML
/


! -------------------------------------------------------------------- !
! WAVEWATCH III - end of namelist                                      !
! -------------------------------------------------------------------- !<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote>
</li>
<li><p>执行，在输出文件夹得到结果：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220128144719.png"></p>
<p><code>cat log.ww3 | less</code>：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220128145435.png"></p>
</li>
</ol>
<h2 id="在regtests的east-USA中，根据执行ww3-ounf的run-test命令，配置相关文件并执行"><a href="#在regtests的east-USA中，根据执行ww3-ounf的run-test命令，配置相关文件并执行" class="headerlink" title="在regtests的east-USA中，根据执行ww3_ounf的run_test命令，配置相关文件并执行"></a>在regtests的east-USA中，根据执行ww3_ounf的run_test命令，配置相关文件并执行</h2><ol>
<li><p>执行ww3_ounf的run_test命令为：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$regtests</span>
./east-USA/run_test -i input -c Gnu -s Ifremer1 -N -r ww3_ounf -w work1 -o netcdf <span class="token punctuation">..</span>/model east-USA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p><code>-o netcdf</code>输出文件类型为<code>netcdf</code>；</p>
</blockquote>
</li>
<li><p>在输入文件夹中创建<code>ww3_ounf.nml.1</code>，用此文件时，<code>cp ww3_ounf.nml.2 ww3_ounf.nml</code>：</p>
<blockquote>
<p>先采用inout教程中的<code>ww3_ounf.nml</code>;</p>
<p>这里需要确定时间（<strong>FIELD的时间</strong>），不是很懂这里的设置；</p>
</blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">! -------------------------------------------------------------------- !
! WAVEWATCH III ww3_ounf.nml - Grid output post-processing             !
! -------------------------------------------------------------------- !

! -------------------------------------------------------------------- !
! Define the output fields to postprocess via FIELD_NML namelist
!
! * the full list of field names FIELD%LIST is : 
!  DPT CUR WND AST WLV ICE IBG D50 IC1 IC5 HS LM T02 T0M1 T01 FP DIR SPR
!  DP HIG EF TH1M STH1M TH2M STH2M WN PHS PTP PLP PDIR PSPR PWS TWS PNR
!  UST CHA CGE FAW TAW TWA WCC WCF WCH WCM SXY TWO BHD FOC TUS USS P2S
!  USF P2L TWI FIC ABR UBR BED FBB TBB MSS MSC DTD FC CFX CFD CFK U1 U2 
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     FIELD%TIMESTART            = '19000101 000000'  ! Stop date for the output field
!     FIELD%TIMESTRIDE           = '0'                ! Time stride for the output field
!     FIELD%TIMESTOP             = '29001231 000000'  ! Stop date for the output field
!     FIELD%TIMECOUNT            = '1000000000'       ! Number of time steps
!     FIELD%TIMESPLIT            = 6                  ! [4(yearly),6(monthly),8(daily),10(hourly)]
!     FIELD%LIST                 = 'unset'            ! List of output fields
!     FIELD%PARTITION            = '0 1 2 3'          ! List of wave partitions ['0 1 2 3 4 5']
!     FIELD%SAMEFILE             = T                  ! All the variables in the same file [T|F]
!     FIELD%TYPE                 = 3                  ! [2 = SHORT, 3 = it depends , 4 = REAL]
! -------------------------------------------------------------------- !
&amp;FIELD_NML
  FIELD%TIMESTART        =  '20080310 000000'
  FIELD%TIMESTRIDE       =  '180'
  FIELD%TIMECOUNT        =  '100'
  FIELD%LIST             =  'HS FP DIR DP CHA UST DPT CUR WND'
  FIELD%PARTITION        =  '0'
/

! -------------------------------------------------------------------- !
! Define the content of the input file via FILE_NML namelist
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     FILE%PREFIX        = 'ww3.'            ! Prefix for output file name
!     FILE%NETCDF        = 3                 ! Netcdf version [3|4]
!     FILE%IX0           = 1                 ! First X-axis or node index
!     FILE%IXN           = 1000000000        ! Last X-axis or node index
!     FILE%IY0           = 1                 ! First Y-axis index
!     FILE%IYN           = 1000000000        ! Last Y-axis index
! -------------------------------------------------------------------- !
&amp;FILE_NML
/


! -------------------------------------------------------------------- !
! Define the content of the output file via SMC_NML namelist
!
! * For SMC grids, IX0, IXN, IY0 and IYN from FILE_NML are not used.
!   Two types of output are available:
! *   TYPE=1: Flat 1D "seapoint" array of grid cells.
! *   TYPE=2: Re-gridded regular grid with cell sizes being an integer
! *           multiple of the smallest SMC grid cells size.
!
! * Note that the first/last longitudes and latitudes will be adjusted
!  to snap to the underlying SMC grid edges. CELFAC is only used for
!  type 2 output and defines the output cell sizes as an integer
!  multiple of the smallest SMC Grid cell size. CELFAC should be a
!  power of 2, e.g: 1,2,4,8,16, etc...
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     SMC%TYPE          = 1              ! SMC Grid type (1 or 2)
!     SMC%SXO           = -999.9         ! First longitude
!     SMC%EXO           = -999.9         ! Last longitude
!     SMC%SYO           = -999.9         ! First latitude
!     SMC%EYO           = -999.9         ! Last latitude
!     SMC%CELFAC        = 1              ! Cell size factor (SMCTYPE=2 only)
!     SMC%NOVAL         = UNDEF          ! Fill value for wet cells with no data
! -------------------------------------------------------------------- !
&amp;SMC_NML
/

! -------------------------------------------------------------------- !
! WAVEWATCH III - end of namelist                                      !
! -------------------------------------------------------------------- !
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>执行，在输出文件夹得到结果：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220128181732.png"></p>
</li>
<li><p>ncview可视化nc文件：</p>
<p><code>ncview ww3.201109.nc</code>，查看Hs：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/15.gif"></p>
</li>
</ol>
<h2 id="了解ww3-strt-inp参数"><a href="#了解ww3-strt-inp参数" class="headerlink" title="了解ww3_strt.inp参数"></a>了解ww3_strt.inp参数</h2><h3 id="case-1：已有的"><a href="#case-1：已有的" class="headerlink" title="case 1：已有的"></a>case 1：已有的</h3><p>0.10  0.01  270. 2  0. 1000. 1. 1000. 2.5</p>
<h3 id="case-2"><a href="#case-2" class="headerlink" title="case 2"></a>case 2</h3><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220128193641.png" style="zoom:80%;">

<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/16.gif"></p>
<h3 id="case-3：0"><a href="#case-3：0" class="headerlink" title="case 3：0"></a>case 3：0</h3><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204160714.png" alt=" " style="zoom:80%;">

<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204160854.png"></p>
<blockquote>
<p>当时间变化时，图像不变，即都为0；</p>
</blockquote>
<h3 id="问题：将-case-2-中生成的restart-ww3文件更换为-case-3-中的，再ww3-shel，图像是-case-3-中的吗？"><a href="#问题：将-case-2-中生成的restart-ww3文件更换为-case-3-中的，再ww3-shel，图像是-case-3-中的吗？" class="headerlink" title="问题：将 case 2 中生成的restart.ww3文件更换为 case 3 中的，再ww3_shel，图像是  case 3 中的吗？"></a>问题：将 case 2 中生成的restart.ww3文件更换为 case 3 中的，再ww3_shel，图像是  case 3 中的吗？</h3><p>是的~~</p>
<p><strong>结论</strong>：运行不是目的，得到相应的.ww3文件才是~~</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204162043.png"></p>
<h3 id="问题：case-3-不需要restart-ww3，再ww3-shel，可行吗？"><a href="#问题：case-3-不需要restart-ww3，再ww3-shel，可行吗？" class="headerlink" title="问题：case 3 不需要restart.ww3，再ww3_shel，可行吗？"></a>问题：case 3 不需要restart.ww3，再ww3_shel，可行吗？</h3><p>可行~</p>
<p>得到的nc文件与 case 3 有 restart.ww3 时一致~~</p>
<p>log.ww3 是否也一致？<strong>不一致</strong>~~</p>
<p>calm</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204164001.png" alt="无restart.ww3时的log.ww3"></p>
<p>idealized</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220204164310.png" alt="有restart.ww3时的log.ww3"></p>
<h2 id="—————————————CCMP风场下运行"><a href="#—————————————CCMP风场下运行" class="headerlink" title="—————————————CCMP风场下运行"></a>—————————————CCMP风场下运行</h2><h2 id="参考资料-9"><a href="#参考资料-9" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://liu-jincan.github.io/2022/01/02/wavewatch3/06-tutorial-inout/">https://liu-jincan.github.io/2022/01/02/wavewatch3/06-tutorial-inout/</a></p>
<blockquote>
<p><code>inout</code>教程；</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://data.remss.com/ccmp/">https://data.remss.com/ccmp/</a></p>
<blockquote>
<p>来自于老师；</p>
<p>CCMP介绍中还有ftp；</p>
</blockquote>
<h2 id="在regtests的east-USA中，根据执行ww3-prnc的run-test命令，配置相关文件并执行"><a href="#在regtests的east-USA中，根据执行ww3-prnc的run-test命令，配置相关文件并执行" class="headerlink" title="在regtests的east-USA中，根据执行ww3_prnc的run_test命令，配置相关文件并执行"></a>在regtests的east-USA中，根据执行ww3_prnc的run_test命令，配置相关文件并执行</h2><ol>
<li><p>用<code>download_ccmp.m</code>从<a target="_blank" rel="noopener" href="https://data.remss.com/ccmp/%E8%8E%B7%E5%8F%96%E5%8C%85%E5%90%AB%E6%89%80%E9%9C%80%E6%97%B6%E9%97%B4%E6%AE%B5%E7%9A%84nc%E6%96%87%E4%BB%B6%EF%BC%8C%E6%94%BE%E5%9C%A8%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%EF%BC%9B%E5%86%8D%E7%94%A8%60merge_ccmp_ww3.m%60%E5%B0%86%E8%BF%99%E4%BA%9Bnc%E6%96%87%E4%BB%B6%E5%90%88%E6%88%90%E4%B8%80%E4%B8%AA%EF%BC%8C%E6%94%BE%E8%BF%9B%E8%BE%93%E5%85%A5%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%AD%EF%BC%8C%E9%87%8D%E5%91%BD%E5%90%8D%E4%B8%BA%60wind.nc.ccmp01to10%60%EF%BC%8C%E7%94%A8%E6%AD%A4%E9%A3%8E%E5%9C%BA%E6%96%87%E4%BB%B6%E6%97%B6%EF%BC%8C%60cp">https://data.remss.com/ccmp/获取包含所需时间段的nc文件，放在一个文件夹下；再用`merge_ccmp_ww3.m`将这些nc文件合成一个，放进输入文件夹中，重命名为`wind.nc.ccmp01to10`，用此风场文件时，`cp</a> wind.nc.ccmp01to10 wind.nc`。</p>
</li>
<li><p>执行ww3_prnc的run_test命令为：（info中有记录）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$regtests</span>
./east-USA/run_test -i input -c Gnu -s Ifremer1 -N -r ww3_prnc -w work3 <span class="token punctuation">..</span>/model east-USA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>在输入文件夹中创建<code>ww3_prnc.nml.1</code>，用此文件时<code>cp ww3_prnc.nml.1 ww3_prnc.nml</code>：</p>
<blockquote>
<p>（主要参考inout教程中的，$model中也有）</p>
</blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">   ! -------------------------------------------------------------------- !
   ! WAVEWATCH III ww3_prnc.nml - Field preprocessor                      !
   ! -------------------------------------------------------------------- !
   
   
   ! -------------------------------------------------------------------- !
   ! Define the forcing fields to preprocess via FORCING_NML namelist
   !
   ! * only one FORCING%FIELD can be set at true
   ! * only one FORCING%grid can be set at true
   ! * tidal constituents FORCING%tidal is only available on grid%asis with FIELD%level or FIELD%current
   !
   ! * namelist must be terminated with /
   ! * definitions &amp; defaults:
   !     FORCING%TIMESTART            = '19000101 000000'  ! Start date for the forcing field
   !     FORCING%TIMESTOP             = '29001231 000000'  ! Stop date for the forcing field
   !
   !     FORCING%FIELD%ICE_PARAM1     = F           ! Ice thickness                      (1-component)
   !     FORCING%FIELD%ICE_PARAM2     = F           ! Ice viscosity                      (1-component)
   !     FORCING%FIELD%ICE_PARAM3     = F           ! Ice density                        (1-component)
   !     FORCING%FIELD%ICE_PARAM4     = F           ! Ice modulus                        (1-component)
   !     FORCING%FIELD%ICE_PARAM5     = F           ! Ice floe mean diameter             (1-component)
   !     FORCING%FIELD%MUD_DENSITY    = F           ! Mud density                        (1-component)
   !     FORCING%FIELD%MUD_THICKNESS  = F           ! Mud thickness                      (1-component)
   !     FORCING%FIELD%MUD_VISCOSITY  = F           ! Mud viscosity                      (1-component)
   !     FORCING%FIELD%WATER_LEVELS   = F           ! Level                              (1-component)
   !     FORCING%FIELD%CURRENTS       = F           ! Current                            (2-components)
   !     FORCING%FIELD%WINDS          = F           ! Wind                               (2-components)
   !     FORCING%FIELD%WIND_AST       = F           ! Wind and air-sea temp. dif.        (3-components)
   !     FORCING%FIELD%ICE_CONC       = F           ! Ice concentration                  (1-component)
   !     FORCING%FIELD%ICE_BERG       = F           ! Icebergs and sea ice concentration (2-components)
   !     FORCING%FIELD%DATA_ASSIM     = F           ! Data for assimilation              (1-component)
   !
   !     FORCING%GRID%ASIS            = F           ! Transfert field 'as is' on the model grid
   !     FORCING%GRID%LATLON          = F           ! Define field on regular lat/lon or cartesian grid
   !
   !     FORCING%TIDAL                = 'unset'     ! Set the tidal constituents [FAST | VFAST | 'M2 S2 N2']
   ! -------------------------------------------------------------------- !
   &amp;FORCING_NML
     FORCING%FIELD%WINDS          = T
     FORCING%GRID%LATLON          = T
   /
   
   ! -------------------------------------------------------------------- !
   ! Define the content of the input file via FILE_NML namelist
   !
   ! * input file must respect netCDF format and CF conventions
   ! * input file must contain :
   !      -dimension : time, name expected to be called time
   !      -dimension : longitude/latitude, names can defined in the namelist
   !      -variable : time defined along time dimension
   !      -attribute : time with attributes units written as ISO8601 convention
   !      -attribute : time with attributes calendar set to standard as CF convention
   !      -variable : longitude defined along longitude dimension
   !      -variable : latitude defined along latitude dimension
   !      -variable : field defined along time,latitude,longitude dimensions
   ! * FILE%VAR(I) must be set for each field component
   !
   ! * namelist must be terminated with /
   ! * definitions &amp; defaults:
   !     FILE%FILENAME      = 'unset'           ! relative path input file name
   !     FILE%LONGITUDE     = 'unset'           ! longitude/x dimension name
   !     FILE%LATITUDE      = 'unset'           ! latitude/y dimension name
   !     FILE%VAR(I)        = 'unset'           ! field component
   !     FILE%TIMESHIFT     = '00000000 000000' ! shift the time value to 'YYYYMMDD HHMMSS'
   ! -------------------------------------------------------------------- !
   &amp;FILE_NML
     FILE%FILENAME      = 'wind.nc'
     FILE%LONGITUDE     = 'longitude'
     FILE%LATITUDE      = 'latitude'
     FILE%VAR(1)        = 'u10m'
     FILE%VAR(2)        = 'v10m'
   /
   
   
   ! -------------------------------------------------------------------- !
   ! WAVEWATCH III - end of namelist                                      !
! -------------------------------------------------------------------- !<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>执行，在输出文件夹得到结果：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210174810.png"></p>
<blockquote>
<p>建议把生成的<code>wind.ww3</code>文件保存到输入文件夹，<code>wind.ww3.ccmp01to10</code>。</p>
</blockquote>
</li>
</ol>
<h2 id="问题：ww3-prnc，为什么inout教程的wind-nc可以，老师的wind-nc可以，ccmp的不行；"><a href="#问题：ww3-prnc，为什么inout教程的wind-nc可以，老师的wind-nc可以，ccmp的不行；" class="headerlink" title="问题：ww3_prnc，为什么inout教程的wind.nc可以，老师的wind.nc可以，ccmp的不行；"></a>问题：ww3_prnc，为什么inout教程的wind.nc可以，老师的wind.nc可以，ccmp的不行；</h2><p>出现的错误：</p>
<pre class="line-numbers language-none"><code class="language-none">Program received signal SIGSEGV: Segmentation fault - invalid memory reference.

Backtrace for this error:
#0  0x7f1c8d109d21 in ???
#1  0x7f1c8d108ef5 in ???
#2  0x7f1c8cd4020f in ???
#3  0x7f1c8cab6d95 in ???
#4  0x7f1c8cf507d1 in ???
#5  0x561a038418e6 in ???
#6  0x561a037cd003 in ???
#7  0x561a037ca6b8 in ???
#8  0x7f1c8cd210b2 in ???
#9  0x561a037ca6ed in ???
#10  0xffffffffffffffff in ???
./east-USA/run_test: line 1257: 42224 Segmentation fault      (core dumped) $path_e/$prog &gt; $ofile

ERROR: Error occured during /home/xuniji1/WW3-6.07.1/model/exe/ww3_prnc execution<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>探索发现的问题：（nc文件的format？）</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220206231221.png"></p>
<p>解决方法可能是 ccmp 的read_routine 教程，生成新的 ccmp 的 nc 文件；（<strong>失败</strong>）</p>
<p>解决办法可能是需要合并 ccmp 的nc文件；（<strong>失败</strong>）</p>
<p>解决办法可能是 nc 文件的format问题，因为inout教程文件都是 <code>64-bit</code>，而ccmp的是<code>class</code>；（<strong>失败</strong>，老师的也是<code>class</code>）</p>
<p>解决办法可能是 nc 文件的变量type问题，因为inout教程和老师的文件都是 <code>double</code>，而ccmp的是<code>single</code>；（<strong>失败</strong>）</p>
<p>分析，将inout的nc文件，进行<code>merge_ccmp.m</code>，能否成功？（<strong>失败</strong>）是内容的问题，还是<strong>merge问题</strong></p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">&gt;&gt; netcdf.endDef(cid);
错误使用 netcdflib
NetCDF 库在执行 'endDef' 函数期间遇到错误 - 'Not a valid data type or _FillValue type mismatch (NC_EBADTYPE)'。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>_FillValue</code>名称不统一；</p>
</blockquote>
<p>尝试<code>NETCDF4</code>模式？（失败）</p>
<p>尝试减少没必要的属性？（<strong>成功</strong>）</p>
<blockquote>
<p>ww3_prnc.nml 要求</p>
<pre class="line-numbers language-none"><code class="language-none">...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<blockquote>
<p>完全按照inout教程的：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210151514.png"></p>
<p>我的：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210151642.png"></p>
</blockquote>
<p>尝试在ubuntu上建立？</p>
<p>尝试求助大佬？</p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210143504.png"></p>
<img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210152001.png" alt=" " style="zoom:80%;">
</blockquote>
<p>分析<code>inout</code>教程；</p>
<ol>
<li>ww3_prnc的运行是需要ww3_grid运行的结果<code>mod_def.ww3</code>，单独运行ww3_prnc，仍然是那个错误；</li>
</ol>
<h2 id="在regtests的east-USA中，根据执行ww3-shel的run-test命令，配置相关文件并执行-1"><a href="#在regtests的east-USA中，根据执行ww3-shel的run-test命令，配置相关文件并执行-1" class="headerlink" title="在regtests的east-USA中，根据执行ww3_shel的run_test命令，配置相关文件并执行"></a>在regtests的east-USA中，根据执行ww3_shel的run_test命令，配置相关文件并执行</h2><ol>
<li><p>执行ww3_shel的run_test命令为：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$regtests</span>
./east-USA/run_test -i input -c Gnu -s Ifremer1 -N -r ww3_shel -w work3 <span class="token punctuation">..</span>/model east-USA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>在输入文件夹中创建<code>ww3_shel.nml.***</code>，先采用inout教程中最初始的<code>ww3_shel.nml</code>模板，然后将风输入的强制标志设置为“<code>外部强制文件(external forcing field)</code>”的 <code>'T'</code>；用此文件时，<code>cp ww3_shel.nml.*** ww3_shel.nml</code>，以下是<code>ww3_shel.nml.wind</code>：</p>
<blockquote>
<p>这里确定时间段（domain 时间、output 时间）~~</p>
</blockquote>
<blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">! -------------------------------------------------------------------- !
! WAVEWATCH III ww3_shel.nml - single-grid model                       !
! -------------------------------------------------------------------- !


! -------------------------------------------------------------------- !
! Define top-level model parameters via DOMAIN_NML namelist
!
! * IOSTYP defines the output server mode for parallel implementation.
!             0 : No data server processes, direct access output from
!                 each process (requires true parallel file system).
!             1 : No data server process. All output for each type 
!                 performed by process that performs computations too.
!             2 : Last process is reserved for all output, and does no
!                 computing.
!             3 : Multiple dedicated output processes.
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     DOMAIN%IOSTYP =  1                 ! Output server type
!     DOMAIN%START  = '19680606 000000'  ! Start date for the entire model 
!     DOMAIN%STOP   = '19680607 000000'  ! Stop date for the entire model
! -------------------------------------------------------------------- !
&amp;DOMAIN_NML
DOMAIN%START   = '20110902 000000'
DOMAIN%STOP    = '20110902 060000'
/

! -------------------------------------------------------------------- !
! Define each forcing via the INPUT_NML namelist
!
! * The FORCING flag can be  : F for "no forcing"
!                              T for "external forcing file"
!                              H for "homogenous forcing input"
!                              C for "coupled forcing field"
!
! * homogeneous forcing is not available for ICE_CONC
!
! * The ASSIM flag can :  F for "no forcing"
!                         T for "external forcing file"
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     INPUT%FORCING%WATER_LEVELS  = F
!     INPUT%FORCING%CURRENTS      = F
!     INPUT%FORCING%WINDS         = F
!     INPUT%FORCING%ICE_CONC      = F
!     INPUT%FORCING%ICE_PARAM1    = F
!     INPUT%FORCING%ICE_PARAM2    = F
!     INPUT%FORCING%ICE_PARAM3    = F
!     INPUT%FORCING%ICE_PARAM4    = F
!     INPUT%FORCING%ICE_PARAM5    = F
!     INPUT%FORCING%MUD_DENSITY   = F
!     INPUT%FORCING%MUD_THICKNESS = F
!     INPUT%FORCING%MUD_VISCOSITY = F
!     INPUT%ASSIM%MEAN            = F
!     INPUT%ASSIM%SPEC1D          = F
!     INPUT%ASSIM%SPEC2D          = F
! -------------------------------------------------------------------- !
&amp;INPUT_NML
INPUT%FORCING%WINDS = 'T' 
/

! -------------------------------------------------------------------- !
! Define the output types point parameters via OUTPUT_TYPE_NML namelist
!
! * the point file is a space separated values per line : lon lat 'name'
!
! * the full list of field names is : 
!  DPT CUR WND AST WLV ICE IBG D50 IC1 IC5 HS LM T02 T0M1 T01 FP DIR SPR
!  DP HIG EF TH1M STH1M TH2M STH2M WN PHS PTP PLP PDIR PSPR PWS TWS PNR
!  UST CHA CGE FAW TAW TWA WCC WCF WCH WCM SXY TWO BHD FOC TUS USS P2S
!  USF P2L TWI FIC ABR UBR BED FBB TBB MSS MSC DTD FC CFX CFD CFK U1 U2 
!
! * output track file formatted (T) or unformated (F)
!
! * coupling fields exchanged list is :
!   - Sent fields by ww3:
!       - Ocean model : T0M1 OCHA OHS DIR BHD TWO UBR FOC TAW TUS USS LM DRY
!       - Atmospheric model : ACHA AHS TP (or FP) FWS
!       - Ice model : IC5 TWI
!   - Received fields by ww3:
!       - Ocean model : SSH CUR
!       - Atmospheric model : WND
!       - Ice model : ICE IC1 IC5
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     TYPE%FIELD%LIST         =  'unset'
!     TYPE%POINT%FILE         =  'points.list'
!     TYPE%TRACK%FORMAT       =  T
!     TYPE%PARTITION%X0       =  0
!     TYPE%PARTITION%XN       =  0
!     TYPE%PARTITION%NX       =  0
!     TYPE%PARTITION%Y0       =  0
!     TYPE%PARTITION%YN       =  0
!     TYPE%PARTITION%NY       =  0
!     TYPE%PARTITION%FORMAT   =  T
!     TYPE%COUPLING%SENT      = 'unset'
!     TYPE%COUPLING%RECEIVED  = 'unset'
!
! -------------------------------------------------------------------- !
&amp;OUTPUT_TYPE_NML
TYPE%FIELD%LIST          = 'HS FP DIR DP CHA UST DPT CUR WND'
/

! -------------------------------------------------------------------- !
! Define output dates via OUTPUT_DATE_NML namelist
!
! * start and stop times are with format 'yyyymmdd hhmmss'
! * if time stride is equal '0', then output is disabled
! * time stride is given in seconds
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     DATE%FIELD%START         =  '19680606 000000'
!     DATE%FIELD%STRIDE        =  '0'
!     DATE%FIELD%STOP          =  '19680607 000000'
!     DATE%POINT%START         =  '19680606 000000'
!     DATE%POINT%STRIDE        =  '0'
!     DATE%POINT%STOP          =  '19680607 000000'
!     DATE%TRACK%START         =  '19680606 000000'
!     DATE%TRACK%STRIDE        =  '0'
!     DATE%TRACK%STOP          =  '19680607 000000'
!     DATE%RESTART%START       =  '19680606 000000'
!     DATE%RESTART%STRIDE      =  '0'
!     DATE%RESTART%STOP        =  '19680607 000000'
!     DATE%BOUNDARY%START      =  '19680606 000000'
!     DATE%BOUNDARY%STRIDE     =  '0'
!     DATE%BOUNDARY%STOP       =  '19680607 000000'
!     DATE%PARTITION%START     =  '19680606 000000'
!     DATE%PARTITION%STRIDE    =  '0'
!     DATE%PARTITION%STOP      =  '19680607 000000'
!     DATE%COUPLING%START      =  '19680606 000000'
!     DATE%COUPLING%STRIDE     =  '0'
!     DATE%COUPLING%STOP       =  '19680607 000000'
!
!     DATE%RESTART             =  '19680606 000000' '0' '19680607 000000'
! -------------------------------------------------------------------- !
&amp;OUTPUT_DATE_NML
DATE%FIELD          = '20110902 000000' '3600' '20110902 060000'
/

! -------------------------------------------------------------------- !
! Define homogeneous input via HOMOG_COUNT_NML and HOMOG_INPUT_NML namelist
!
! * the number of each homogeneous input is defined by HOMOG_COUNT
! * the total number of homogeneous input is automatically calculated
! * the homogeneous input must start from index 1 to N
! * if VALUE1 is equal 0, then the homogeneous input is desactivated
! * NAME can be IC1, IC2, IC3, IC4, IC5, MDN, MTH, MVS, LEV, CUR, WND, ICE, MOV
! * each homogeneous input is defined over a maximum of 3 values detailled below :
!     - IC1 is defined by thickness
!     - IC2 is defined by viscosity
!     - IC3 is defined by density
!     - IC4 is defined by modulus
!     - IC5 is defined by floe diameter
!     - MDN is defined by density
!     - MTH is defined by thickness
!     - MVS is defined by viscosity
!     - LEV is defined by height
!     - CUR is defined by speed and direction
!     - WND is defined by speed, direction and airseatemp
!     - ICE is defined by concentration
!     - MOV is defined by speed and direction
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     HOMOG_COUNT%N_IC1            =  0
!     HOMOG_COUNT%N_IC2            =  0
!     HOMOG_COUNT%N_IC3            =  0
!     HOMOG_COUNT%N_IC4            =  0
!     HOMOG_COUNT%N_IC5            =  0
!     HOMOG_COUNT%N_MDN            =  0
!     HOMOG_COUNT%N_MTH            =  0
!     HOMOG_COUNT%N_MVS            =  0
!     HOMOG_COUNT%N_LEV            =  0
!     HOMOG_COUNT%N_CUR            =  0
!     HOMOG_COUNT%N_WND            =  0
!     HOMOG_COUNT%N_ICE            =  0
!     HOMOG_COUNT%N_MOV            =  0
!
!     HOMOG_INPUT(I)%NAME           =  'unset'
!     HOMOG_INPUT(I)%DATE           =  '19680606 000000'
!     HOMOG_INPUT(I)%VALUE1         =  0
!     HOMOG_INPUT(I)%VALUE2         =  0
!     HOMOG_INPUT(I)%VALUE3         =  0
! -------------------------------------------------------------------- !
&amp;HOMOG_COUNT_NML
/

&amp;HOMOG_INPUT_NML
/


! -------------------------------------------------------------------- !
! WAVEWATCH III - end of namelist                                      !
! -------------------------------------------------------------------- !<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote>
</li>
<li><p>执行，在输出文件夹得到结果：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210182546.png"></p>
</li>
</ol>
<h2 id="在regtests的east-USA中，根据执行ww3-ounf的run-test命令，配置相关文件并执行-1"><a href="#在regtests的east-USA中，根据执行ww3-ounf的run-test命令，配置相关文件并执行-1" class="headerlink" title="在regtests的east-USA中，根据执行ww3_ounf的run_test命令，配置相关文件并执行"></a>在regtests的east-USA中，根据执行ww3_ounf的run_test命令，配置相关文件并执行</h2><ol>
<li><p>执行ww3_ounf的run_test命令为：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$regtests</span>
./east-USA/run_test -i input -c Gnu -s Ifremer1 -N -r ww3_ounf -w work3 -o netcdf <span class="token punctuation">..</span>/model east-USA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>在输入文件夹中创建<code>ww3_ounf.nml.2</code>，用此文件时，<code>cp ww3_ounf.nml.2 ww3_ounf.nml</code>：</p>
<blockquote>
<p>先采用inout教程中的<code>ww3_ounf.nml</code>;</p>
<p>这里需要确定时间（<strong>FIELD的时间</strong>），不是很懂这里的设置；</p>
</blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">! -------------------------------------------------------------------- !
! WAVEWATCH III ww3_ounf.nml - Grid output post-processing             !
! -------------------------------------------------------------------- !

! -------------------------------------------------------------------- !
! Define the output fields to postprocess via FIELD_NML namelist
!
! * the full list of field names FIELD%LIST is : 
!  DPT CUR WND AST WLV ICE IBG D50 IC1 IC5 HS LM T02 T0M1 T01 FP DIR SPR
!  DP HIG EF TH1M STH1M TH2M STH2M WN PHS PTP PLP PDIR PSPR PWS TWS PNR
!  UST CHA CGE FAW TAW TWA WCC WCF WCH WCM SXY TWO BHD FOC TUS USS P2S
!  USF P2L TWI FIC ABR UBR BED FBB TBB MSS MSC DTD FC CFX CFD CFK U1 U2 
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     FIELD%TIMESTART            = '19000101 000000'  ! Stop date for the output field
!     FIELD%TIMESTRIDE           = '0'                ! Time stride for the output field
!     FIELD%TIMESTOP             = '29001231 000000'  ! Stop date for the output field
!     FIELD%TIMECOUNT            = '1000000000'       ! Number of time steps
!     FIELD%TIMESPLIT            = 6                  ! [4(yearly),6(monthly),8(daily),10(hourly)]
!     FIELD%LIST                 = 'unset'            ! List of output fields
!     FIELD%PARTITION            = '0 1 2 3'          ! List of wave partitions ['0 1 2 3 4 5']
!     FIELD%SAMEFILE             = T                  ! All the variables in the same file [T|F]
!     FIELD%TYPE                 = 3                  ! [2 = SHORT, 3 = it depends , 4 = REAL]
! -------------------------------------------------------------------- !
&amp;FIELD_NML
  FIELD%TIMESTART        =  '20080310 000000'
  FIELD%TIMESTRIDE       =  '180'
  FIELD%TIMECOUNT        =  '100'
  FIELD%LIST             =  'HS FP DIR DP CHA UST DPT CUR WND'
  FIELD%PARTITION        =  '0'
/

! -------------------------------------------------------------------- !
! Define the content of the input file via FILE_NML namelist
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     FILE%PREFIX        = 'ww3.'            ! Prefix for output file name
!     FILE%NETCDF        = 3                 ! Netcdf version [3|4]
!     FILE%IX0           = 1                 ! First X-axis or node index
!     FILE%IXN           = 1000000000        ! Last X-axis or node index
!     FILE%IY0           = 1                 ! First Y-axis index
!     FILE%IYN           = 1000000000        ! Last Y-axis index
! -------------------------------------------------------------------- !
&amp;FILE_NML
/


! -------------------------------------------------------------------- !
! Define the content of the output file via SMC_NML namelist
!
! * For SMC grids, IX0, IXN, IY0 and IYN from FILE_NML are not used.
!   Two types of output are available:
! *   TYPE=1: Flat 1D "seapoint" array of grid cells.
! *   TYPE=2: Re-gridded regular grid with cell sizes being an integer
! *           multiple of the smallest SMC grid cells size.
!
! * Note that the first/last longitudes and latitudes will be adjusted
!  to snap to the underlying SMC grid edges. CELFAC is only used for
!  type 2 output and defines the output cell sizes as an integer
!  multiple of the smallest SMC Grid cell size. CELFAC should be a
!  power of 2, e.g: 1,2,4,8,16, etc...
!
! * namelist must be terminated with /
! * definitions &amp; defaults:
!     SMC%TYPE          = 1              ! SMC Grid type (1 or 2)
!     SMC%SXO           = -999.9         ! First longitude
!     SMC%EXO           = -999.9         ! Last longitude
!     SMC%SYO           = -999.9         ! First latitude
!     SMC%EYO           = -999.9         ! Last latitude
!     SMC%CELFAC        = 1              ! Cell size factor (SMCTYPE=2 only)
!     SMC%NOVAL         = UNDEF          ! Fill value for wet cells with no data
! -------------------------------------------------------------------- !
&amp;SMC_NML
/

! -------------------------------------------------------------------- !
! WAVEWATCH III - end of namelist                                      !
! -------------------------------------------------------------------- !
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>执行，在输出文件夹得到结果：</p>
<p><img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220210184540.png"></p>
</li>
<li><p>ncview可视化nc文件：</p>
<p><code>ncview ww3.201109.nc</code>，查看Hs。</p>
</li>
</ol>
<h2 id="了解ww3-shel-nml和ww3-ounf参数"><a href="#了解ww3-shel-nml和ww3-ounf参数" class="headerlink" title="了解ww3_shel.nml和ww3_ounf参数"></a>了解ww3_shel.nml和ww3_ounf参数</h2><h3 id="case-1：更长的时间段"><a href="#case-1：更长的时间段" class="headerlink" title="case 1：更长的时间段"></a>case 1：更长的时间段</h3><p>‘20110831 200000’到’20110911 000000’时间段 ww3_shel.nml 的设置：</p>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">&amp;DOMAIN_NML
DOMAIN%START   = '20110831 200000'
DOMAIN%STOP    = '20110911 000000'
/

&amp;OUTPUT_DATE_NML
DATE%FIELD          = '20110831 200000' '3600' '20110911 000000'
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>这个时间段内包含了风场的时间段，但也包含了<strong>没有风场的时间段</strong>；</p>
</blockquote>
<blockquote>
<p>ww3_shel运行的全局时间步长，即<strong>经过多少时间间隔输出一次</strong>，与<code>ww3_grid.nml</code>的<code>TIMESTEPS_NML</code>相关：</p>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">&amp;TIMESTEPS_NML
  TIMESTEPS%DTMAX         =   600.
  TIMESTEPS%DTXY          =   200.
  TIMESTEPS%DTKTH         =   300.
  TIMESTEPS%DTMIN         =   10.
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这严重<strong>影响着运行时间的长短</strong>？待深入了解！</p>
</blockquote>
<p>‘20110831 200000’到’20110911 000000’时间段 ww3_ounf.nml 的设置:</p>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">&amp;FIELD_NML
  FIELD%LIST             =  'HS FP DIR DP CHA UST DPT CUR WND'
  FIELD%PARTITION        =  '0'
  FIELD%TIMESTRIDE       =  '3600'
  FIELD%TIMESPLIT            = 4
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">&amp;FIELD_NML
  FIELD%LIST             =  'HS FP DIR DP CHA UST DPT CUR WND'
  FIELD%PARTITION        =  '0'
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>这么设置会一直不动，因为<code>FIELD%TIMESTRIDE           = '0'   </code>。</p>
</blockquote>
<blockquote>
<pre class="line-numbers language-nml" data-language="nml"><code class="language-nml">&amp;FIELD_NML
  FIELD%LIST             =  'HS FP DIR DP CHA UST DPT CUR WND'
  FIELD%PARTITION        =  '0'
  FIELD%TIMESTRIDE       =  '180'
/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>每一步跨越180s（3分钟），从’19000101 000000’开始，有’1000000000’步，运行时间需要等个1分钟，可以根据<code>ww3_shel.nml</code>按3600s（1小时）输出，将TIMESTRIDE设置成<code>3600</code>，运行很快；</p>
<p>这样会生成两个月份的nc文件，<code>ww3.201108.nc</code>和<code>ww3.201109.nc</code>，调整<code>FIELD%TIMESPLIT            = 4 </code>会按年份输出；</p>
</blockquote>
<blockquote>
<p>不懂<code>FIELD%PARTITION        =  '0'</code>，但好像没什么影响…；</p>
</blockquote>
<p>生成了<code>ww3.2011.nc</code>文件，对其进行<code>ncview</code>：</p>
<ul>
<li>发现<code>hs</code>在没有实际风场的时间段’20110831 200000’到’20110901 000000’也有波高，原因是模式在这个时间段有默认假设的风场，即’20110901 000000’的实际风场，可通过查看<code>uwnd</code>和<code>vwnd</code>变量得到模式风场的信息。<strong>实际应用中，应在ww3_shel.nml将起始时间和终止时间与风场对应？</strong>；</li>
<li>发现模式输出的<code>uwnd</code>和<code>vwnd</code>是按每小时输出的，与实际风场信息每6个小时输出不一样；（<strong>模式输出的每6小时风场信息和ccmp风场信息一样吗？</strong>）</li>
</ul>
<h2 id="—————————————-3"><a href="#—————————————-3" class="headerlink" title="—————————————"></a>—————————————</h2><h2 id="给老师的反馈：2022-02-18"><a href="#给老师的反馈：2022-02-18" class="headerlink" title="给老师的反馈：2022-02-18"></a>给老师的反馈：2022-02-18</h2><p>老师，根据您2022-01-17号的指导，这个寒假我主要做的内容如下：</p>
<ol>
<li>了解CCMP风场数据，能实现对CCMP v.2 每天数据的批量爬取，整合成一个nc文件，供ww3_prnc使用；</li>
<li>了解ndbc浮标数据，能实现对特定区域的浮标数据进行批量爬取，匹配nc文件中网格点数据，计算RMSE、BIAS、R、SI，简单画出时序图、散点图，过程中的所有浮标相关的数据都存到matlab的一个table类型变量中；</li>
<li>具体在ww3试验中，选择区域为75°W-58°W、36°N-46°N，分辨率为0.25°，加入了20110901-20110910时间段的CCMP风场数据，运行生成的ww3.2011.nc文件与ncdb的浮标数据进行了对比，整体趋势接近；</li>
</ol>
<p>所有内容在<a href="https://liu-jincan.github.io/2022/01/17/wavewatch3/07-gei-ding-qu-yu-ww3-shi-yan-2022-han-jia-an-pai/%E4%B8%8A%E9%83%BD%E6%9C%89%E8%AE%B0%E5%BD%95%EF%BC%88%E6%89%93%E5%BC%80%E5%8F%AF%E8%83%BD%E5%9B%BE%E7%89%87%E4%BC%9A%E6%98%BE%E7%A4%BA%E7%9A%84%E6%AF%94%E8%BE%83%E6%85%A2%EF%BC%89%EF%BC%9B">https://liu-jincan.github.io/2022/01/17/wavewatch3/07-gei-ding-qu-yu-ww3-shi-yan-2022-han-jia-an-pai/上都有记录（打开可能图片会显示的比较慢）；</a></p>
<p>下一步准备学习同化，将同化部分接入到ww3中。</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Jincan</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://Liu-Jincan.github.io/2022/01/17/yan-jiu-sheng-justtry-target/yan-yi-shang-han-jia-gei-ding-qu-yu-ww3-shi-yan-2022-han-jia-an-pai/">https://Liu-Jincan.github.io/2022/01/17/yan-jiu-sheng-justtry-target/yan-yi-shang-han-jia-gei-ding-qu-yu-ww3-shi-yan-2022-han-jia-an-pai/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Jincan</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">No tag</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">Thanks for your reward</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2022/01/24/yan-jiu-sheng-justtry-function/vmware/01-vmware-an-zhuang-ubuntu-xu-ni-ji-ji-qi-kuo-rong/">
                    <div class="card-image">
                        
                        <img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220407154227.png" class="responsive-img" alt="01-VMware安装+ubuntu虚拟机及其扩容">
                        
                        <span class="card-title">01-VMware安装+ubuntu虚拟机及其扩容</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            ~~
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-01-24
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/VMware/" class="post-category">
                                    VMware
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/01/16/yan-jiu-sheng-justtry-function/bian-yi-qi-bian-ji-qi-ji-cheng-kai-fa-huan-jing/vscode-02-da-jian-c-huo-c-jia-jia-huan-jing/">
                    <div class="card-image">
                        
                        <img src="https://raw.githubusercontent.com/Liu-Jincan/PicGo/main/img/20220327154214.png" class="responsive-img" alt="02-VScode搭建C/C++">
                        
                        <span class="card-title">02-VScode搭建C/C++</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            ~~
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-01-16
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/VScode%E7%BC%96%E8%BE%91%E5%99%A8/" class="post-category">
                                    VScode编辑器
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    
    <!-- 05 footer是什么？页脚 -->
    <footer class="page-footer bg-color">
    <!-- 音乐  -->
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="6992203508"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
	style="margin-bottom: 15px !important;">
	
	
	
	
	
	<!--  copyright那本分的div -->
	<div class="col s12 m8 l8 copy-right">
            
            <!-- 这里是 Copyright @, &nbsp是空格, &copy是那个符号哟 -->
            <!-- https://zhidao.baidu.com/question/745714487580680772.html, JavaScript中的“&nbsp”是什么意思, 转义符号  -->
            Copyright&nbsp;&copy;
            
            <!-- 这里是2021, 默认的theme.time.year是2019,在这里我指定为2021,因为我是2021-12月份创建的博客,good job -->
            
            
                <span id="year">2021-2022</span>
            
            
            <!-- 这里是Jincan Liu, 还包括了对应的超链接哦 -->
            <a href="/about" target="_blank">Jincan Liu</a>
            
            <!-- 这里是关于 Hexo -->
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            
            <!-- 这里是关于 matery -->
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <!-- br表示换行, https://zhidao.baidu.com/question/187056327.html -->
            <br>
            
            <!-- 这里是为了显示站点总字数 -->
            
            	<!-- <i>标签是斜体作用, 这里是为了显示图形? -->
            	<!-- <span>是行内元素, span的意义是添加指定样式,详见https://blog.csdn.net/microcosmv/article/details/51953490 -->
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;Total Words:&nbsp;<span
                        class="white-color">480.7k</span>
            
            
            <!-- 不蒜子计数器的使用, https://blog.csdn.net/weixin_46247581/article/details/105848853, hexo s 中显示的不是正确的, 不用担心, 看 hexo d 上的即可 -->
            
            
                
            
                            
            <!-- 这显示总访问量 -->    <!-- 显示每篇文章的访问量的方法, https://blog.csdn.net/qq_23590921/article/details/103864482 -->
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
            <!-- 这里显示总访问人数 -->
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
                         
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "12";
                        var startDate = "20";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'En';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
            <!-- 不知道干什么 -->
            
        </div>
	
	
	
	
		
	
	<!-- 联系图标的 div -->
        <div class="col s12 m4 l4 social-link social-statis">






    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3079779149" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3079779149" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="mailto:3079779149@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我: jincanliu@qq.com; jincan8liu@gmail.com" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>



    <a href="https://www.researchgate.net/profile/Jincan-Liu" class="tooltipped" target="_blank" data-tooltip="访问我的ResearchGate" data-position="top" data-delay="50">
        <i class="fab fa-researchgate"></i>
    </a>



    <a href="https://github.com/Liu-Jincan" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>






    <a href="https://www.zhihu.com/people/JincanLiu" class="tooltipped" target="_blank" data-tooltip="访问我的知乎" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a> 



    <a href="https://space.bilibili.com/341192538" class="tooltipped" target="_blank" data-tooltip="访问我的bilibili" data-position="top" data-delay="50">
        <i class="iconfont icon-bilibili-fill"></i>
    </a>



</div>        
        

    </div>
</footer>


<!-- 回到顶部的div -->
<div class="progress-bar"></div>


    <!-- 06 search是什么？搜索遮照栏 -->
    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    
    <!-- 07 back-top是什么？回到顶部按钮 -->
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <!-- fa-arrow-up -->
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <!-- 08 ??? -->
    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>
    
    <!-- 09 图标绘制工具 -->
    

    <!-- 10 ???-->
    

    <!-- 11 雪花特效 -->
    

    <!-- 12 鼠标星星特效 -->
    


    <!-- 13 -->
     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- 14 -->
    <!-- Baidu Analytics -->

    
    <!-- 15 -->
    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 16 -->
    
    
    <!-- 17 -->
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    


    <!-- 18 -->
    
    
    <!-- 19 -->
    

    <!-- 20 腾讯兔小巢-->
    
    
    <!-- 21 canvas_nest特效 -->
    
	
    <!-- 22 ribbon特效 -->
    
    
    <!-- 23 -->
    

    <!-- 24 -->
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
